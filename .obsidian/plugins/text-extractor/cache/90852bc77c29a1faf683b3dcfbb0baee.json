{"path":"pdf/课件/题目/2022final_review(1).pdf","text":"2 0 2 2 F i n a l R e v i e w A l g o r i t h m D e s i g n a n d A n a l y s i s P r o b l e m 1 R e c u r r e n c e a n d A s y m p t o t i c B e h a v i o r M a s t e r T h e o r e m a . S u p p o s e y o u a r e c h o o s i n g b e t w e e n t h e f o l l o w i n g t h r e e a l g o r i t h m s : • A l g o r i t h m A s o l v e s p r o b l e m s b y d i v i d i n g t h e m i n t o s e v e n s u b p r o b l e m s o f s i z e n / 3 , r e c u r s i v e l y s o l v i n g e a c h s u b p r o b l e m , a n d t h e n c o m b i n i n g t h e s o l u t i o n s i n O ( n l g n ) t i m e . • A l g o r i t h m B s o l v e s p r o b l e m s o f s i z e n b y r e c u r s i v e l y s o l v i n g f o u r s u b - p r o b l e m s o f s i z e n − 2 a n d t h e n c o m b i n i n g t h e s o l u t i o n s i n c o n s t a n t t i m e . A n d T ( 1 ) = T ( 2 ) = 1 . • A l g o r i t h m C s o l v e s p r o b l e m o f s i z e n b y d i v i d i n g t h e m i n t o 1 6 s u b p r o b - l e m s o f s i z e n / 4 , r e c u r s i v e l y s o l v e e a c h p r o b l e m a n d t h e n c o m b i n i n g t h e s o l u t i o n s i n O ( n 2 ) . W h a t i s t h e r u n n i n g t i m e o f e a c h o f t h e a l g o r i t h m s ( i n b i g - O n o t a t i o n ) a n d w h i c h w o u l d y o u c h o o s e ? S o l u t i o n M a i n d i ﬃ c u l t i e s o f t h i s p r o b l e m a r e s o l v i n g t h e D i v i d e - a n d - C o n q u e r e q u a - t i o n s o f t h r e e a l g o r i t h m s . • A l g o r i t h m A . T ( n ) = 7 T ( n / 3 ) + O ( n l g n ) T h i s e q u a t i o n i s a n i n s t a n c e o f T ( n ) = b T ( n / c ) + f ( n ) w h e r e b = 7 , c = 3 a n d f ( n ) = O ( n l g n ) . A n d w e c o m p u t e : E = l g ( b ) / l g ( c ) = l o g 3 7 > 1 F r o m M a s t e r T h e o r e m , w h e n f ( n ) ∈ O ( n l o g 3 7 − ! ) , T ( n ) ∈ Θ ( n l o g 3 7 ) . 1 • A l g o r i t h m B . T ( n ) = 4 T ( n − 2 ) + O ( 1 ) , T ( 1 ) = T ( 2 ) = 1 . T ( n ) = 4 T ( n − 2 ) + O ( 1 ) = 4 ( 4 T ( n − 4 ) + O ( 1 ) ) + O ( 1 ) = 1 6 T ( n − 4 ) + 4 O ( 1 ) + O ( 1 ) = 6 4 T ( n − 6 ) + 1 6 O ( 1 ) + 4 O ( 1 ) + O ( 1 ) · · · = 4 ⌊ n / 2 ⌋ + ⌊ n / 2 ⌋ − 1 ! i = 0 4 i O ( 1 ) N o t e T ( 1 ) ∈ O ( 1 ) = ⌊ n / 2 ⌋ ! i = 0 4 i O ( 1 ) = Θ ( 2 n ) • A l g o r i t h m C . T ( n ) = 1 6 T ( n / 4 ) + O ( n 2 ) T h i s e q u a t i o n i s a n i n s t a n c e o f T ( n ) = b T ( n / c ) + f ( n ) w h e r e b = 1 6 , c = 4 a n d f ( n ) = O ( n 2 ) . A n d w e c o m p u t e : E = l g ( b ) / l g ( c ) = l o g 4 1 6 = 2 F r o m M a s t e r T h e o r e m , w h e n f ( n ) ∈ Θ ( n 2 ) , T ( n ) ∈ Θ ( n 2 l o g n ) . A b o v e a l l , t h e c o m p l e x i t y o f t h r e e a l g o r i t h m s a r e Θ ( n l o g 3 7 ) , Θ ( 2 n ) a n d Θ ( n 2 l o g n ) r e s p e c t i v e l y . O b v i o u s l y , A l g o r i t h m A i s t h e b e s t t i m e a l g o r i t h m a m o n g t h e m . b . D e c i d e t h e a s y m p t o t i c o r d e r o f T ( n ) . P r o v e y o u r a n s w e r s . T ( n ) = 2 T ( n 8 ) + 3 √ n 8 , T ( 1 ) = 0 S o l v i n g r e c u r r e n c e a . S h o w t h a t i n t h e r e c u r r e n c e T ( n ) = m a x 0 ≤ q ≤ n − 1 ( T ( q ) + T ( n − q − 1 ) ) + Θ ( n ) P r o v e T ( n ) = Ω ( n 2 ) 2 S o l u t i o n T ( n ) = m a x 0 ≤ q ≤ n − 1 ( T ( q ) + T ( n − q − 1 ) ) + Θ ( n ) ≥ ( T ( n − 1 ) + T ( 1 ) ) + Θ ( n ) > T ( n − 1 ) + Θ ( n ) ≥ n ! i = 1 Θ ( i ) ≥ Θ ( n 2 ) T h e r e f o r e , w e c a n g e t t h a t T ( n ) = Ω ( n 2 ) . b . S o l v e t h e r e c u r r e n c e e x a c t l y : • T ( 1 ) = 1 • T ( n ) = \" n − 1 i = 1 T ( n − i ) f o r a l l n > 2 c . T ( n ) = T ( n − 2 ) + 2 n 3 − 3 n 2 + 3 n − 1 , T ( 1 ) = 1 , T ( 2 ) = 9 d . C o m p a r e n l o g n a n d ( l o g n ) n . e . S h o w t h a t k l n k ∈ Θ ( n ) i m p l i e s k ∈ Θ ( n / l n n ) . S o l u t i o n W e h a v e t h e f o l l o w i n g s t e p s t o p r o v e t h e c o n c l u s i o n : • S i n c e k l n k ∈ Θ ( n ) , w e h a v e l n ( k l n k ) ∈ Θ ( l n ( n ) ) . • S i n c e l n ( k ) ≤ l n ( k l n k ) = l n ( k ) + l n ( l n k ) ≤ 2 l n ( k ) , w e h a v e l n ( k l n k ) ∈ Θ ( l n ( k ) ) . • F r o m t h e a b o v e t w o p o i n t s , w e h a v e l n ( k ) ∈ Θ ( l n ( n ) ) . • F i n a l l y , w e g e t k l n ( k ) / l n ( k ) ∈ Θ ( n / l n n ) R e c u r s i o n T r e e U s e a r e c u r s i o n t r e e t o g i v e a n a s y m p t o t i c a l l y t i g h t s o l u t i o n t o t h e r e c u r r e n c e T ( n ) = T ( n − a ) + T ( a ) + c n , w h e r e a ≥ 1 a n d c > 0 a r e c o n s t a n t s . P r o b l e m 2 S o r t , S e a r c h a n d S e l e c t i o n a . D e s c r i b e a n O ( n ) - t i m e a l g o r i t h m t h a t , g i v e a s e t S o f n d i s t i n c t n u m b e r s a n d a p o s i t i v e i n t e g e r k ≤ n ( n o t e t h a t k i s n o t c o n s t a n t ) , d e t e r m i n e t h e k n u m b e r s i n S t h a t a r e c l o s e s t t o t h e m e d i a n o f S . 3 和 lg = plogmbgnvsnloglogucboglogn 故 10 ) 笑防⾼ , ① 批中位 olm ) ② 做统对德 O [ n ] ③ 找第 k ⼩ ∞ ( n ) ④ 筛出 0 个码 oc k ] S o l u t i o n • U s i n g O ( n ) - t i m e t o ﬁ n d t h e m e d i a n x o f S ; • f o r a n y S [ i ] , w e d e ﬁ n e S ′ [ i ] = | x − S [ i ] | , o b v i o u s l y S ′ c o u l d b e c o n - s t r u c t e d i n O ( n ) - t i m e ; • ﬁ n d t h e k s m a l l e s t n u m b e r s S ′ [ i ] i n S ′ , a n d t h e c o r r e s p o n d i n g e l e m e n t s S [ i ] a r e t h e k n u m b e r s c l o s e s t t o t h e m e d i a n o f S b . B o t h A a n d B a r e t w o a r r a y s w i t h n i n t e g e r s . F o r a g i v e n i n t e g e r x , d e s i g n a n a l g o r i t h m t o ﬁ n d o u t w h e t h e r e x i s t s a ∈ A a n d b ∈ B , s a t i s f y i n g x = a + b . A n a l y s e s t h e c o m p l e x i t y o f y o u r a l g o r i t h m . S o l u t i o n • S o r t e l e m e n t s i n A w i t h O ( n l o g n ) - t i m e ; • f o r b ∈ B , u s e b i n a r y s e a r c h t o ﬁ n d w h e t h e r x − b i n A w i t h n r u n s , e a c h o f w h i c h i s i n O ( l o g n ) - t i m e . c . S u p p o s e a n a r r a y A c o n s i s t s o f n e l e m e n t , e a c h o f w h i c h i s r e d , w h i t e o r b l u e . D e s i g n a l i n e a r a l g o r i t h m t o s o r t t h e a r r a y s o t h a t a l l t h e r e d s c o m e b e f o r e t h e w h i t e s , a n d w h i c h c o m e b e f o r e a l l t h e b l u e s . T h e o n l y o p e r a t i o n s p e r m i t t e d a r e : • E x a m i n e ( A , i ) - r e p o r t t h e c o l o r o f t h e i t h e l e m e n t , a n d • S w a p ( A , i , j ) - s w a p t h e i t h e l e m e n t o f A w i t h t h e j t h e l e m e n t . T h e m a x i m u m k s u m c o m b i n a t i o n s G i v e n t w o e q u a l l y s i z e d a r r a y s A , B a n d n ( t h e s i z e o f b o t h a r r a y s ) . A s u m c o m b i n a t i o n i s m a d e b y a d d i n g o n e e l e m e n t f r o m a r r a y A a n d a n o t h e r e l e m e n t o f a r r a y B . D e s i g n a n O ( n l o g n ) - t i m e a l g o r i t h m t o d i s p l a y t h e m a x i m u m k v a l i d s u m c o m b i n a t i o n s f r o m a l l t h e p o s s i b l e s u m c o m b i n a t i o n s . N o t e t h a t k i s n o t a c o n s t a n t , w e a s s u m e k ∈ O ( n ) . ( 1 5 p o i n t s ) S o l u t i o n I n s t e a d o f b r u t e - f o r c i n g t h r o u g h a l l t h e p o s s i b l e s u m c o m b i n a t i o n s , w e s h o u l d ﬁ n d a w a y t o l i m i t o u r s e a r c h s p a c e t o p o s s i b l e c a n d i d a t e s u m c o m b i n a t i o n s . 1 . S o r t b o t h a r r a y s a r r a y A a n d a r r a y B . 2 . C r e a t e a m a x h e a p t o s t o r e t h e s u m c o m b i n a t i o n s a l o n g w i t h t h e i n d i c e s o f e l e m e n t s f r o m b o t h a r r a y s A a n d B w h i c h m a k e u p t h e s u m . H e a p i s o r d e r e d b y t h e s u m . 4 ( m , m ) ← 造定后弹最⼤ , ( n . 1 , n ) In , n 1 以选最⼤ , 继续放 29 / 的 r , n ) in - 1 , m - 13 ( 避⾊所有节点级⼊法总对列 3 . I n i t i a l i z e t h e h e a p w i t h t h e m a x i m u m p o s s i b l e s u m c o m b i n a t i o n i . e ( A [ n 1 ] + B [ n 1 ] w h e r e n i s t h e s i z e o f a r r a y ) a n d w i t h t h e i n d i c e s o f e l e m e n t s f r o m b o t h a r r a y s ( n 1 , n 1 ) . T h e t u p l e i n s i d e m a x h e a p w i l l b e ( A [ n − 1 ] + B [ n 1 ] , n 1 , n 1 ) . H e a p i s o r d e r e d b y ﬁ r s t v a l u e i . e . , s u m o f b o t h e l e m e n t s . 4 . P o p t h e h e a p t o g e t t h e c u r r e n t l a r g e s t s u m a n d a l o n g w i t h t h e i n d i c e s o f t h e e l e m e n t t h a t m a k e u p t h e s u m . L e t t h e t u p l e b e ( s u m , i , j ) . N e x t i n s e r t ( A [ i 1 ] + B [ j ] , i 1 , j ) a n d ( A [ i ] + B [ j 1 ] , i , j 1 ) i n t o t h e m a x h e a p b u t m a k e s u r e t h a t t h e p a i r o f i n d i c e s i . e . , ( i 1 , j ) a n d ( i , j 1 ) a r e n o t a l r e a d y p r e s e n t i n t h e m a x h e a p . G o b a c k t o 4 u n t i l k t i m e s . P r o b l e m 3 A m o r t i z e d A n a l y s i s a . S u p p o s e w e p e r f o r m a s e q u e n c e o f s t a c k o p e r a t i o n s ( p u s h a n d p o p ) o n a s t a c k w h o s e s i z e n e v e r e x c e e d s k . A f t e r e v e r y k o p e r a t i o n s , w e m a k e a c o p y o f t h e e n t i r e s t a c k f o r b a c k u p p u r p o s e . S h o w t h a t t h e c o s t n s t a c k o p e r a t i o n s , i n c l u d i n g c o p y i n g t h e s t a c k , i s O ( n ) b y a s s i g n i n g s u i t a b l e a m o r t i z e d c o s t s t o t h e v a r i o u s s t a c k o p e r a t i o n s . S o l u t i o n W e d e s i g n t h e f o l l o w i n g a m o r t i z e d c o s t a s s i g n m e n t : • f o r a n y p u s h o p e r a t i o n , a m o r t i z e d c o s t = a c t u a l c o s t ( 1 ) + a c c o u n t i n g c o s t ( 1 ) = 2 • f o r a n y p o p o p e r a t i o n , a m o r t i z e d c o s t = a c t u a l c o s t ( 1 ) + a c c o u n t i n g c o s t ( 1 ) = 2 • f o r a n y c o p y i n g o p e r a t i o n , a s s u m e t h e c u r r e n t s t a c k c o n t a i n s x e l e - m e n t s . a m o r t i z e d c o s t = a c t u a l c o s t ( x ) + a c c o u n t i n g c o s t ( - x ) = 0 H e r e w e p r o v e t h e s u m o f t h e a c c o u n t i n g c o s t s o f a l l n o p e r a t i o n s i s n o n - n e g a t i v e : F o r a n y c o p y i n g o p e r a t i o n s , s i n c e t h e s i z e o f t h e s t a c k n e v e r e x c e e d s k , w e c a n g e t t h e n u m b e r x o f e l e m e n t s i n t h e s t a c k i s n o t g r e a t e r t h a n k . N o t e t h a t b e f o r e a n y c o p y i n g o p e r a t i o n , w e h a v e p r e v i o u s k o r i g i n a l o p e r a t i o n s ( p o p o r p u s h ) a n d w e a d d t h e p o s i t i v e a c c o u n t i n g c o s t k ( 1 f o r e a c h o p e r a t i o n ) t o t a l l y . O b v i o u s l y , t h e n e g a t i v e a c c o u n t i n g c o s t − x p l u s t h e p o s i t i v e a c c o u n t i n g c o s t : − x + k ≥ 0 b . C o n s i d e r t h e f o l l o w i n g o p e r a t i o n s o n a s e t o f n o d e s i n a g r a p h : • C o n n e c t ( A , B ) : a d d a n e d g e f r o m n o d e A t o n o d e B i n t h e g r a p h ( i f t h e r e a l r e a d y e x i s t s s u c h a n e d g e , d o n o t h i n g ) ; 5 ⼀ e 考备 , ⼀ ⼀ ⼀ O ( ) • D i s c o n n e c t ( A , B ) : i f t h e r e a r e p a t h s f r o m A t o B , r e m o v e a l l e d g e s i n t h e p a t h s ( i f t h e r e i s n o p a t h , d o n o t h i n g ) ; A s s u m e t h e c o s t o f a d d i n g a n e d g e i s 1 , r e m o v i n g a n e d g e i s 2 , a n d t h e c o s t o f ﬁ n d i n g a p a t h i n t h e g r a p h i s o m i t t e d . T h e r e i s n o e d g e i n t h e g r a p h a t t h e b e g i n n i n g . C o n s i d e r a s e q u e n c e o f n o p e r a t i o n s o n t h e g r a p h , a p p l y a m o r t i z e d a n a l y s i s o n t h e c o s t o f C o n n e c t a n d D i s c o n n e c t o p e r a t i o n s i n t h e w o r s t c a s e . S o l u t i o n A m o r t i z e d c o s t = a c t u a l c o s t + a c c o u n t i n g c o s t W e d e s i g n t h e f o l l o w i n g a c c o u n t i n g s c h e m e : • F o r C o n n e c t ( A , B ) : A c t u a l c o s t : 1 A c c o u n t i n g c o s t : 2 A m o r t i z e d c o s t : 1 + 2 = 3 • D i s c o n n e c t ( A , B ) : ( a s s u m e t h e r e a r e t e d g e s i n t h e p a t h s b e t w e e n A , B ) A c t u a l c o s t : 2 t A c c o u n t i n g c o s t : − 2 t A m o r t i z e d c o s t : 2 t − 2 t = 0 P r o b l e m 4 G r a p h A l o g r i t h m L e t G = ( V , E ) b e a d i r e c t g r a p h i n w h i c h e a c h v e r t e x u ∈ V i s l a b e l e d w i t h a u n i q u e i n t e g e r L ( u ) f r o m t h e s e t { 1 , 2 , . . . , | V | } . F o r e a c h v e r t e x u , l e t R ( u ) = { v ∈ V : u → v } b e t h e s e t o f v e r t i c e s t h a t a r e r e a c h a b l e f r o m u . D e ﬁ n e m i n ( u ) t o b e t h e v e r t e x i n R ( u ) w h o s e l a b e l i s m i n i m u m , i . e . , m i n ( u ) i s t h e v e r t e x v s u c h t h a t L ( v ) = m i n { L ( w ) : w ∈ R ( u ) } . G i v e a n O ( | V | + | E | ) - t i m e a l g o r i t h m t h a t c o m p u t e s m i n ( u ) f o r a l l v e r t i c e s u ∈ V . S o l u t i o n • U s e a S C C a l g o r i t h m t o c o m p u t e t h e S C C o f t h e o r i g i n a l g r a p h G i n O ( | V | + | E | ) - t i m e ; • f o r a l l n o d e s i n e a c h S C C , u s e t h e n o d e w i t h m i n i m u m l a b e l t o r e p r e - s e n t t h e m , a n d c o n s t r u c t t h e c o n d e n s a t i o n g r a p h G ∗ . • f o r G ∗ i s a D A G , d o a D F S o f G ∗ . W e c o n s t r u c t a a r r a y m i n [ ] t o r e c o r d t h e m i n ( u ) a n d a d d t h e f o l l o w i n g a s s e r t i o n s i n t h e s k e l e t o n o f D F S : 6 0 ⼀ 式到达 , 不定有直⻢边 ) ⼀ ≈ ⼀ ⼀ ⼀ ⼀ → UR ( ) 中 标号最⼩的 ⼀ 有环时⽆法搜 ☆ 会造成循环搜索 ~ 最⼩值 ! – w e s e t m i n [ v ] = v i n i t i a l l y ; – f o r a n y a d j a c e n t n o d e w o f n o d e v , w h e n t h e D F S o f w ﬁ n i s h e s , w e c o m p u t e : i f L ( m i n [ w ] ) < L ( m i n [ v ] ) , m i n [ v ] = m i n [ w ] ; • f o r a l l n o d e s i n e a c h S C C , t h e y h a v e t h e s a m e m i n ( ) . W e a s s i g n t h e u n d e ﬁ n e d v a l u e o f m i n ( ) a s t h e t h e v a l u e o f t h e n o d e i n G ∗ . C h a i n e d t o f o r m a c i r c l e G i v e n a n a r r a y o f s t r i n g s , ﬁ n d i f t h e g i v e n s t r i n g s c a n b e c h a i n e d t o f o r m a c i r c l e . A s t r i n g X c a n b e p u t b e f o r e a n o t h e r s t r i n g Y i n c i r c l e i f t h e l a s t c h a r a c t e r o f X i s s a m e a s ﬁ r s t c h a r a c t e r o f Y . I n d u c e d S u b g r a p h A n i n d u c e d s u b g r a p h o f a g r a p h G ( V , E ) i s a g r a p h H = ( U , F ) s u c h t h a t U ⊆ V a n d F = E ∩ ( U × U ) . G i v e n a n u n d i r e c t e d g r a p h G ( V , E ) a n d a n i n t e g e r k , ﬁ n d t h e m a x i m u m i n d u c e d s u b g r a p h H o f G s u c h t h a t e a c h v e r t e x i n H h a s d e g r e e a t l e a s t k , o r d e t e r m i n e t h a t i t d o e s n o t e x i s t . T h e a l g o r i t h m s h o u l d r u n i n t i m e O ( n + m ) . V e r t e x C o v e r A v e r t e x c o v e r o f a g r a p h G = ( V , E ) i s a s u b s e t o f v e r t i c e s S ⊆ V t h a t i n - c l u d e s a t l e a s t o n e e n d p o i n t o f e v e r y e d g e i n E . G i v e a l i n e a r - t i m e a l g o r i t h m f o r t h e f o l l o w i n g t a s k . ( 1 5 ) I n p u t : A n u n d i r e c t e d t r e e G = ( T , E ) w i t h t h e r o o t v e r t e x s . O u t p u t : T h e s i z e o f t h e s m a l l e s t v e r t e x c o v e r o f T . S o l u t i o n I n t h e t r e e T , t h e t o t a l t r e e c o u l d b e c o n s i d e r e d a s a r o o t n o d e a n d s e v e r a l s u b - t r e e s r o o t e d a t i t s c h i l d r e n n o d e s . W e d e s i g n t w o a r r a y s e l e c t e d [ 1 . . . n ] a n d i g n o r e [ 1 . . . n ] , w h e r e s e l e c t e d [ v ] d e n o t e s t h e s i z e o f t h e s m a l l e s t v e r t e x c o v e r o f t h e s u b t r e e r o o t e d a t v , w h e n v i s a d d e d i n t h i s v e r t e x c o v e r ; i g n o r e d [ v ] d e n o t e s t h e s i z e w h e n v i s n o t a d d e d i n t h i s v e r t e x c o v e r . F o r a n o d e v , t h e v a l u e o f s e l e c t e d [ v ] a n d i g n o r e d [ v ] a r e r e c u r s i v e l y d e ﬁ n e d b y t h e v a l u e s o f i t s c h i l d r e n n o d e s w : s e l e c t e d [ v ] = 1 + ! m i n { s e l e c t e d [ w ] , i g n o r e [ w ] } i g n o r e [ v ] = ! s e l e c t e d [ w ] T h e s i z e o f t h e s m a l l e s t v e r t e x c o v e r o f T r o o t e d a t s i s m a x { s e l e c t e d [ s ] , i g n o r e [ s ] } 7 ( 个⼩于 k 的点⼀定世去 , 因为 其下能品绍选样 , 基相 多源 BFS , 册法度⼩于 k 的邻艺点度也减⼀ , 若⼦⼿ k ( 继续 111 ) 0 f u n c t i o n v o i d m a i n ( I n t l i s t [ ] a d j V e r t i c e s , i n t n , i n t r o o t , i n t s i z e ) i n t [ ] c o l o r = n e w i n t [ n ] ; i n t [ ] s e l e c t e d = n e w i n t [ n ] ; i n t [ ] i g n o r e d = n e w i n t [ n ] ; i n t v = r o o t ; I n i t i a l i z e c o l o r a r r a y t o w h i t e f o r a l l v e r t i c e s ; v c D F S ( a d j V e r t i c e s , c o l o r , v , s e l e c t e d , i g n o r e d ) ; r e t u r n m a x { s e l e c t e d [ v ] , i g n o r e d [ v ] } ; e n d f u n c t i o n f u n c t i o n v o i d v c D F S ( I n t L i s t [ ] a d j V e r t i c e s , i n t [ ] c o l o r , i n t v , i n t [ ] s e l e c t e d , i n t [ ] i g n o r e d ) i n t w ; I n t L i s t r e m A d j ; c o l o r [ v ] = g r a y ; r e m A d j = a d j V e r t i c e s [ v ] ; s e l e c t e d [ v ] = 1 ; i g n o r e d [ v ] = 0 ; w h i l e r e m A d j ∕= n i l d o w = f i r s t ( r e m A d j ) ; i f c o l o r [ w ] = = w h i t e t h e n v c D F S ( a d j V e r t i c e s , c o l o r , w , s e l e c t e d , i g n o r e d ) ; s e l e c t e d [ v ] + = i g n o r e d [ w ] ; i g n o r e d [ v ] + = s e l e c t e d [ w ] ; r e m A d j = r e s t ( r e m A d j ) ; e n d i f e n d w h i l e c o l o r [ v ] = b l a c k ; r e t u r n ; e n d f u n c t i o n T h e P a t h f r o m t h e R o o t t o t h e B o t t o m G i v e n a t r e e ( n o t n e c e s s a r i l y a b i n a r y t r e e ) a n d a n u m b e r o f q u e r i e s s u c h t h a t e v e r y q u e r y t a k e s t w o n o d e s o f t h e t r e e a s p a r a m e t e r s . F o r e v e r y q u e r y p a i r , ﬁ n d i f t w o n o d e s a r e o n t h e s a m e p a t h f r o m t h e r o o t t o t h e b o t t o m . F o r e x a m p l e , c o n s i d e r t h e b e l o w t r e e , i f g i v e n q u e r i e s a r e ( 1 , 5 ) , ( 1 , 6 ) , a n d ( 2 , 6 ) , t h e n a n s w e r s s h o u l d b e t r u e , t r u e , a n d f a l s e r e s p e c t i v e l y . P l e a s e i m p l e m e n t a s o l u t i o n t o r e t u r n t h e a n s w e r f o r e a c h q u e r y i n O ( 1 ) - t i m e a f t e r O ( n ) - t i m e p r e - p r o c e s s i n g . S o l u t i o n W e s t a r t w a l k i n g f r o m t h e r o o t i n D F S m a n n e r . 8 从⽣常周期制迪红喝还是交叉也 , 如果是交叉也 o 叫谈明不在⼀路上 • I n t i m e W h e n w e v i s i t t h e n o d e f o r t h e ﬁ r s t t i m e • O u t t i m e - I f w e a g a i n v i s i t t h e n o d e l a t e r b u t t h e r e a r e n o c h i l d r e n u n v i s i t e d w e c a l l i t o u t t i m e N o t e : A n y n o d e i n i t s s u b - t r e e w i l l a l w a y s h a v e i n t i m e s m a l l e r t h a n i t s c h i l d r e n ( o r c h i l d r e n o f c h i l d r e n ) b e c a u s e i t i s a l w a y s v i s i t e d ﬁ r s t b e f o r e c h i l d r e n ( d u e t o D F S ) a n d w i l l h a v e o u t t i m e l a r g e r t h a n a l l n o d e s i n i t s s u b - t r e e b e c a u s e b e f o r e n o t i n g t h e o u t t i m e i t w a i t s f o r a l l o f i t s c h i l d r e n t o b e m a r k e d v i s i t e d . F o r a n y t w o n o d e s u , v i f t h e y a r e i n t h e s a m e p a t h t h e n , i t s a t i s ﬁ e s o n e o f t h e f o l l o w i n g t w o c o n d i t i o n s : • I n t i m e [ v ] < I n t i m e [ u ] a n d O u t t i m e [ v ] > O u t t i m e [ u ] • I n t i m e [ u ] < I n t i m e [ v ] a n d O u t t i m e [ u ] > O u t t i m e [ v ] I f a g i v e n p a i r o f n o d e s f o l l o w s a n y o f t h e t w o c o n d i t i o n s , t h e n t h e y a r e o n t h e s a m e r o o t t o t h e l e a f p a t h . E l s e n o t o n t h e s a m e p a t h ( I f t w o n o d e s a r e o n d i ﬀ e r e n t p a t h s i t m e a n s t h a t n o o n e i s i n t h e s u b t r e e o f e a c h o t h e r ) . P r o b l e m 5 G r e e d y a n d D y n a m i c P r o g r a m m i n g P r o f e s s o r L i i s c o n s u l t i n g f o r t h e p r e s i d e n t o f a c o r p o r a t i o n t h a t i s p l a n n i n g a c o m p a n y p a r t y . T h e c o m p a n y h a s a h i e r a r c h i c a l s t r u c t u r e ; t h a t i s , t h e s u p e r v i s o r r e l a t i o n f o r m s a t r e e r o o t e d a t t h e p r e s i d e n t . I n o r d e r t o m a k e t h e p a r t y f u n f o r a l l a t t e n d e e s , t h e p r e s i d e n t d o e s n o t w a n t b o t h a n e m p l o y e e a n d h i s o r h e r i m m e d i a t e s u p e r v i s o r t o a t t e n d . P r o f e s s o r L i i s g i v e n t h e t r e e c o n t a i n i n g n n o d e s , t h a t d e s c r i b e s t h e s t r u c t u r e o f t h e c o r p o r a t i o n . E a c h n o d e o f t h e t r e e h o l d s , i n a d d i t i o n t o t h e p o i n t e r , t h e n a m e o f a n e m p l o y e e a n d t h a t e m p l o y e e ’ s c o n v i v i a l i t y r a n k i n g . D e s c r i b e a n a l g o r i t h m t o m a k e u p a g u e s t l i s t t h a t m a x i m i z e s t h e s u m o f t h e c o n v i v i a l i t y r a t i n g s C R ( ) o f t h e g u e s t s . A n a l y z e t h e r u n n i n g t i m e o f y o u r a l g o r i t h m . S o l u t i o n I n t h e t r e e T , t h e t o t a l t r e e c o u l d b e c o n s i d e r e d a s a r o o t n o d e a n d s e v e r a l s u b - t r e e s r o o t e d a t i t s c h i l d r e n n o d e s . W e d e s i g n t w o a r r a y s e l e c t e d [ 1 . . . n ] a n d i g n o r e [ 1 . . . n ] , w h e r e s e l e c t e d [ v ] d e n o t e s t h e m a x s u m o f c o n v i v i a l i t y r a t i n g s o f t h e g u e s t s s e l e c t e d f r o m t h e s u b t r e e r o o t e d a t v , w h e n v i s a d d e d i n t h e g u e s t l i s t ; i g n o r e d [ v ] d e n o t e s t h e m a x s u m w h e n v i s n o t a d d e d i n t h e g u e s t l i s t . F o r a n o d e v , t h e v a l u e o f s e l e c t e d [ v ] a n d i g n o r e d [ v ] a r e 9 r e c u r s i v e l y d e ﬁ n e d b y t h e v a l u e s o f i t s c h i l d r e n n o d e s w : s e l e c t e d [ v ] = C R ( v ) + ! i g n o r e [ w ] i g n o r e [ v ] = ! m a x { s e l e c t e d [ w ] , i g n o r e [ w ] } A n d f o r r o o f n o d e s v , s e l e c t e d [ v ] = C R ( v ) a n d i g n o r e [ v ] = 0 ; T h e m a x s u m o f c o n v i v i a l i t y i s m a x { s e l e c t e d [ s ] , i g n o r e [ s ] } S i m p l i ﬁ e d 0 - 1 k n a p s a c k p r o b l e m S u p p o s e t h a t i n a 0 - 1 k n a p s a c k p r o b l e m , m a x n ! i = 1 x i v i s a t . n ! i = 1 x i w i ≤ C x i ∈ { 0 , 1 } , 1 ≤ i ≤ n t h e o r d e r o f t h e i t e m s w h e n s o r t e d b y i n c r e a s i n g w e i g h t w i i s t h e s a m e a s t h e i r o r d e r w h e n s o r t e d b y d e c r e a s i n g v a l u e v i . G i v e a n e ﬃ c i e n t a l g o r i t h m t o ﬁ n d a n o p t i m a l s o l u t i o n t o t h i s v a r i a n t o f t h e k n a p s a c k p r o b l e m , a n d a r g u e t h a t y o u r a l g o r i t h m i s c o r r e c t . M a x i m u m s u m b i t o n i c s u b a r r a y G i v e n a n a r r a y c o n t a i n i n g n n u m b e r s . T h e p r o b l e m i s t o ﬁ n d t h e m a x i m u m s u m b i t o n i c s u b a r r a y . A b i t o n i c s u b a r r a y i s a s u b a r r a y i n w h i c h e l e m e n t s a r e ﬁ r s t i n c r e a s i n g a n d t h e n d e c r e a s i n g . A s t r i c t l y i n c r e a s i n g o r s t r i c t l y d e c r e a s i n g s u b a r r a y i s a l s o c o n s i d e r e d a s b i t o n i c s u b a r r a y . T i m e C o m p l e x i t y o f O ( n ) i s r e q u i r e d . M i n i m u m c o s t t o c o n n e c t w e i g h t e d n o d e s r e p r e s e n t e d a s a r r a y G i v e n a n a r r a y o f N e l e m e n t s ( n o d e s ) , w h e r e e v e r y e l e m e n t i s w e i g h t o f t h a t n o d e . C o n n e c t i n g t w o n o d e s w i l l t a k e a c o s t o f p r o d u c t o f t h e i r w e i g h t s . Y o u h a v e t o c o n n e c t e v e r y n o d e w i t h e v e r y o t h e r n o d e ( d i r e c t l y o r i n d i r e c t l y ) . O u t p u t t h e m i n i m u m c o s t r e q u i r e d . L o n g e s t a s c e n d i n g s u b s e q u e n c e T h e l o n g e s t a s c e n d i n g s u b s e q u e n c e p r o b l e m i s d e ﬁ n e d a s f o l l o w s . G i v e n a n a r r a y A [ 1 , . . . , n ] o f n d i s t i n c t n a t u r a l n u m b e r s , ﬁ n d t h e l e n g t h o f t h e l o n g e s t a s c e n d i n g s u b s e q u e n c e o f A , t h a t i s a l i s t A [ i 1 ] , A [ i 2 ] , . . . , A [ i m ] f o r s o m e 1 ≤ i 1 < i 2 < · · · < i m ≤ n , a n d A [ i 1 ] < A [ i 2 ] < · · · < A [ i m ] . D e s i g n a d y n a m i c p r o g r a m m i n g a l g o r i t h m t h a t s o l v e t h e p r o b l e m i n t i m e O ( n l o g n ) . 1 0 S o l u t i o n T h e O ( n 2 ) - t i m e s o l u t i o n , L ( i ) , c a n b e r e c u r s i v e l y w r i t t e n a s : • L ( i ) = 1 + m a x ( L ( j ) ) w h e r e 0 < j < i a n d A [ j ] < A [ i ] ; o r • L ( i ) = 1 , i f n o s u c h j e x i s t s . T h e O ( n l o g n ) - t i m e s o l u t i o n . I n g e n e r a l , w e h a v e s e t o f a c t i v e l i s t s o f v a r y i n g l e n g t h . W e a r e a d d i n g a n e l e m e n t A [ i ] t o t h e s e l i s t s . W e s c a n t h e l i s t s ( f o r e n d e l e m e n t s ) i n d e c r e a s i n g o r d e r o f t h e i r l e n g t h . W e w i l l v e r i f y t h e e n d e l e m e n t s o f a l l t h e l i s t s t o ﬁ n d a l i s t w h o s e e n d e l e m e n t i s s m a l l e r t h a n A [ i ] . O u r s t r a t e g y d e t e r m i n e d b y t h e f o l l o w i n g c o n d i t i o n s : • I f A [ i ] i s s m a l l e s t a m o n g a l l e n d c a n d i d a t e s o f a c t i v e l i s t s , w e w i l l s t a r t n e w a c t i v e l i s t o f l e n g t h 1 . • I f A [ i ] i s l a r g e s t a m o n g a l l e n d c a n d i d a t e s o f a c t i v e l i s t s , w e w i l l c l o n e t h e l a r g e s t a c t i v e l i s t , a n d e x t e n d i t b y A [ i ] . • I f A [ i ] i s i n b e t w e e n , w e w i l l ﬁ n d a l i s t w i t h l a r g e s t e n d e l e m e n t t h a t i s s m a l l e r t h a n A [ i ] . C l o n e a n d e x t e n d t h i s l i s t b y A [ i ] . W e w i l l d i s c a r d a l l o t h e r l i s t s o f s a m e l e n g t h a s t h a t o f t h i s m o d i ﬁ e d l i s t . L e t u s t a k e e x a m p l e { 0 , 8 , 4 , 1 2 , 2 , 1 0 , 6 , 1 4 , 1 , 9 , 5 , 1 3 , 3 , 1 1 , 7 , 1 5 } . A [ 0 ] = 0 . C a s e 1 . T h e r e a r e n o a c t i v e l i s t s , c r e a t e o n e . 0 . — — — — — — — — — — — — — — — — — — — — — — — — — – A [ 1 ] = 8 . C a s e 2 . C l o n e a n d e x t e n d . 0 . 0 , 8 . — — — — — — — — — — — — — — — — — — — — — — — — — – A [ 2 ] = 4 . C a s e 3 . C l o n e , e x t e n d a n d d i s c a r d . 0 . 0 , 4 . 0 , 8 . D i s c a r d e d — — — — — — — — — — — — — — — — — — — — — — — — — – A [ 3 ] = 1 2 . C a s e 2 . C l o n e a n d e x t e n d . 0 . 0 , 4 . 0 , 4 , 1 2 . — — — — — — — — — — — — — — — — — — — — — — — — — – A [ 4 ] = 2 . C a s e 3 . C l o n e , e x t e n d a n d d i s c a r d . 0 . 0 , 2 . 1 1 0 , 4 . D i s c a r d e d . 0 , 4 , 1 2 . — — — — — — — — — — — — — — — — — — — — — — — — — – A [ 5 ] = 1 0 . C a s e 3 . C l o n e , e x t e n d a n d d i s c a r d . 0 . 0 , 2 . 0 , 2 , 1 0 . 0 , 4 , 1 2 . D i s c a r d e d . — — — — — — — — — — — — — — — — — — — — — — — — — – A [ 6 ] = 6 . C a s e 3 . C l o n e , e x t e n d a n d d i s c a r d . 0 . 0 , 2 . 0 , 2 , 6 . 0 , 2 , 1 0 . D i s c a r d e d . — — — — — — — — — — — — — — — — — — — — — — — — — – A [ 7 ] = 1 4 . C a s e 2 . C l o n e a n d e x t e n d . 0 . 0 , 2 . 0 , 2 , 6 . 0 , 2 , 6 , 1 4 . — — — — — — — — — — — — — — — — — — — — — — — — — – A [ 8 ] = 1 . C a s e 3 . C l o n e , e x t e n d a n d d i s c a r d . 0 . 0 , 1 . 0 , 2 . D i s c a r d e d . 0 , 2 , 6 . 0 , 2 , 6 , 1 4 . — — — — — — — — — — — — — — — — — — — — — — — — — – A [ 9 ] = 9 . C a s e 3 . C l o n e , e x t e n d a n d d i s c a r d . 0 . 0 , 1 . 0 , 2 , 6 . 0 , 2 , 6 , 9 . 0 , 2 , 6 , 1 4 . D i s c a r d e d . — — — — — — — — — — — — — — — — — — — — — — — — — – A [ 1 0 ] = 5 . C a s e 3 . C l o n e , e x t e n d a n d d i s c a r d . 0 . 0 , 1 . 0 , 1 , 5 . 0 , 2 , 6 . D i s c a r d e d . 0 , 2 , 6 , 9 . — — — — — — — — — — — — — — — — — — — — — — — — — – A [ 1 1 ] = 1 3 . C a s e 2 . C l o n e a n d e x t e n d . 0 . 1 2 0 , 1 . 0 , 1 , 5 . 0 , 2 , 6 , 9 . 0 , 2 , 6 , 9 , 1 3 . — — — — — — — — — — — — — — — — — — — — — — — — — – A [ 1 2 ] = 3 . C a s e 3 . C l o n e , e x t e n d a n d d i s c a r d . 0 . 0 , 1 . 0 , 1 , 3 . 0 , 1 , 5 . D i s c a r d e d . 0 , 2 , 6 , 9 . 0 , 2 , 6 , 9 , 1 3 . — — — — — — — — — — — — — — — — — — — — — — — — — – A [ 1 3 ] = 1 1 . C a s e 3 . C l o n e , e x t e n d a n d d i s c a r d . 0 . 0 , 1 . 0 , 1 , 3 . 0 , 2 , 6 , 9 . 0 , 2 , 6 , 9 , 1 1 . 0 , 2 , 6 , 9 , 1 3 . D i s c a r d e d . — — — — — — — — — — — — — — — — — — — — — — — — — – A [ 1 4 ] = 7 . C a s e 3 . C l o n e , e x t e n d a n d d i s c a r d . 0 . 0 , 1 . 0 , 1 , 3 . 0 , 1 , 3 , 7 . 0 , 2 , 6 , 9 . D i s c a r d e d . 0 , 2 , 6 , 9 , 1 1 . — — — — — — — — — — — — — — — — — — — — — — — — — - A [ 1 5 ] = 1 5 . C a s e 2 . C l o n e a n d e x t e n d . 0 . 0 , 1 . 0 , 1 , 3 . 0 , 1 , 3 , 7 . 0 , 2 , 6 , 9 , 1 1 . 0 , 2 , 6 , 9 , 1 1 , 1 5 . D o n e ! — — — — — — — — — — — — — — — — — — — — — — — — — - N o A d j a c e n t C h a r a c t e r s G i v e n a s t r i n g w i t h r e p e a t e d c h a r a c t e r s ( a s s u m e d t h a t t h e s t r i n g h a s o n l y l o w e r c a s e e n g l i s h a l p h a b e t s , i . e . , a , b , . . . , z ) , t h e t a s k i s t o r e a r r a n g e c h a r - a c t e r s i n a s t r i n g s o t h a t n o t w o a d j a c e n t c h a r a c t e r s a r e s a m e . E x a m p l e s : 1 3 I n p u t : a a a b c O u t p u t : a b a c a S o l u t i o n W e h a v e t h e f o l l o w i n g s t e p s t o d e s i g n o u r a l g o r i t h m : • S c a n t h e w h o l e s t r i n g a n d s t o r e t h e f r e q u e n c i e s o f l o w e r c a s e e n g l i s h a l p h a b e t s a p p e a r i n g i n t h e s t r i n g i n F r e [ 0 . . 2 5 ] , i . e . , F r e [ 0 ] f o r a , F r e [ 1 ] f o r b , . . . , a n d F r e [ 2 5 ] f o r z ; • F i n d t h e m a x n u m b e r i n F r e [ 0 ] ( d e n o t e d a s F r e [ i ∗ ] ) ; • C h e c k w h e t h e r t h e s u m o f t h e o t h e r f r e q u e n c i e s i s l a r g e r o r e q u a l t o F r e [ i ∗ ] − 1 : 2 5 ! i = 0 , i ∕= i ∗ F r e [ i ] ≥ F r e [ i ∗ ] − 1 i f t h e a n s w e r i s n o , r e t u r n “ c a n n o t r e a r r a n g e c h a r a c t e r s ” ; • R e a r r a n g e c h a r a c t e r s : a . c o n s t r u c t m = F r e [ i ∗ ] s u b s t r i n g s , d e n o t e d a s S t r 1 , S t r 2 , . . . , S t r m ; b . i n i t i a l l y a d d t h e a l p h a b e t w i t h t h e m a x f r e q u e n c y F r e [ i ∗ ] a t t h e b e g i n n i n g o f e a c h s u b s t r i n g S t r j ; c . f o r t h e o t h e r a l p h a b e t s , s e q u e n t i a l l y a d d m = F r e [ i ] a l p h a b e t s ( o n e b y o n e ) t o t h e e n d s o f e a c h s u b s t r i n g S t r j F e w e s t c u t s f o r p a l i n d r o m e p a r t i t i o n i n g s G i v e n a s t r i n g , a p a r t i t i o n i n g o f t h e s t r i n g i s a p a l i n d r o m e p a r t i t i o n i n g i f e v e r y s u b s t r i n g o f t h e p a r t i t i o n i s a p a l i n d r o m e , e . g . , a b a | b | b b a b b | a | b | a b a i s a p a l i n d r o m e p a r t i t i o n i n g o f a b a b b b a b b a b a b a . D e t e r m i n e t h e f e w e s t c u t s n e e d e d f o r a p a l i n d r o m e p a r t i t i o n i n g o f a g i v e n s t r i n g . F o r e x a m p l e , 3 c u t s a r e n e e d e d f o r a b a b b b a b b a b a b a , w h i c h a r e a | b a b b b a b | b | a b a b a . I f a s t r i n g i s a p a l i n d r o m e , t h e n m i n i m u m 0 c u t s a r e n e e d e d . I f a s t r i n g o f l e n g t h n c o n t a i n i n g a l l d i ﬀ e r e n t c h a r a c t e r s , t h e n m i n i m u m n − 1 c u t s a r e n e e d e d . ( 1 5 p o i n t s ) S o l u t i o n G i v e n a s t r i n g s 1 , s 2 , . . . , s n w i t h n a l p h a b e t s , w e d e s i g n t h e a l g o r i t h m b y t h e f o l l o w i n g t w o s t e p s : 1 4 ra 4 b 3 c a _ - Q - - a - a - d - • U s e O ( n 2 ) t o c a l c u l a t e a n d s t o r e w h e t h e r s u b s t r i n g s s i , s i + 1 , . . . , s j ( 1 ≤ i ≤ j ≤ n ) a r e p a l i n d r o m e . A n a r r a y L ( i , j ) ( 1 ≤ i ≤ j ≤ n ) c a n b e r e c u r s i v e l y w r i t t e n a s : – L ( i , j ) = t r u e , w h e r e i = j ; – L ( i , j ) = I ( s i = s j ) , w h e r e i = j − 1 ; – L ( i , j ) = L ( i − 1 , j − 1 ) ∧ I ( s i = s j ) , w h e r e i < j − 1 ; • U s e O ( n 2 ) t o c o m p u t e t h e f e w e s t c u t s . A n a r r a y C [ k ] ( 1 ≤ k ≤ n ) c a n r e c u r s i v e l y w r i t t e n a s : – C [ k ] = 0 , w h e r e L ( 1 , k ) = t u r e ; – C [ k ] = m i n { C [ l ] | 1 ≤ l ≤ n , L ( l + 1 , k ) = t u r e } + 1 , w h e r e L ( 1 , k ) = f a l s e ; P r o b l e m 6 P r o v i n g N P C P r o b l e m s R e d u c i b l e a . S h o w t h a t ﬁ n d i n g t h e m e d i a n o f a s e t S a n d ﬁ n d i n g t h e k - t h s m a l l e s t e l e m e n t a r e r e d u c i b l e t o e a c h o t h e r . b . T h e d e n s e s u b g r a p h p r o b l e m i s d e ﬁ n e a s f o l l o w i n g . G i v e n a n u n d i r e c t e d g r a p h G , d o e s i t c o n t a i n a s u b g r a p h H t h a t h a s e x a c t l y K v e r t i c e s a n d a t l e a s t Y e d g e s ? P r o v e t h a t t h i s p r o b l e m i s N P - c o m p l e t e . Y o u c a n p i c k a n y p r o b l e m t o r e d u c e f r o m . 0 - 1 i n t e g e r p r o g r a m m i n g p r o b l e m N o w w e f a c e t w o p r o b l e m s : • I n t h e s u b s e t - s u m p r o b l e m , w e a r e g i v e n a ﬁ n i t e s e t S o f p o s i t i v e i n t e g e r s a n d a n i n t e g e r t a r g e t C > 0 . W e a s k w h e t h e r t h e r e e x i s t s a s u b s e t S ∗ ⊆ S w h o s e e l e m e n t s s u m t o C . • I n t h e 0 - 1 i n t e g e r p r o g r a m m i n g p r o b l e m , w e a r e g i v e n a n i n t e g e r m × n m a t r i x A a n d a n i n t e g e r m - v e c t o r b . W e a s k s w h e t h e r t h e r e e x i s t s a n i n t e g e r n - v e c t o r x w i t h e l e m e n t s i n t h e s e t { 0 , 1 } s u c h t h a t A x ≥ b . A s s u m e w e k n o w t h a t t h e s u b s e t - s u m p r o b l e m i s N P - h a r d . P r o v e t h a t 0 - 1 i n t e g e r p r o g r a m m i n g i s N P - c o m p l e t e . ( 1 5 ) I t i s e a s y t o s h o w t h a t 0 - 1 i n t e g e r p r o g r a m m i n g ∈ N P . W e n e x t p r o v e t h a t s u b s e t - s u m ≤ P 0 - 1 i n t e g e r p r o g r a m m i n g . O u r p r o o f b e g i n s w i t h a n i n s t a n c e φ o f s u b s e t - s u m p r o b l e m . G i v e n a ﬁ n i t e s e t S = { s 1 , s 2 , . . . , s n } o f p o s i t i v e i n t e g e r s a n d a n i n t e g e r t a r g e t C . 1 5 [ ) * … … … [ ) … ^ … … [ ] m W e c o n s t r u c t t h e m a t r i x A ( n × 2 ) a s f o l l o w s : a [ i ] [ j ] = # s i j = 1 , − s i j = 2 A n d w e d e ﬁ n e t h e i n t e g e r k - v e c t o r b a s : b = $ C − C % I t i s e a s y t o p r o v e t h e e q u i v a l e n c e b e t w e e n t h e s e t w o p r o b l e m s . T h e r e f o r e 0 - 1 i n t e g e r p r o g r a m m i n g i s N P - h a r d . h a l f 3 - C N F s a t i s ﬁ a b i l i t y p r o b l e m I n t h e h a l f 3 - C N F s a t i s ﬁ a b i l i t y p r o b l e m , w e a r e g i v e n a 3 - C N F f o r m u l a θ w i t h n v a r i a b l e s a n d m c l a u s e s , w h e r e m i s e v e n . W e w i s h t o d e t e r m i n e w h e t h e r t h e r e e x i s t s a t r u t h a s s i g n m e n t t o t h e v a r i a b l e s o f θ s u c h t h a t e x a c t l y h a l f t h e c l a u s e s e v a l u a t e t o 0 a n d e x a c t l y h a l f t h e c l a u s e s e v a l u a t e t o 1 . P r o v e t h a t t h e h a l f 3 - C N F s a t i s ﬁ a b i l i t y p r o b l e m i s N P - c o m p l e t e . S o l u t i o n G i v e n a n 3 - C N F f o r m u l a θ , a s s u m e t h a t θ c o n t a i n s m c l a u s e s : θ = C 1 ∧ C 2 ∧ · · · ∧ C m W e c o n s t r u c t n e w m + 2 c l a u s e s : • m + 1 c l a u s e s a r e t h e s a m e : C m + i = ( y 1 ∨ y 2 ∨ y 3 ) w h e r e y 1 , y 2 , y 3 a r e n e w v a r i a b l e s a n d 1 ≤ i ≤ m + 1 . • 1 c l a u s e C 2 m + 2 = ( z 1 ∨ ¬ z 1 ∨ z 2 ) , w h e r e z 1 , z 2 a r e a l s o n e w v a r i a b l e s . N o t e t h a t C 2 m + 2 a l w a y s e v a l u a t e s t o 1 . W e a d d t h e a b o v e m + 2 c l a u s e s t o θ θ ∗ = C 1 ∧ C 2 ∧ · · · ∧ C m + 1 ∧ · · · ∧ C 2 m + 1 ∧ C 2 m + 2 N o w w e w i l l p r o v e t h a t t h e o r i g i n a l 3 - C N F f o r m u l a θ i s s a t i s ﬁ a b l e i ﬀ θ ∗ i s h a l f s a t i s ﬁ a b l e . P r o o f . → : i f θ i s s a t i s ﬁ a b l e , w e c a n g e t a t r u t h a s s i g n m e n t s u c h t h a t C 1 , . . . , C n e v a l u a t e t o 1 . S i n c e y 1 , y 2 , y 3 a r e n e w v a r i a b l e s , w e a s s i g n y 1 , y 2 , y 3 = 0 1 6 如 ! Sum ≥ C 7 SumC - sim ≥ - C o b v i o u s l y C m + 1 . . . C 2 m + 1 e v a l u a t e t o 0 . A n d C 2 m + 2 a l w a y s e v a l u a t e s t o 1 . T h e r e f o r e , w e g i v e a t r u t h a s s i g n m e n t t o t h e v a r i a b l e s o f θ ∗ s u c h t h a t e x a c t l y h a l f ( m + 1 ) t h e c l a u s e s e v a l u a t e t o 0 a n d h a l f t h e c l a u s e s e v a l u a t e t o 1 . ← : i f t h e r e e x i s t s a t r u t h a s s i g n m e n t t o t h e v a r i a b l e s o f θ ∗ s u c h t h a t e x a c t l y h a l f t h e c l a u s e s e v a l u a t e t o 0 a n d e x a c t l y h a l f t h e c l a u s e s e v a l u a t e t o 1 . S i n c e θ ∗ c o n t a i n s 2 m + 2 c l a u s e s , a c c o r d i n g t o t h i s a s s i g n m e n t , m + 1 e v a l u a t e t o 1 a n d t h e o t h e r m + 1 e v a l u a t e t o 0 . N o t e t h a t m + 1 c l a u s e s ( C m + 1 . . . C 2 m + 1 ) a r e t h e s a m e a n d C 2 m + 2 a l w a y s e v a l u a t e s t o 1 . T h e r e f o r e , C m + 1 . . . C 2 m + 1 m u s t e v a l u a t e t o 0 a n d t h e o t h e r s e v a l u a t e t o 1 . T h a t m e a n s t h e a s s i g n m e n t a l s o s a t i s ﬁ e s e v e r y c l a u s e o f θ . F r o m a b o v e , w e h a v e p r o v e 3 - C N F - S a t ≤ P h a l f - 3 - C N F - S a t . S i n c e 3 - C N F - S a t i s N P - C o m p l e t e , h a l f - 3 - C N F - S a t i s N P - h a r d . s u b g r a p h - i s o m o r p h i s m p r o b l e m T w o u n d i r e c t e d g r a p h s G = ( V , E ) a n d G ∗ = ( V ∗ , E ∗ ) a r e i s o m o r p h i c , i ﬀ t h e r e i s a o n e - t o - o n e m a p p i n g f f r o m V t o V ∗ , a n d f o r a n y x , y ∈ V , ( x , y ) ∈ E i ﬀ ( f ( x ) , f ( y ) ) ∈ E ∗ . T h e s u b g r a p h - i s o m o r p h i s m p r o b l e m t a k e s t w o u n d i r e c t e d g r a p h s G 1 a n d G 2 , a n d i t a s k s w h e t h e r G 1 i s i s o m o r p h i c t o a s u b g r a p h o f G 2 . S h o w t h a t t h e s u b g r a p h - i s o m o r p h i s m p r o b l e m i s N P - c o m p l e t e . m - P a r t i t i o n T h e p r o b l e m m - P a r t i t i o n i s d e ﬁ n e d a s f o l l o w s : g i v e n a s e t S o f m n p o s i t i v e i n t e g e r s , d e t e r m i n e w h e t h e r t h e e l e m e n t s o f S c a n b e s p l i t i n t o n s u b s e t s , e a c h w i t h m e l e m e n t s , w h o s e s u m s a r e a l l e q u a l . A s s u m e w e k n o w t h a t 3 - P a r t i t i o n i s N P - c o m p l e t e . P r o v e t h a t 5 - P a r t i t i o n i s N P - c o m p l e t e . ( 1 5 p o i n t s ) S o l u t i o n A s s u m e S = { s 1 , s 2 , . . . , s m n } • N P : ( a ) f o r a n y i n t e g e r s s i i n S , g u e s s t h e s u b s e t i t b e l o n g s t o a s i g ∈ { 1 , 2 , . . . , n } ; ( b ) s c a n a l l g u e s s e s t o c h e c k w h e t h e r t h e r e i s a p a r t i t i o n s a t i s f y i n g n g r o u p s w i t h e q u a l s u m s a n d m e l e m e n t s . • N P - h a r d : f o r 3 - P a r t i t i o n , t h e i n p u t i s S 3 = { s 1 , s 2 , . . . , s 3 n } ; w e c a l - c u l a t e t h e s u m o f S 3 : C = 3 n ! i = 1 s i 1 7 σ A n d w e c o m p u t e t h e e x p e c t e d a v e r a g e C / n . H e r e w e c o n s t r u c t t h e i n p u t f o r 5 - P a r t i t i o n a s S 5 = S 3 & s 3 n + 1 , . . . , s 5 n w h e r e s 3 n + 1 = s 3 n + 3 = · · · = s 5 n = 4 C / n . W e w i l l p r o v e t h a t , S 3 c o u l d b e 3 - P a r t i t i o n , i ﬀ S 5 c o u l d b e 5 - P a r t i t i o n . → i f S 3 c o u l d b e 3 - P a r t i t i o n , f o r e a c h s u b s e t , w e a d d t w o 4 C / n a n d c o n s t r u c t a v a l i d 5 - P a r t i t i o n f o r S 5 . ← i f S 5 c o u l d b e 5 - P a r t i t i o n , b a s e d o n a b o v e a n a l y s i s , w e h a v e , f o r e a c h s u b s e t , t h e s u m i s 9 C / n . A s s i ∈ S 3 i s p o s i t i v e , C / n > m a x x ∈ S 3 { x } . N o w w e c h e c k t h e n u m b e r s o f 4 C / n i n e a c h s u b s e t . ( a ) t h e n u m b e r c a n n o t l a r g e r t h a n 2 , s i n c e 4 C / n × 3 > 9 C / n ; ( b ) t h e n u m b e r c a n n o t l e s s 2 , s i n c e 4 C / n + 4 × C / n < 9 C / n . T h e r e f o r e , w e c a n c o n c l u d e t h a t i n e a c h s u b s e t , w e h a v e e x a c t l y t w o 4 C / n , w h i c h m e a n s t h e s u m o f t h e o t h e r 3 e l e m e n t s i s e q u a l t o C / n . P r o b l e m 7 P r o o f a n d A n a l y s i s T h e r e a r e n ( n > 2 ) c o i n s i d e n t i c a l i n a p p e a r a n c e . T h e r e m a y b e a t m o s t o n e f a k e c o i n , w h i c h i s l i g h t e r o r h e a v i e r t h a n t h o s e g e n u i n e o n e s . U s e a b a l a n c e s c a l e t o i d e n t i f y t h e f a k e c o i n . N o t e t h a t a b a l a n c e s c a l e c a n o n l y t e l l y o u w h e t h e r t h e t w o s i d e s w e i g h t h e s a m e , o r o n e s i d e i s h e a v i e r t h a n t h e o t h e r . • D r a w a d e c i s i o n t r e e f o r a n a l g o r i t h m t h a t s o l v e s t h e p r o b l e m f o r n = 5 i n 3 w e i g h i n g s • P r o v e a n y a l g o r i t h m f o r t h i s p r o b l e m m u s t m a k e a t l e a s t ⌈ l o g 3 ( 2 n + 1 ) ⌉ w e i g h i n g s i n t h e w o r s t c a s e . 1 8 c ⼀ D 妙 : 恰好只能有 2 个 ! ~ 假币重引没有 共 2 r + 1 种 每次⽐较有 L = 7 了种 故为 l φ 3 ( τ nt 1 )","libVersion":"0.2.4","langs":""}