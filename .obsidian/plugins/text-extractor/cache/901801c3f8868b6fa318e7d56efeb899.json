{"path":"pdf/算法设计与分析/23-Probability.pdf","text":"P r o b a b i l i s t i c A l g o r i t h m A l g o r i t h m : D e s i g n & A n a l y s i s [ 2 2 ] I n t h e L a s t C l a s s …  C o n q u e r t h e C o m p l e x i t y b y A p p r o x i m a t i o n  A p p r o x i m a t i o n A l g o r i t h m f o r B i n P a c k i n g  E v a l u a t e a n A p p r o x i m a t i o n A l g o r i t h m  O n l i n e a l g o r i t h m P r o b a b i l i s t i c A l g o r i t h m  A d d i n g R a n d o m n e s s i n t o A l g o r i t h m  P r i m a l i t y P r o b l e m  M o n t e C a r l o A l g o r i t h m f o r P r i m a l i t y T e s t i n g  p - C o r r e c t n e s s a n d B i a s  D e c r e a s i n g E r r o r P r o b a b i l i t y b y R e p e a t i n g R a n d o m i z a t i o n a s a C h o i c e T r e a s u r e ( ? ) Y o u a r e h e r e 5 d a y s 5 d a y s 5 d a y s I t t a k e s 4 d a y s t o f i n d o u t t h e e x a c t p o s i t i o n T r e a s u r e ( ? ) T r e a s u r e r o b b e d e v e r y n i g h t I n f o . F o r 3 d a y ’ s t r e a s u r e C h o i c e 1 : S o l v i n g – T r e a s u r e - 9 d C h o i c e 2 : B u y i n g – T r e a s u r e - 8 d H o w e v e r , a n o t h e r c h o i c e : t o s s i n g c o i n – T r e a s u r e - 7 . 5 d ( e x p e c t e d ) A M o r e S e r i o u s A p p l i c a t i o n C o m p u t e r A C o m p u t e r B f a r f a r a w a y W e w a n t t o v e r i f y t h e c o n s i s t e n c y b e t w e e n t h e t w o d a t a b a s e s o f s i z e n ( n = 1 0 1 6 , s a y ) l o c a t e d o n A a n d B . F o r a d e t e r m i n i s t i c a n s w e r , w e h a v e t o t r a n s f e r a m e s s a g e o f a t l e a s t n b i t s , a n d ( ! ) w i t h o u t a n e r r o r o n t h e w a y . I t d o e s n ’ t l o o k a p l e a s a n t t a s k . R a n d o m n e s s C a n H e l p L e t t h e d a t a b a s e i n A i s x = x 1 x 2 … x n , a n d t h a t i n B i s y = y 1 y 2 , … , y n N u m b e r ( x ) i s t h e v a l u e o f x a s a b i n a r y n u m b e r . R a n d o m i z e d P r o t o c o l f o r E q u a l i t y ( A , B ) 1 . A c h o o s e s u n i f o r m l y a p r i m e p f r o m [ 2 , n 2 ] a t r a n d o m . 2 . A c o m p u t e s s = n u m b e r ( x ) m o d p , a n d s e n d s s , p t o B ( n o t e : s a n d p c a n e a c h b e r e p r e s e n t e d i n  l o g 2 n 2  b i t s . ) 3 . B r e a d s s a n d p , a n d c o m p u t e s q = n u m b e r ( y ) m o d p 4 . B s e n d s m e s s a g e : “ y e s ” i f q = s ; a n d “ n o ” o t h e r w i s e . N o G u a r a n t e e , b u t P r e t t y G o o d  T h e p r o t o c o l m a y e r r : x = 0 1 1 1 1 ( 1 5 ) , y = 1 0 1 1 0 ( 2 2 ) , i f p = 7 , t h e n s = 1 , a n d q = 1 . S o , 7 i s a “ b a d ” p r i m e i n [ 2 , n 2 ] .  I n f a c t , i f x = y , t h e p r o t o c o l a l w a y s g i v e s t h e c o r r e c t a n s w e r , a n d i f x  y , w r o n g r e s u l t i s g i v e i f a “ b a d ” p r i m e s e l e c t e d .  S o , t h e p r o b a b i l i t y t h a t t h e p r o t o c o l e r r s i s t h e r a t i o o f “ b a d ” p r i m e i n t h e s e t o f a l l p r i m e i n [ 2 , n 2 ] .  F o r t u n a t e l y , t h e p r o b a b i l i t y i s l o w : l n n 2 / n , t h a t i s , n o g r e a t e r t h a n 0 . 3 6 8 9 2  1 0 - 1 4 f o r n = 1 0 1 6  A n o t h e r g o o d n e w s : t h e l e n g t h o f t h e m e s s a g e t r a n s f e r r e d i s n o l o n g e r t h a n 4  l o g 2 n 2  ( t h a t i s , 2 5 6 f o r n = 1 0 1 6 ) T w o C a t e g o r i e s o f R a n d o m n e s s  I n t r o d u c i n g r a n d o m n e s s t o t h e p r o c e s s o f s o l v i n g a p r o b l e m , b u t a l w a y s g i v e a c o r r e c t r e s u l t .  Q u i c k s o r t u s i n g r a n d o m l y s e l e c t e d p i v o t .  I n t r o d u c i n g r a n d o m n e s s t o t h e r e s u l t s . ( w h i c h y e a r w a s t h e P R C f o u n d e d ? a s a n e x a m p l e )  1 9 4 9 , 1 9 4 9 , 1 9 4 8 , 1 0 0 5 , 1 9 4 9 , 6 5 4 B . C , 1 9 4 9 , 1 9 4 9 , 2 0 0 5 , 1 9 4 9  1 9 4 9 , s o r r y , 1 9 4 9 , 1 9 4 9 , s o r r y , 1 9 4 9 , s o r r y , 1 9 4 9 , 1 9 4 9 , 1 9 4 9  B e t w e e n 1 9 0 0 t o 2 0 0 0 ; b e t w e e n 1 9 4 5 t o 1 9 5 0 ; b e t w e e n 1 5 0 3 t o 1 8 4 5 ; b e t w e e n … ( t h e p r o b l e m i s : w h a t s h o u l d I b e l i e v e ? P r i m a l i t y T e s t i n g  P r o b l e m : I s a g i v e n ( o d d ) p o s i t i v e i n t e g e r a p r i m e ?  T h e a l g o r i t h m y o u a r e f a m i l i a r w i t h : B o o l e a n T e s t P r i m a l i t y ( n ) i n t i ; f o r ( i = 2 ; i   √ n  ; i + + ) i f ( n m o d i = 0 ) r e t u r n f a l s e ; r e t u r n t r u e T h e A l g o r i t h m i s E x p o n e n t i a l  F o r n u m b e r - t h e o r e t i c a l g o r i t h m s , w e u s u a l l y t a k e t h e i n p u t s i z e t o b e t h e n u m b e r o f d i g i t s i n n .  U s i n g d e c i m a l s y s t e m , t h e n u m b e r o f d i g i t s i n n i s m =  l o g 1 0 ( n + 1 )   T h e f u n c t i o n T e s t P r i m a l i t y e x e c u t e s t h e f o r l o o p  √ n  t i m e s i n t h e w o r s t c a s e , w h i c h i s a b o u t 1 0 m / 2 .  I f n h a s m o r e t h a n 4 0 d i g i t s , i t w o u l d t a k e m i l l i o n s o f y e a r s t o s a y “ y e s ” . R a n d o m n e s s I n t r o d u c e d S i m p l y B o o l e a n T e s t P r i m a l i t y R a n d o m ( n ) i n t j ; R a n d o m ( { 2 , . . ,  √ n  } , j ) i f ( n m o d j = 0 ) r e t u r n f a l s e ; e l s e r e t u r n t r u e ; H o w e v e r , t h e a l g o r i t h m i s u n a c c e p t a b l e i n p r a c t i c e . E v e n t h o u g h i t i s r e a l l y “ n o t ” w h e n r e t u r n e d v a l u e i s “ f a l s e ” , i t h a s n o a n y p o s i t i v e “ f i x e d c o n f i d e n c e l e v e l ” i f t h e r e t u r n e d v a l u e i s “ t r u e ” . M o n t e C a r l o A l g o r i t h m s  F o r a ( f i x e d ) r e a l n u m b e r p , 0 < p < 1 , a p - c o r r e c t M o n t e C a r l o a l g o r i t h m i s a p r o b a b i l i s t i c a l g o r i t h m t h a t r e t u r n s t h e c o r r e c t a n s w e r w i t h p r o b a b i l i t y n o t l e s s t h a n p n o m a t t e r w h a t i n p u t i s c o n s i d e r e d .  N o t e : t h e a l g o r i t h m T e s t P r i m a l i t y R a n d o m i s 1 0 0 % c o r r e c t i f i t r e t u r n s “ f a l s e ” , ( o n t h e o t h e r h a n d , i f n = p 1 p 2 w i t h p r i m e s p 1 < p 2 , t h e a l g o r i t h m h a s o n l y 1 / p 1 p r o b a b i l i t y t o g i v e a c o r r e c t “ f a l s e ” ) , b u t i s c o r r e c t w i t h A N Y s m a l l p r o b a b i l i t y i f i t r e t u r n s “ t r u e ” .  B a d n e w s : t h e r e i s u s u a l l y n o e f f i c i e n t m e t h o d a v a i l a b l e t o t e s t w h e t h e r a n a n s w e r r e t u r n e d b y a M o n t e C a r l o a l g o r i t h m f o r a g i v e n i n p u t i s c o r r e c t . H e l p f r o m a s E a r l y a s 1 6 4 0  F e r m a t ’ s l i t t l e t h e o r e m :  I f n i s a p r i m e , t h e n f o r a l l p o s i t i v e a < n , a n - 1  1 ( m o d n ) ( f o r e x a m p l e : 1 6 = 0  7 + 1 ; 2 6 = 9  7 + 1 ; … , 5 6 = 2 2 3 2  7 + 1 ; 6 6 = 6 6 6 5  7 + 1 )  [ C o n t r a p o s i t i o n o f F e r m a t ’ s l i t t l e t h e o r e m ]  I f n a n d a a r e i n t e g e r s s u c h t h a t 1  a  n , a n d t h e m o d u l a r e q u a t i o n a b o v e d o e s n o t h o l d f o r t h e m , t h e n n i s N O T a p r i m e . ( a d e t e r m i n i s t i c r e s u l t f o r n e g a t i n g a n n a t u r a l n u m b e r b e i n g p r i m e ) W h a t a b o u t P o s i t i v e R e s u l t  T h e f o l l o w i n g s t a t e m e n t D O E S N ’ T h o l d :  I f a n - 1  1 ( m o d n ) f o r s o m e n a t u r a l n u m b e r n a n d a ( a < n ) , t h e n n i s p r i m e ( f a l s e ! ) .  I f f a c t , t h e r e d o e x i s t c o m p o s i t e n u m b e r s n , f o r w h i c h a n - 1  1 ( m o d n ) f o r m o s t a < n . ( e v e n f o r a l l a < n )  H o w e v e r  G o o d n e w s : m o s t c o m p o s i t e n u m b e r s n h a v e m a n y i n t e g e r s a i n { 2 , … , n - 1 } s u c h t h a t a n - 1  1 ( m o d n )  I t s e e m s t h a t a t e s t f o r p r i m a l i t y f o r T H O S E c o m p o s i t e n u m b e r s t h a t h a s a h i g h p r o b a b i l i t y o f b e i n g c o r r e c t i s t o t e s t w h e t h e r a n - 1  1 ( m o d n ) f o r a r a n d o m c h o i c e o f a . M o n t e C a r l o A l g o r i t h m f o r P r i m a l i t y B o o l e a n F e r m a t T e s t P r i m a l i t y ( n ) i n t a ; R a n d o m ( { 2 , 3 , … , n - 2 } , a ) ; i f e x p o m o d ( a , n - 1 , n ) = 1 r e t u r n t r u e ; r e t u r n f a l s e ; i n t e x p o m o d ( a , n , z ) / / c o m p u t e s a n m o d z i n t i , r , x ; i = n ; r = 1 ; x = a m o d z ; w h i l e ( i > 0 ) i f i i s o d d r = r x m o d z ; x = x 2 m o d z ; i = i d i v 2 ; r e t u r n r ; N o t e t h e f a c t s : x y m o d z = ( x m o d z ) ( y m o d z ) m o d z ; ( x m o d z ) y m o d z = x y m o d z ; T h e l o o p i s e x e c u t e d a b o u t l o g n t i m e s F a l s e W i t n e s s o f P r i m a l i t y  W h e n F e r m a t T e s t P r i m a l i t y r e t u r n s “ f a l s e ” , n i s N O T a p r i m e w i t h c e r t a i n t y , b u t w h a t a b o u t a r e t u r n e d v a l u e o f “ t r u e ” ?  E x a m p l e s o f f a i l s : ( n - 1 ) n - 1 m o d n = 1 f o r a l l o d d n  3 ; a n d a n o n t r i v i a l e x a m p l e : 4 1 4 m o d 1 5 = 1 . ( 4 i s c a l l e d a f a l s e w i t n e s s o f p r i m a l i t y ) W h a t ’ s t h e R i s k  G o o d n e w s – f a l s e w i t n e s s a r e r a t h e r f e w : f o r a l l o d d c o m p o s i t e l e s s t h a n 1 0 0 0 , m o r e t h a n h a l f h a v e o n l y 2 f a l s e w i t n e s s , a n d l e s s t h a n 1 6 % h a v e m o r e t h a n 1 5 . T h e a v e r a g e e r r o r p r o b a b i l i t y o n o d d c o m p o s i t e s m a l l e r t h a n 1 0 0 0 i s l e s s t h a n 3 . 3 % .  B a d n e w s – s o m e o d d c o m p o s i t e s a d m i t a s i g n i f i c a n t p r o p o r t i o n o f f a l s e w i t n e s s : t h e w o r s t c a s e a m o n g o d d c o m p o s i t e s s m a l l e r t h a n 1 0 0 0 i s 5 6 1 w i t h 3 1 8 f a l s e w i t n e s s , a n d 6 5 1 6 9 3 0 5 5 6 9 3 6 8 1 i s a c o m p o s i t e b u t r e t u r n “ t r u e ” w i t h p r o b a b i l i t y o f 9 9 . 9 9 6 5 % .  I n f a c t , F e r m a t T e s t P r i m a l i t y i s N O T p - c o r r e c t f o r a n y p > 0 . A S p e c i a l S e t f o r T e s t i n g  L e t n b e a n o d d i n t e g e r g r e a t e r t h a n 4 , a n d n - 1 = 2 s t , w h e r e t i s o d d . D e f i n e s e t B ( n ) a s f o l l o w s :  a  B ( n ) i f a n d o n l y i f 2  a  n - 2 , a n d  a t m o d n = 1 , o r  t h e r e i s a n i n t e g e r i , 0  i < s , s u c h t h a t a ^ ( 2 i t ) m o d n = n - 1  E x a m p l e : 1 5 8  B ( 2 8 9 )  2 8 9 - 1 = 2 8 8 = 2 5  9 , s o s = 5 , t = 9  x = 1 5 8 9 m o d 2 8 9 = 1 3 1  1 , s o , c o n d i t i o n 1 d o e s n o t h o l d ; b u t  W e s u c c e s s i v e l y s q u a r e x ( m o d n ) u p t o 4 t i m e s ( s - 1 = 4 ) 1 3 1 2 m o d 2 8 9 = 1 1 0 ; 1 1 0 2 m o d 2 8 9 = 2 5 1 ; 2 5 1 2 m o d 2 8 9 = 2 8 8  S o , 1 5 8  B ( 2 8 9 ) W h i c h i m p l i e s a i s F e r m a t f a l s e w i t n e s s a s w e l l . E x t e n s i o n o f F e r m a t ’ s L i t t l e T h e o r e m  I f n i s p r i m e , t h e n a  B ( n ) f o r a l l 2  a  n - 2 .  I f n > 4 i s a n o d d c o m p o s i t e n u m b e r a n d t h e r e i s s o m e a i n [ 2 , n - 2 ] s a t i s f y i n g a  B ( n ) , a i s c a l l e d a s t r o n g f a l s e w i t n e s s o f p r i m a l i t y f o r n .  G o o d n e w s :  S t r o n g f a l s e w i t n e s s e s a r e m u c h r a r e r t h a n F e r m a t f a l s e w i t n e s s . F o r e x a m p l e , 4 i s N O T s t r o n g f a l s e w i t n e s s f o r 1 5 .  F o r a l l o d d c o m p o s i t e s s m a l l e r t h a n 1 0 0 0 , t h e a v e r a g e p r o b a b i l i t y o f r a n d o m l y s e l e c t i n g a s t r o n g f a l s e w i t n e s s i s l e s s t h a n 1 % , m o r e t h a n 7 2 % o f t h e m d o n o t a d m i t s t r o n g f a l s e w i t n e s s .  A t l e a s t o n e o f 2 , 3 , 5 , 7 o r 6 1 i s N O T a s t r o n g f a l s e w i t n e s s f o r e v e r y o d d c o m p o s i t e i n t e g e r b e t w e e n 5 a n d 1 0 1 3 .  M o s t i m p o r t a n t l y , t h e r e i s a g u a r a n t e e t h a t t h e p r o p o r t i o n o f s t r o n g f a l s e w i t n e s s i s s m a l l f o r e v e r y o d d c o m p o s i t e . I m p r o v e d A l g o r i t h m – M i l l e r - R a b i n B o o l e a n M i l l R a b ( n ) / / o n l y f o r n > 4 i s o d d i n t a ; R a n d o m ( { 2 , … n - 2 } , a ) ; r e t u r n B t e s t ( a , n ) B o o l e a n B t e s t ( a , n ) i n t i , s , t , x ; s = 0 ; t = n - 1 ; w h i l e ( ( t m o d 2 )  1 ) s = s + 1 ; t = t / 2 ; x = e x p o m o d ( a , t , n ) ; i f ( x = = 1 o r x = = n - 1 ) r e t u r n t r u e ; f o r ( i = 1 ; i < s ; i + + ) x = x 2 m o d n ; i f ( x = = n - 1 ) r e t u r n t r u e ; r e t u r n f a l s e ; I t c a n b e p r o v e d t h a t i f n i s c o m p o s i t e , t h e n | B ( n ) |  ( n - 9 ) / 4 , w h i c h m e a n s t h a t M i l l R a b i s ¾ - c o r r e c t M o n t e - C a r l o a l g o r i t h m R e p e a t f o r B e t t e r  T h e a n s w e r “ f a l s e ” i s g u a r a n t e e d t o b e c o r r e c t .  I f n > 4 i s p r i m e , M i l l R a b a l w a y s r e t u r n t h e c o r r e c t a n s w e r , o n t h e o t h e r h a n d , i f n > 4 i s a n o d d c o m p o s i t e , M i l l R a b h a s p r o b a b i l i t y a t m o s t ¼ o f h i t t i n g a s t r o n g f a l s e w i t n e s s a n d e r r o n e o u s l y r e t u r n i n g “ t r u e ” .  S o , t h e f o l l o w i n g a l g o r i t h m i s ( 1 - 4 - k ) - c o r r e c t : B o o l e a n R e p e a t M i l l R a b ( n , k ) / / o n l y f o r n > 4 i s o d d i n t i ; f o r ( i = 1 ; i  k ; i + + ) i f M i l l R a b ( n ) = f a l s e r e t u r n f a l s e ; r e t u r n t r u e ; T h e C o m p l e x i t y  H o w m u c h t i m e d o e s i t t a k e t o d e c i d e o n t h e p r i m a l i t y o f n w i t h a n e r r o r p r o b a b i l i t y b o u n d e d b y  ?  R e p e a t t h e M i l l e r - R a b i n a l g o r i t h m t e s t k t i m e s s u c h t h a t 4 - k   , t h a t i s , 2 2 k  1 /  , s o , k =  0 . 5 l g ( 1 /  )   E a c h c a l l o f M i l l R a b i n v o l v e s o n e m o d u l a r e x p o n e n t i a t i o n , w i t h t a s e x p o n e n t a n d s - 1 m o d u l a r s q u a r i n g , w h i c h i s d o m i n a t e d b y m o d u l a r m u l t i p l i c a t i o n , i n O ( l o g n ) t i m e s , e a c h t a k i n g a t i m e i n O ( l o g 2 n ) , r e s u l t i n g O ( l o g 3 n )  S o , t h e c o m p l e x i t y i s O ( l o g 3 n l g ( 1 /  ) ) .  T h i s i s r e a s o n a b l e i n p r a c t i c e f o r t h o u s a n d - d i g i t n u m b e r s a n d e r r o r p r o b a b i l i t y l e s s t h a n 1 0 - 1 0 0 . P r o b a b i l i t y A l g o r i t h m i n G e n e r a l  M o t i v a t i o n : w r o n g g u e s s v s . h i g h c o s t  C h a r a c t e r i s t i c s : b e h a v e d i f f e r e n t l y o n s a m e i n p u t  U n d e r s t a n d i n g :  W h a t ’ s t h e r e a l m e a n i n g o f t h e s e n t e n c e : “ i t i s a p r i m e w i t h t h e p r o b a b i l i t y o f 9 9 . 9 9 9 9 9 % ” ?  W h a t ’ s t h e m e a n i n g o f t h e s e n t e n c e : “ I b e l i e v e t h a t i t I S a p r i m e . ”","libVersion":"0.2.4","langs":""}