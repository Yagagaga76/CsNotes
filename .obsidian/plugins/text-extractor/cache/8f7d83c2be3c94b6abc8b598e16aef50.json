{"path":"pdf/金融风险管理/10 违约概率的估计.pdf","text":"信用风险的度量和控制 主讲教师：刘烨 南京大学工程管理学院 Financial Risk Management 第3篇 1 信用风险管理的问题界定 • 例：假设投资某企业发行的一年期债券，面值为F，违约概率为p， 预计期末以概率1-p回收F，概率p回收F*R ，其中R为违约回收率。 信用损失的分布是什么？预期信用损失，未预期信用损失分别为多 少？资本金应为多少？ 2 信用风险管理的问题界定 • 例：假设投资某企业发行的一年期债券，面值为F，违约概率为p， 预计期末以概率1-p回收F，概率p回收F*R ，其中R为违约回收率。 信用损失的分布是什么？预期信用损失，未预期信用损失分别为多 少？资本金应为多少？ • 信用损失L： • 信用损失是债务人违约引起的； • 与市场风险损益不同，后者是市场变量（如利率）变动引起 3 (1 ), L= 0, 1 FR p p ⋅−  − 信用风险管理的问题界定 • 例：假设投资企业发行的一年期债券，面值为F，违约概率为p，预 计期末以概率1-p回收F，概率p回收F*R ，其中R为违约回收率。信 用损失的分布是什么？预期信用损失，未预期信用损失分别为多少 ？资本金应为多少？ • 信用损失L： • 预期损失（Expected Loss）：EL=E(L)=p*F*(1-R) • 未预期损失（Unexpected Loss）：UL=WCL-EL • WCL（Worst Case Loss） 4 (1 ), L= 0, 1 FR p p ⋅−  − 概 率 损失 预期损失 未预期损失 ** % 置信 数学期望 信用风险管理的问题界定 • 例：假设投资企业发行的一年期债券，面值为F，违约概率为p，预 计期末以概率1-p回收F，概率p回收F*R ，其中R为违约回收率。信 用损失的分布是什么？预期信用损失，未预期信用损失分别为多少 ？资本金应为多少？ • 信用损失L： • 预期损失（Expected Loss）：EL=E(L)=p*F*(1-R) • 未预期损失（Unexpected Loss）：UL=WCL-EL • 资本金=未预期损失 5 (1 ), L= 0, 1 FR p p ⋅−  − 概 率 损失 预期损失 未预期损失 ** % 置信 数学期望 信用损失度量：基本参数 • 违约概率 (PD，Probability of Default) ：指交易对手在给定时 期内违约的可能性。 • 巴塞尔委员会建议使用以下违约参考定义：下列事件中只要有一个 事件在某个特定的债务人身上发生，就可以认定为违约: • 已经判明债务人不准备全部履行其偿债义务（本金、利息或手续费）。 • 与债务人的任何义务有关的信用损失，比如债务注销、提取了特定准 备金、债务重组，包括本金、利息和手续费的减免或延期支付。 • 债务人未能履行某些信用义务，逾期超过90天。 • 债务人已经申请破产或向债权人申请保护。 6 信用损失度量：基本参数 • 信用风险暴露（EAD，Exposure at Default）：可能发生违约风险的资金头寸。 • 违约回收率（RR，Recovery Rate）：债券刚违约时其市场价值与债券面值的比率。 • 违约损失率（LGD，Loss Given Default） = 1-违约回收率 • 违约损失率与违约概率正相关，违约回收率和违约概率负相关。 7 表： 1982-2010年美国企业债券和银行贷款的回收率 分类 平均回收率（%） 分类 平均回收率（%） 一级资产抵押贷款 65.8 优先无担保债券 36.7 二级资产抵押贷款 29.1 优先次级债券 30.7 高级无抵押贷款 47.8 次级债券 31.3 优先有担保债券 50.8 更次级债券 24.7 资料来源：穆迪 预期的损失 IFRS9 IAS39 已发生的损失 违约概率 PD 违约损失率 LGD 风险敞口 EAD 当前损失/组合计提 交易对手 已经 违约的概率 历史经验 经验判断 可能损失多少 当前资负表 当前的 风险资产的额度 交易对手 未来可能 违约的概率 未来损失/单笔测算 根据推算 可能损失多少 历史经验+未来环境 未来的 风险资产的额度 当前敞口+未来发展 违约概率和损失率 估计的现实重要性 预期损失的估计：IFRS9与旧会计准则的区别 预期损失vs未预期 损失 差异点 Basel模型 IFRS9预期信用损失模型 违约概率和违约损失率的 统计方法 一般使用贯穿周期法或混合时点法计算历史数据均值， 并考虑经济衰退期调整 使用时点法，并考虑宏观经济参数进行调 整 数据观察期 违约概率模型的数据观察周期不少于5年，非个贷和个贷 违约损失率模型的数据观察周期分别不少于7年、5年 无要求 违约概率和违约损失率的 下限和调整 违约概率和违约损失率有下限设定，并进行经济衰退期 调整 无要求 违约概率的对应期间 未来12个月 未来12个月或存续期 违约概率的对象 借款人的违约概率 金融工具层面的违约风险变化 预期损失 IFRS9与巴塞尔协议 巴塞尔 NOW T-2 T T+2 T+4 T=lifetimeT-1 T+1 T+3 T+5 …… 第3篇 目录 第10章 违约概率的估计 第11章 违约回收率和风险暴露的估计 第12章 信用风险价值CVaR 10 信用风险：估计违约概率 主讲教师：刘烨 南京大学工程管理学院 Financial Risk Management 第10章 11 目录 1. 历史违约概率 2. 用信用溢差来估计违约概率：根据债券收益率溢差 3. 用信用溢差来估计违约概率：根据CDS溢差 4. 用股价来估计违约概率 5. 究竟用哪一种估计方法 12 1. 历史违约概率 • 如何用历史数据来估计债券 i 的违约概率？ • 最简单的方法： • 收集同类债券（如信用等级相同、期限相同）的历史违约信息， • 统计违约的样本数N1、未违约的样本数N2， • 历史违约概率=N1/(N1+N2) • 以此为债券 i 违约概率的估计 13 1. 历史违约概率 • 外部评级机构提供的历史违约概率，以穆迪为例： 14 表：1970-2010年平均累积违约概率（%） 期限（年） 1 2 3 4 5 7 10 15 20 Aaa级 0.000 0.013 0.013 0.037 0.104 0.244 0.494 0.918 1.090 Aa级 0.021 0.059 0.103 0.184 0.273 0.443 0.619 1.260 2.596 A级 0.055 0.177 0.362 0.549 0.756 1.239 2.136 3.657 6.019 Baa级 0.181 0.510 0.933 1.427 1.953 3.031 4.904 8.845 12.411 Ba级 1.157 3.191 5.596 8.146 10.453 14.440 20.101 29.702 36.867 B级 4.465 10.432 16.344 21.510 26.173 34.721 44.573 56.345 62.693 Caa-C级 18.163 30.204 39.709 47.317 53.768 61.181 72.384 76.162 78.993 资料来源：穆迪 1. 历史违约概率 • 外部评级机构提供的历史违约概率，以穆迪为例： 15 表：1970-2010年平均累积违约概率（%） 期限（年） 1 2 3 4 5 7 10 15 20 Aaa级 0.000 0.013 0.013 0.037 0.104 0.244 0.494 0.918 1.090 Aa级 0.021 0.059 0.103 0.184 0.273 0.443 0.619 1.260 2.596 A级 0.055 0.177 0.362 0.549 0.756 1.239 2.136 3.657 6.019 Baa级 0.181 0.510 0.933 1.427 1.953 3.031 4.904 8.845 12.411 Ba级 1.157 3.191 5.596 8.146 10.453 14.440 20.101 29.702 36.867 B级 4.465 10.432 16.344 21.510 26.173 34.721 44.573 56.345 62.693 Caa-C级 18.163 30.204 39.709 47.317 53.768 61.181 72.384 76.162 78.993 资料来源：穆迪 穆迪的级别排序为Aaa，Aa，A，Baa， Ba，B和Caa。 相对应地，在标普和惠誉的评级体系中， AAA是最佳评级，其次是AA，A，BBB， BB，B和CCC。 高于BBB或Baa的债券被称为投资级别债券。 1. 历史违约概率 • 外部评级机构提供的历史违约概率，以穆迪为例： 16 表：1970-2010年平均累积违约概率 期限（年） 1 2 3 4 5 7 10 15 20 Aaa级 0.000 0.013 0.013 0.037 0.104 0.244 0.494 0.918 1.090 Aa级 0.021 0.059 0.103 0.184 0.273 0.443 0.619 1.260 2.596 A级 0.055 0.177 0.362 0.549 0.756 1.239 2.136 3.657 6.019 Baa级 0.181 0.510 0.933 1.427 1.953 3.031 4.904 8.845 12.411 Ba级 1.157 3.191 5.596 8.146 10.453 14.440 20.101 29.702 36.867 B级 4.465 10.432 16.344 21.510 26.173 34.721 44.573 56.345 62.693 Caa-C级 18.163 30.204 39.709 47.317 53.768 61.181 72.384 76.162 78.993 资料来源：穆迪 以表中第6行为例： Baa级表示债券的信用等级 Baa级在第1年违约的概率：0.181% Baa级在前2年内的累积违约概率：0.510% 1. 历史违约概率 • 外部评级机构提供的历史违约概率，以穆迪为例： 17 表：1970-2010年平均累积违约概率 期限（年） 1 2 3 4 5 7 10 15 20 Aaa级 0.000 0.013 0.013 0.037 0.104 0.244 0.494 0.918 1.090 Aa级 0.021 0.059 0.103 0.184 0.273 0.443 0.619 1.260 2.596 A级 0.055 0.177 0.362 0.549 0.756 1.239 2.136 3.657 6.019 Baa级 0.181 0.510 0.933 1.427 1.953 3.031 4.904 8.845 12.411 Ba级 1.157 3.191 5.596 8.146 10.453 14.440 20.101 29.702 36.867 B级 4.465 10.432 16.344 21.510 26.173 34.721 44.573 56.345 62.693 Caa-C级 18.163 30.204 39.709 47.317 53.768 61.181 72.384 76.162 78.993 资料来源：穆迪 Baa级在第1年违约的概率：0.181% Baa级在前2年内的累积违约概率：0.510% Baa级在第1年未违约且在第2年违约的概率（即第2年的边 际违约概率）：0.510%-0.181% 1. 历史违约概率 • 外部评级机构提供的历史违约概率，以穆迪为例： 18 表：1970-2010年平均累积违约概率 期限（年） 1 2 3 4 5 7 10 15 20 Aaa级 0.000 0.013 0.013 0.037 0.104 0.244 0.494 0.918 1.090 Aa级 0.021 0.059 0.103 0.184 0.273 0.443 0.619 1.260 2.596 A级 0.055 0.177 0.362 0.549 0.756 1.239 2.136 3.657 6.019 Baa级 0.181 0.510 0.933 1.427 1.953 3.031 4.904 8.845 12.411 Ba级 1.157 3.191 5.596 8.146 10.453 14.440 20.101 29.702 36.867 B级 4.465 10.432 16.344 21.510 26.173 34.721 44.573 56.345 62.693 Caa-C级 18.163 30.204 39.709 47.317 53.768 61.181 72.384 76.162 78.993 资料来源：穆迪 Baa级在第1年违约的概率：0.181% Baa级在前2年内的累积违约概率：0.510% Baa级在第1年未违约且在第2年违约的概率（即第2年的边 际违约概率）：0.510%-0.181% 违约 不违约 违约过程 1. 历史违约概率 • 外部评级机构提供的历史违约概率，以穆迪为例： 19 表：1970-2010年平均累积违约率 期限（年） 1 2 3 4 5 7 10 15 20 Aaa级 0.000 0.013 0.013 0.037 0.104 0.244 0.494 0.918 1.090 Aa级 0.021 0.059 0.103 0.184 0.273 0.443 0.619 1.260 2.596 A级 0.055 0.177 0.362 0.549 0.756 1.239 2.136 3.657 6.019 Baa级 0.181 0.510 0.933 1.427 1.953 3.031 4.904 8.845 12.411 Ba级 1.157 3.191 5.596 8.146 10.453 14.440 20.101 29.702 36.867 B级 4.465 10.432 16.344 21.510 26.173 34.721 44.573 56.345 62.693 Caa-C级 18.163 30.204 39.709 47.317 53.768 61.181 72.384 76.162 78.993 资料来源：穆迪 根据条件概率公式 Baa级债券第1年未违约的条件下，第2年违约 的概率 称条件违约概率conditional probability，又 称向前违约概率forward probability （Contigent to the survival rate）。 (2 | 1 ) (1 2 ) = () 0.51-0.181 = 1-0.181 P P P 第 年 违 约 第 年 未 违 约 第 年 未 违 约 且 在 第 年 违 约 第 1年 未 违 约 () ( | )= () P BA PB A PA 1. 历史违约概率 • 外部评级机构提供的历史违约概率，以穆迪为例： 20 表：1970-2010年平均累积违约率 期限（年） 1 2 3 4 5 7 10 15 20 Aaa级 0.000 0.013 0.013 0.037 0.104 0.244 0.494 0.918 1.090 Aa级 0.021 0.059 0.103 0.184 0.273 0.443 0.619 1.260 2.596 A级 0.055 0.177 0.362 0.549 0.756 1.239 2.136 3.657 6.019 Baa级 0.181 0.510 0.933 1.427 1.953 3.031 4.904 8.845 12.411 Ba级 1.157 3.191 5.596 8.146 10.453 14.440 20.101 29.702 36.867 B级 4.465 10.432 16.344 21.510 26.173 34.721 44.573 56.345 62.693 Caa-C级 18.163 30.204 39.709 47.317 53.768 61.181 72.384 76.162 78.993 资料来源：穆迪 思考： d1 1-d1 d2 1-d2 d3 1-d3 违约 不违约 违约过程 1. 历史违约概率 • 外部评级机构提供的历史违约概率，以穆迪为例： 21 表：1970-2010年平均累积违约率 期限（年） 1 2 3 4 5 7 10 15 20 Aaa级 0.000 0.013 0.013 0.037 0.104 0.244 0.494 0.918 1.090 Aa级 0.021 0.059 0.103 0.184 0.273 0.443 0.619 1.260 2.596 A级 0.055 0.177 0.362 0.549 0.756 1.239 2.136 3.657 6.019 Baa级 0.181 0.510 0.933 1.427 1.953 3.031 4.904 8.845 12.411 Ba级 1.157 3.191 5.596 8.146 10.453 14.440 20.101 29.702 36.867 B级 4.465 10.432 16.344 21.510 26.173 34.721 44.573 56.345 62.693 Caa-C级 18.163 30.204 39.709 47.317 53.768 61.181 72.384 76.162 78.993 资料来源：穆迪 di：Baa级债券至第 i 年初未违约的条件下，第 i 年违约的概率 si：Baa级债券至第 i 年末生存的概率=(1-d1)(1- d2）…（1-di） d1 1-d1 d2 1-d2 d3 1-d3 违约 不违约 违约过程 1. 历史违约概率 • 外部评级机构提供的历史违约概率，以穆迪为例： 22 表：1970-2010年平均累积违约率 期限（年） 1 2 3 4 5 7 10 15 20 Aaa级 0.000 0.013 0.013 0.037 0.104 0.244 0.494 0.918 1.090 Aa级 0.021 0.059 0.103 0.184 0.273 0.443 0.619 1.260 2.596 A级 0.055 0.177 0.362 0.549 0.756 1.239 2.136 3.657 6.019 Baa级 0.181 0.510 0.933 1.427 1.953 3.031 4.904 8.845 12.411 Ba级 1.157 3.191 5.596 8.146 10.453 14.440 20.101 29.702 36.867 B级 4.465 10.432 16.344 21.510 26.173 34.721 44.573 56.345 62.693 Caa-C级 18.163 30.204 39.709 47.317 53.768 61.181 72.384 76.162 78.993 资料来源：穆迪 争议： Topic 1. 外部信用评级的可信性 Topic 2. 信用评级行业的市场结构（Case：大公国际） 1. 历史违约概率 • FRM习题：一家中型对冲基金的风险分析师正在评估交易头寸的信用风险： • 该基金专门投资公司债，一项新交易是价值100亿日元的b级长期债券； • 分析师估计，b级债券在第1年的条件违约概率为7.7%；第2年7.1%；第3年是 6.6%；第4年是6.1%。 • 该债券前3年存活且第4年违约的概率是多少？ 【解析】 • “第2年条件违约概率为7.1%“：在第1年活下来的条件下，第2年违约的概 率为 7.1%。 • 前3年存活且第4年违约的概率： 23 1. 历史违约概率 • FRM习题：一家中型对冲基金的风险分析师正在评估交易头寸的信用风险： • 该基金专门投资公司债，一项新交易是价值100亿日元的b级长期债券； • 分析师估计，b级债券在第1年的条件违约概率为7.7%；第2年7.1%；第3年是 6.6%；第4年是6.1%。 • 该债券前3年存活且第4年违约的概率是多少？ 【解析】 • “第2年条件违约概率为7.1%“：在第1年活下来的条件下，第2年违约的概 率为 7.1%。 • 前3年存活且第4年违约的概率： 24 1. 历史违约概率——传统估计方法 • Altman’s Z得分模型，用于评估企业破产或者违约概率。首次将数理 统计方法引入该领域。 • Altman’s Z得分模型：基于财务指标的违约概率估计方法  X1=流动资金/总资产  X2=留存收益/总资产  X3=息税前利润/总资产  X4=股票市值/负债账面总额  X5=销售收入/总资产 Z=1.2X1+1.4X2+3.3X3+0.6X4+0.99X5  如果Z大于3，公司违约的可能性不大；Z介于2.7-3之间，信用处于戒备状态；在 1.8-2.7之间，公司有一定的违约可能；小于1.8，违约的可能性很大 1. 历史违约概率——传统估计方法 • Altman’s Z得分模型：基于财务指标的违约概率估计方法  X1=流动资金/总资产  X2=留存收益/总资产  X3=息税前利润/总资产  X4=股票市值/负债账面总额  X5=销售收入/总资产 Z=1.2X1+1.4X2+3.3X3+0.6X4+0.99X5  如果Z大于3，公司违约的可能性不大；Z介于2.7-3之间，信用处于戒备状 态；在1.8-2.7之间，公司有一定的违约可能；小于1.8，违约的可能性很大 系数如何得来？指标如 何选取？适用于中国吗 ？ 1. 历史违约概率——传统估计方法 Altman’s Z得分模型：基于财务指标的违约概率估计方法 Z值评分模型的基本步骤： (1) 选取一组财务比率指标； (2) 收集样本，分为正常还本付息和坏账案例； (3) 建立线性判别函数，确定每个指标的影响权重，即得一个Z值评分模型； (4) 分析得到一个违约或破产临界值及一个Z值区域； (5) 计算贷款人的Z值，对其进行判断、评估。 27 1. 历史违约概率——传统估计方法 28 • 难点：单个金融机构可获得的样本数据非常少。 1. 历史违约概率——传统估计方法 29 • 难点：单个金融机构可获得的样本数据非常少。 巴塞尔资本协议II中的内部评级法允 许银行采用自己的内部评级模型。 建立内部评级模型的关键：估计借款 企业的违约概率。 前沿：基于大数据的小微企业和个人违约率预测 30 目录 1. 历史违约概率 2. 用信用溢差来估计违约概率：根据债券收益率溢差 3. 用信用溢差来估计违约概率：根据CDS溢差 4. 用股价来估计违约概率 5. 究竟用哪一种估计方法 31 市场上的价格信息为估计债务违约率提 供了及时信息。 2. 用信用溢差来估计违约概率 ——根据债券收益率溢差 • 信用溢差（Credit Spread）：债券投资人因承担信用风险而索取的高 于无风险利率的回报。 • 债券信用溢差≈债券收益率-无风险利率 32 2. 用信用溢差来估计违约概率 ——根据债券收益率溢差 • 信用溢差（Credit Spread）：债券投资人因承担信用风险而索取的高于无风险利 率的回报。 • 债券信用溢差≈债券收益率-无风险利率 • 一年期情形：一年期债券，面值$1，投资者愿意出的价格为P，到期收 益率为YTM，无风险利率为Rf，违约回收率为RR。求违约概率PD？ 33 2. 用信用溢差来估计违约概率 ——根据债券收益率溢差 • 信用溢差（Credit Spread）：债券投资人因承担信用风险而索取的高于无风险利 率的回报。 • 债券信用溢差≈债券收益率-无风险利率 • 一年期情形：一年期债券，面值$1，投资者愿意出的价格为P，到期收 益率为YTM，无风险利率为Rf，违约回收率为RR。求违约概率PD？ 34 2. 用信用溢差来估计违约概率 ——根据债券收益率溢差 • 信用溢差（Credit Spread）：债券投资人因承担信用风险而索取的高于无风险利 率的回报。 • 债券信用溢差≈债券收益率-无风险利率 • 一年期情形：一年期债券，面值$1，投资者愿意出的价格为P，到期收 益率为YTM，无风险利率为Rf，违约回收率为RR。求违约概率PD？ 35 2. 用信用溢差来估计违约概率 ——根据债券收益率溢差 • 信用溢差（Credit Spread）：债券投资人因承担信用风险而每年索取的高于无风 险利率的回报。 • 债券信用溢差≈债券收益率-无风险利率 • 一年期情形：一年期债券，价格为P，到期收益率为YTM，无风险利率为Rf，违约 回收率为RR。求违约概率PD？ 36 注意，由此得到的是风险中性测度下的违约概率。 FRM习题中使用的就是风险中性违约概率。 2. 用信用溢差来估计违约概率 ——根据债券收益率溢差 • FRM习题：A公司发行面值为100万美元、违约回收率为0%的1年 期零息债券，该债券目前的交易价格为面值的80%。假设无风险利 率为每年5%，那么该债券1年末的违约概率最接近下列哪个？ 【解析】 • P=100 × 80%=80万美元 • P=[（1-PD）×100+ PD ×100 × 0%]/（1+5%） • 解得：PD=16%。 37 • 多年期情形（FRM习题）： • 假设企业5年期债券，面值100美元，息票率为每年6%（半年付息一次）； • 收益率为每年7%（连续复利），无风险利率为每年5%（连续复利）； • 假设债券每年的违约概率为Q，并且违约只发生在0.5年、1.5年、2.5年、 3.5年及4.5年； • 债券预期回收率为40%（以面值计算，即回收100*40%=40美元）； • 根据以上信息估计违约概率Q。 2. 用信用溢差来估计违约概率 ——根据债券收益率溢差（续） • 多年期情形（FRM习题）： • 假设企业5年期债券，面值100美元，息票率为每年6%（半年付息一次）； • 收益率为每年7%（连续复利），无风险利率为每年5%（连续复利）； • 假设债券每年的违约概率为Q，并且违约只发生在0.5年、1.5年、2.5年、 3.5年及4.5年； • 债券预期回收率为40% （以面值计算，即回收100*40%=40美元） ； • 根据以上信息估计违约概率Q。 • Step1：收益率隐含的债券价值为95.34美元， • 无风险债券价格为104.09美元， • 故由债券引发的预期损失为104.09-95.34=8.738美元。 2. 用信用溢差来估计违约概率 ——根据债券收益率溢差（续） 5 0.07 0.07 5 1/ 2 (3 )+100 95.34 t t ee − ⋅ − ⋅ = ⋅ ⋅=∑ • 多年期情形（FRM习题）： • 假设企业5年期债券，面值100美元，息票率为每年6%（半年付息一次）； • 收益率为每年7%（连续复利），无风险利率为每年5%（连续复利）； • 假设债券每年的违约概率为Q，并且违约只发生在0.5年、1.5年、2.5年、 3.5年及4.5年； • 债券预期回收率为40% （以面值计算，即回收100*40%=40美元） ； • 根据以上信息估计违约概率Q。 • Step1：收益率隐含的债券价值为95.34美元， • 无风险债券价格为104.09美元， • 故由债券引发的预期损失为：104.09-95.34=8.738美元。 2. 用信用溢差来估计违约概率 ——根据债券收益率溢差（续） 5 0.07 0.07 5 1/ 2 (3 )+100 95.34 t t ee − ⋅ − ⋅ = ⋅ ⋅=∑ 5 0.05 0.05 5 1/2(3 )+100 104.09 t t ee −⋅ −⋅ = ⋅ ⋅ =∑ Step2：预期损失也是Q的函数： Time (yrs) Def Prob Risk-free Value Recovery Amount Loss Discount Factor PV of Exp Loss 0.5 Q 106.73 40 66.73 0.9753 65.08Q 1.5 Q 105.97 40 65.97 0.9277 61.20Q 2.5 Q 105.17 40 65.17 0.8825 57.52Q 3.5 Q 104.34 40 64.34 0.8395 54.01Q 4.5 Q 103.46 40 63.46 0.7985 50.67Q Total 288.48Q 2. 用信用溢差来估计违约概率 ——根据债券收益率溢差（续） 不考虑违约时，第3.5、4、4.5、5年现金流在 第3.5年的贴现： 即在3.5年时不考虑违约的债券价格的期望值。 0.05 0.5 0.051 0.051.53+3 +3 +103 104.34ee e − ⋅ − ⋅ − ⋅⋅ ⋅ ⋅= Step2：预期损失也是Q的函数： Time (yrs) Def Prob Risk-free Value Recovery Amount Loss Discount Factor PV of Exp Loss 0.5 Q 106.73 40 66.73 0.9753 65.08Q 1.5 Q 105.97 40 65.97 0.9277 61.20Q 2.5 Q 105.17 40 65.17 0.8825 57.52Q 3.5 Q 104.34 40 64.34 0.8395 54.01Q 4.5 Q 103.46 40 63.46 0.7985 50.67Q Total 288.48Q 2. 用信用溢差来估计违约概率 ——根据债券收益率溢差（续） 如何计算？ 不考虑违约时，第3.5、4、4.5、5年现金流在第 3.5年的贴现： 0.05 0.5 0.051 0.051.53+3 +3 +103 104.34ee e − ⋅ − ⋅ − ⋅⋅ ⋅ ⋅= Step2：预期损失也是Q的函数： Time (yrs) Def Prob Risk-free Value Recovery Amount Loss Discount Factor PV of Exp Loss 0.5 Q 106.73 40 66.73 0.9753 65.08Q 1.5 Q 105.97 40 65.97 0.9277 61.20Q 2.5 Q 105.17 40 65.17 0.8825 57.52Q 3.5 Q 104.34 40 64.34 0.8395 54.01Q 4.5 Q 103.46 40 63.46 0.7985 50.67Q Total 288.48Q 2. 用信用溢差来估计违约概率 ——根据债券收益率溢差（续） 第t年违约时Loss在今天（t=0）的现值 Step2：预期损失也是Q的函数： 288.48Q=8.738，得出Q=3.03% Time (yrs) Def Prob Recovery Amount Risk-free Value Loss Discount Factor PV of Exp Loss 0.5 Q 40 106.73 66.73 0.9753 65.08Q 1.5 Q 40 105.97 65.97 0.9277 61.20Q 2.5 Q 40 105.17 65.17 0.8825 57.52Q 3.5 Q 40 104.34 64.34 0.8395 54.01Q 4.5 Q 40 103.46 63.46 0.7985 50.67Q Total 288.48Q 2. 用信用溢差来估计违约概率 ——根据债券收益率溢差（续） 目录 1. 历史违约概率 2. 用信用溢差来估计违约概率：根据债券收益率溢差 3. 用信用溢差来估计违约概率：根据CDS溢差 • CDS（信用违约互换）：用来估计（债券）违约概率的产品 • CDS溢差和（债券）信用溢差的关系 • 估计（债券）违约概率 4. 用股价来估计违约概率 5. 究竟用哪一种估计方法 45 3. 用信用溢差来估计违约概率——CDS介绍 • 在2007年美国次贷危机中一举成名的信用违约互换（CDS）： • 在次贷危机爆发前，大量投资者持有住房抵押贷款及其衍生品（CDO）； • 美国最大的保险公司美国国际集团AIG卖出了大量针对上述住房抵押贷款（ 或其衍生品）的信用保险（一种CDS）； • 当住房抵押贷款及其衍生品违约时，购买了CDS的投资者将获得赔偿； • 后来房价下跌，AIG因卖出信用保险付出了巨大代价； • 美国政府不得不在2008年9月对AIG实施救援。 3. 用信用溢差来估计违约概率——CDS介绍 • 在次贷危机中一举成名的信用违约互换（CDS）： • 在2007年开始的信用危机爆发前，美国最大的保险公司美国国际集团AIG卖出了 大量由按揭产生的AAA级份额的信用保护（CDS的一种）。后来房价下跌，AIG 因卖出信用保护付出了巨大代价。美国政府不得不在2008年9月对AIG实施救援。 • 谁赚了钱？ • 电影《大空头》描述了华尔街投资家们如何在次贷危机前夕，通过购买CDS获得巨大收益。 • 以“华尔街空神”John Paulson的基金为例，10亿美金的本金，购买120亿美元针对BBB级的 CDS产品。但并不是付出120亿美元，而是每年交1%的保费，1.2亿美元，而且这新基金可以 在缴纳之前存在银行获取5%的利息，即5000万美金利息，这样第一年只要支出7000万美元， 加上每年1000万美金的佣金，10亿美金的产品一年最多损失8%（8000万美金），但理论上 可以赚1200%（BBB级债券全部违约，CDS全部赔付，当然实际中能要回多少就是多少）。 3. 用信用溢差来估计违约概率——CDS介绍 • 什么是CDS？ 信用违约互换（CDS）的买入方获得对某家 公司的信用保险： 这里所涉及的某家公司被称为参考实体（ reference entity），这家公司的违约事件 被定义为信用事件（credit event）； CDS买入方在信用事件发生时有权力将违约 公司的债券以债券面值的价格卖给信用违约 互换的卖出方； 这一债券的面值也被称为CDS的面值。 3. 用信用溢差来估计违约概率——CDS介绍 • 2016.9.23，中国银行间市场交易商协 议发布《银行间市场信用风险缓释工具 试点业务规则》、《信用违约互换业务 指引》，中国版CDS新时代来临。 • 2016.8.24 已有一单试水。银行间市场 交易商协会公告称，决定接受中信建投 证券2016年第一期信用风险缓释凭证 (CRMW)创设登记。标的债务是由中国 农业银行发起的不良贷款证券化产品。 • 首批CRMW于2010 年11 月24 日开始 在全国银行间债券市场交易流通，右边 是兴业证券创设的CRMW要素。 3. 用信用溢差来估计违约概率——CDS介绍 • 2016.9.23，中国银行间市场交易商协 议发布《银行间市场信用风险缓释工具 试点业务规则》、《信用违约互换业务 指引》，中国版CDS新时代来临。 • 2016.8.24 已有一单试水。银行间市场 交易商协会公告称，决定接受中信建投 证券2016年第一期信用风险缓释凭证 (CRMW)创设登记。标的债务是由中国 农业银行发起的不良贷款证券化产品。 • 首批CRMW于2010 年11 月24 日开始 在全国银行间债券市场交易流通，右边 是兴业证券创设的CRMW要素。 3. 用信用溢差来估计违约概率——CDS介绍 • 例子：某公司（A）进入了一个5年期的信用违约互换，其面值为1亿美元， • 买入方（A）付费为每年90个基点（该以本金百分比为计的数量被称为信用违 约互换溢差（CDS spread），每季度结束支付，每次225000美元=1亿 *0.009/4）， • 该付款的期限为信用违约互换的到期日或信用事件发生的日期， • 如果违约发生，如果为实物交割，则买入方可要求卖出方（B）以1亿的价格买 入面值为1亿美元的由参考实体（C）所发行的债券（债券需为可交割债券）； CDS买入方 A CDS卖出方 B 每年90个基点 参考实体C违约时的付款 3. 用信用溢差来估计违约概率——CDS介绍 • 例子：某公司（A）进入了一个5年期的信用违约互换，其面值为1亿美元， • 买入方（A）付费为每年90个基点（该以本金百分比为计的数量被称为信用违 约互换溢差（CDS spread），每季度结束支付，每次225000美元=1亿 *0.009/4）， • 该付款的期限为信用违约互换的到期日或信用事件发生的日期， • 如果违约发生，如果为实物交割，则买入方可要求卖出方（B）以1亿的价格买 入面值为1亿美元的由参考实体（C）所发行的债券（债券需为可交割债券）； CDS买入方 A CDS卖出方 B 每年90个基点 参考实体C违约时的付款 3. 用信用溢差来估计违约概率——CDS介绍 • 例子：某公司（A）进入了一个5年期的信用违约互换，其面值为1亿美元， • 买入方（A）付费为每年90个基点（该以本金百分比为计的数量被称为信用违 约互换溢差（CDS spread））， • 该付款的期限为信用违约互换的到期日或信用事件发生的日期， • 如果违约发生，如果为现金交割，则在违约后几天内，确定最便宜的交割债券 的市场中间价，比如假设每100美元面值合35美元（回收率R=0.35），则卖 出方必须向买入方支付6500万美元（=1亿*（1-R））。 CDS买入方 A CDS卖出方 B 每年90个基点 参考实体C违约时的付款 3. 用信用溢差来估计违约概率——CDS信用指数 • CDS信用指数用于跟踪CDS溢差，两个重要的信用指数： • CDX NAIG指数：北美125家投资级公司CDS溢差的等权重组合 • iTraxx欧洲指数：欧洲125家投资级公司CDS溢差的等权重组合 • 如果某做市商对5年期CDX NAIG指数的卖出价为166个基点。 • 这意味着一个投资人可以买入关于指数中125个公司的信用保护，每年付费 166个基点，假定投资人对每个公司寻求保护的单个面值为800,000美元， 投资人的费用为每年0.0166*800000*125=1,660,000美元。 • 若一家公司违约，信用保护的付款费用减少1/125。 3. 用信用溢差来估计违约概率 ——CDS溢差和债券收益率溢差的关系 • 可证明，对于平价债券，CDS溢差≈债券收益率溢差 55 CDS溢差 债券收益率溢 差 3. 用信用溢差来估计违约概率 ——CDS溢差和债券收益率溢差的关系 • CDS溢差≈债券收益率溢差（=债券收益率-无风险利率） • 投资人买入一个5年期企业债券，平价债券，面值为F，其息票率为 r 每年7% ，同时进入一个5年期CDS，CDS溢差 s 为200个基点（即2%）； • 如果债券发行人不违约，投资人的收益率为 r-s=7%-2%=5%； • 如果债券发行人违约，违约后投资人可以用债券从CDS卖方换回本金（F）， 然后再投资于无风险资产； • 无风险利率为多少？ 3. 用信用溢差来估计违约概率 ——CDS溢差和债券收益率溢差的关系 • CDS溢差≈债券收益率溢差（=债券收益率-无风险利率） • 投资人买入一个5年期企业债券，平价债券，面值为F，其息票率为 r 每年7% ，同时进入一个5年期CDS，CDS溢差 s 为200个基点（即2%）； • 如果债券发行人不违约，投资人的收益率为 r-s=7%-2%=5%； • 如果债券发行人违约，违约后投资人可以用债券从CDS卖方换回本金（F）， 然后再投资于无风险资产； • 无风险利率为多少？ 3. 用信用溢差来估计违约概率 ——CDS溢差和债券收益率溢差的关系 • CDS溢差≈债券收益率溢差（=债券收益率-无风险利率） • 投资人买入一个5年期企业债券，平价债券，面值为F，其息票率为 r 每年7% ，同时进入一个5年期CDS，CDS溢差 s 为200个基点（即2%）； • 如果债券发行人不违约，投资人的收益率为 r-s=7%-2%=5%； • 如果债券发行人违约，违约后投资人可以用债券从CDS卖方换回本金（F）， 然后再投资于无风险资产； • 无风险利率为多少？等于5% • 如果是平价债券，CDS溢差≈债券收益率-无风险利率 3. 用信用溢差来估计违约概率 ——CDS溢差和债券收益率溢差的关系 • CDS溢差≈债券收益率溢差（=债券收益率-无风险利率） • 当债券交易员对债券收益率溢差报价时，一般用类似期限的国债收益率代 替无风险利率；在衍生产品定价时，交易员往往将LIBOR/互换利率作为无 风险利率的近似 • 隐含无风险利率=债券收益率-同期限CDS溢差 • 隐含无风险利率与LIBOR/互换利率的差别小于与国债收益率的差别 3. 用信用溢差来估计违约概率 ——用CDS溢差近似估计违约概率 • 投资者进入一个T年期的CDS，债券回收率为R，CDS溢差为s，在 没有前期违约的条件下，债券在t时刻的条件违约概率满足： s为期限为T的CDS溢差，R为回收率。（PD是年度平均条件违约概 率） • 证明：信用溢差大致相当于平均损失率 1 s PD R ≈ − (1 )=s PD R PD LGD≈ ⋅− ⋅ 3. 用信用溢差来估计违约概率 ——用CDS溢差近似估计违约概率 • FRM习题：在5年以内所有年份中，某信用违约互换（CDS）每年 的溢差s均为325个基点。该CDS的参考实体的违约损失率LGD为 40%，计算参考实体在未来两年内某个时候违约的概率（累积违约 概率）。 【解析】 • 直接用公式：s=PD×LGD • 已知 s=3.25%， LGD=40%，可得一年的 PD 约等于 8.125% • 根据CDS估计出来的是“至前一年未违约的条件下，今年违约的概率”， 是年度平均条件违约概率 • 两年的累积违约概率为： 0.08125+（1-0.08125）*0.08125 61 目录 1. 历史违约概率 2. 用信用溢差来估计违约概率：根据债券收益率溢差 3. 用信用溢差来估计违约概率：根据CDS溢差 4. 用股价来估计违约概率：Merton模型和KMV模型 5. 究竟用哪一种估计方法 62 3和4适用于交易性信用资产； 5则对非交易性信用资产（贷款，未在二级市场流通 的债券等）也适用； 且5已被推广到非上市公司。 4. 用股价来估计违约概率——Merton模型 1. 假设  企业只通过权益 St 和一种零息债券 Bt 进行融资；  债券现值为Bt ，T 时到期，到期时本息合计为D；  公司的资产价值 服从几何布朗运动。 63 t ttV SB= + 4. 用股价来估计违约概率——Merton模型 1. 假设  企业只通过权益 St 和一种零息债券 Bt进行融资；  债券现值为Bt ，T 时到期，到期时本息合计为D；  公司的资产价值 服从几何布朗运动。 2. 违约率计算思想： (1) 若 T 时刻公司的资产价值 Vt 小于负债D，就会存在违约的可能性； (2) 此时公司的违约概率为： ； (3) 将公司的资产价值 Vt 所服从的分布代入上述公式进行计算。 64 t ttV SB= + ()TPV D≤ 4. 用股价来估计违约概率——Merton模型 其中： d称为违约距离（DD，Distance of Default)。如何估计 和 ？ 65 d dd t Vt t V tZ V µσ= + 2 0 exp 2 V tVVV t t σ µ σε   = −+    2 0ln( / ) ( ) 2( ) () V T V VD T PD P V D P d T σ µ ε σ   +−  = < = <− = Φ −        2 0ln( / ) ( ) 2 V V VD T d T σ µ σ +− = 0V Vσ 4. 用股价来估计违约概率——Merton模型 • 如何估计 和 ？ • 期权定价模型将今天公司的股票价值E0与公司资产价值V0和资产的波动率σV 联系起来： E V N d De N d d V D r T T d d T rT V V V 0 0 1 2 1 0 2 2 1 2 = − = + + = − −( ) ( ) ln ( ) ( ) ; where σ σ σ 0V Vσ 关系一：股权价值可视作一个欧式看涨期 权，标的是公司的总资产，行权价格为D 公司的股权价值：ET =max(VT –D, 0) 4. 用股价来估计违约概率——Merton模型 • 如何估计 和 ？ • 期权定价模型将今天公司的股票价值E0与公司资产价值V0和资产的波动率σV 联系起来： E V N d De N d d V D r T T d d T rT V V V 0 0 1 2 1 0 2 2 1 2 = − = + + = − −( ) ( ) ln ( ) ( ) ; where σ σ σ 0V Vσ 公司的股权价值：ET =max(VT –D, 0) 股权价值可视作一个欧式看涨期权，标的 是公司的总资产，行权价格为D 4. 用股价来估计违约概率——Merton模型 • 如何估计 和 ？ • 期权定价模型将今天公司的股票价值E0与公司资产价值V0和资产的波动率σV 联系起来： E V N d De N d d V D r T T d d T rT V V V 0 0 1 2 1 0 2 2 1 2 = − = + + = − −( ) ( ) ln ( ) ( ) ; where σ σ σ 0V Vσ 公司的股权价值：ET =max(VT –D, 0) 股权价值可视作一个欧式看涨期权，标的 是公司的总资产，行权价格为D 左边BS公式中d1是风险中性概率测度 下得到的，r为无风险利率； 前面违约距离 d： 根据Merton模型得到的PD是真实违约 概率（Physical Default Probability），不是风险中性违约概 率！ 2 0ln( / ) ( ) 2 V V VD T d T σ µ σ +− = 4. 用股价来估计违约概率——Merton模型 • 如何估计 和 ？ • 期权定价模型将今天公司的股票价值E0与公司资产价值V0和资产的波动率σV 联系起来： • 关系二：又由于股权价值 可表示为关于资产价值 和时间 的函数， 根据伊藤引理， 也服从几何布朗运动，且波动率 满足： E V N d De N d d V D r T T d d T rT V V V 0 0 1 2 1 0 2 2 1 2 = − = + + = − −( ) ( ) ln ( ) ( ) ; where σ σ σ 0V Vσ 00EV E EV V σσ ∂ = ∂ tE tV t tE Eσ 0 10()E VE Nd Vσσ= 1()Delta N d= Delta E V ∂ ∂ 为股票的 4. 用股价来估计违约概率——Merton模型 • 如何估计 和 ？ • 期权定价模型将今天公司的股票价值E0与公司资产价值V0和资产的波动率σV 联系起来： • 关系二：又由于股权价值 可表示为关于资产价值 和时间 的函数， 根据伊藤引理， 也服从几何布朗运动，且波动率 满足： E V N d De N d d V D r T T d d T rT V V V 0 0 1 2 1 0 2 2 1 2 = − = + + = − −( ) ( ) ln ( ) ( ) ; where σ σ σ 0V Vσ 00EV E EV V σσ ∂ = ∂ tE tV t tE Eσ 0 10()E VE Nd Vσσ= 1()Delta N d= Delta E V ∂ ∂ 为股票的 两个方程两个 未知数 4. 用股价来估计违约概率——Merton模型 其中： d称为违约距离（DD，Distance of Default)。 如何估计 和 ？ 71 d dd t Vt t V tZ V µσ= + 2 0 exp 2 V tVVV t t σ µ σε   = −+    2 0ln( / ) ( ) 2( ) () V T V VD T PD P V D P d T σ µ ε σ   +−  = < = <− = Φ −        2 0ln( / ) ( ) 2 V V VD T d T σ µ σ +− = 0V Vσ 将计算得到的 和 代入此式，即得到预 期违约概率EDF。 0V Vσ 4. 用股价来估计违约概率——KMV模型 KMV模型是KMV公司在Merton模型基础上提出的： 1：KMV将公司的违约概率重新定义为： 其中 为理论上不大于D 的违约点（临界值），通常用短期债务+长期债务的 一半替代。 （负债总额中的长期负债往往能缓解公司偿还债务的压力，KMV公司通过大量实 证发现，公司债务价值一般出在公司债务总值和短期负债之间。） 72 ()T DEFPV V≤ DEFV 4. 用股价来估计违约概率——KMV模型 KMV模型是KMV公司在Merton模型基础上提出的： 1：KMV将公司的违约概率重新定义为： 其中 为理论上不大于D 的违约点（临界值），通常用短期债务+长期债务的 一半替代。 2：KMV将违约距离的计算公式简化为： 其中， 是公司资产T 期末价值的期望值，违约概率为： 73 ()T DEFPV V≤ DEFV () () T DEF TV E V V DD E V σ − = × ()PD N DD= − ()TE V 前文的违约距离为： 2 0ln( / ) ( ) 2 VVD T DD d T σ µ σ +− = = 实验9：用Matlab求解KMV模型 • 一、实验内容： • 华域汽车（600741.SH）和*ST斯太（000760.SZ）同为汽车行业产业链中的公司，其中 ，第二只股票名称前被加上*ST，表示该公司被交易所实行风险警示（股票名称前加ST或 者*ST），这类公司通常处于恶劣的财务状况或非正常运营状态。 • 下载两个上市公司行情数据和价值相关数据，将2018-12-31设为当前时刻（信用评估时 段的起点），将期末设为2019-12-31（信用评估时段的终点）。利用KMV 模型估计两家 上市公司期末的违约概率，并观察*ST斯太的违约概率是否大于华域汽车。 • 二、实验原理见Word • 三、实验步骤见Word • 四、实验代码见Word 74 目录 1. 历史违约概率 2. 用信用溢差来估计违约概率：根据债券收益率溢差 3. 用信用溢差来估计违约概率：根据CDS溢差 4. 用股价来估计违约概率 5. 究竟用哪一种估计方法 75 真实世界vs风险中性世界违约概率 • 由债券收益率所隐含的违约概率为风险中性概率 • 由历史数据所隐含的概率为真实世界的违约概率 Rating Historical Default intensity (%) Default Intensity from bonds Ratio Difference Aaa 0.04 0.60 16.6 0.56 Aa 0.05 0.74 15.0 0.69 A 0.11 1.16 10.6 1.05 Baa 0.40 2.13 5.3 1.73 Ba 2.07 4.67 2.3 2.60 B 5.62 7.97 1.4 2.15 Caa 11.26 18.16 1.6 6.90 究竟应该采用哪种估计 • 当对衍生产品定价或者分析违约对产品价格的影响时，应该采用风 险中性违约概率 • 当采用情景分析法来估测因违约而触发的损失时，应该采用真实世 界的违约率 本章结束 78","libVersion":"0.2.4","langs":""}