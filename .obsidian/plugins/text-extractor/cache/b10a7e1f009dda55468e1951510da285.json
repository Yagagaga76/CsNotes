{"path":"pdf/课件/16-MultOrder.pdf","text":"D y n a m i c P r o g r a m m i n g A l g o r i t h m : D e s i g n & A n a l y s i s [ 1 6 ] I n t h e l a s t c l a s s …  S h o r t e s t P a t h a n d T r a n s i t i v e C l o s u r e  W a s h a l l ’ s A l g o r i t h m f o r T r a n s i t i v e C l o s u r e  A l l - P a i r S h o r t e s t P a t h s  M a t r i x f o r T r a n s i t i v e C l o s u r e  M u l t i p l y i n g B i t M a t r i c e s - K r o n r o d ’ s A l g o r i t h m D y n a m i c P r o g r a m m i n g  R e c u r s i o n a n d S u b p r o b l e m G r a p h  B a s i c I d e a o f D y n a m i c P r o g r a m m i n g  L e a s t C o s t o f M a t r i x M u l t i p l i c a t i o n  E x t r a c t i n g O p t i m a l M u l t i p l i c a t i o n O r d e r N a t u r a l R e c u r s i o n m a y b e E x p e n s i v e 0 0 00 0 1 1 1 111 1 1 2 222 2 4 33 3 6 5 4 F i b o n a c c i : F n = F n - 1 + F n - 2 1 6 1 3 1 1 1 0 9 8 1 2 3 4 5 6 7 1 4 1 5 2 1 2 1 1 9 1 8 1 7 2 5 2 3 2 4 2 2 2 0 T h e F n c a n b e c o m p u t e d i n l i n e a r t i m e e a s i l y , b u t t h e c o s t f o r r e c u r s i o n m a y b e e x p o n e n t i a l . F o r y o u r r e f e r e n c e T h e n u m b e r o f a c t i v a t i o n f r a m e s a r e 2 F n + 1 - 1 1 , 1 , 2 , 3 , 5 , 8 , 1 3 , 2 1 , 3 5 , . . . S u b p r o b l e m G r a p h  F o r a n y k n o w n r e c u r s i v e a l g o r i t h m A f o r a s p e c i f i c p r o b l e m , a s u b p r o b l e m g r a p h i s d e f i n e d a s :  v e r t e x : t h e i n s t a n c e o f t h e p r o b l e m  d i r e c t e d e d g e : t h e s u b p r o b l e m g r a p h c o n t a i n s a d i r e c t e d e d g e I  J i f a n d o n l y i f w h e n A i n v o k e d o n I , i t m a k e s a r e c u r s i v e c a l l d i r e c t l y o n i n s t a n c e J .  P o r t i o n A ( P ) o f t h e s u b p r o b l e m g r a p h f o r F i b o n a c c i f u n c t i o n : h e r e i s f i b ( 6 ) 6 5 4 3 2 1 0 P r o p e r t i e s o f S u b p r o b l e m G r a p h  I f A a l w a y s t e r m i n a t e s , t h e s u b p r o b l e m g r a p h f o r A i s a D A G .  F o r e a c h p a t h i n t h e t r e e o f a c t i v a t i o n f r a m e s o f a p a r t i c u l a r c a l l o f A , A ( P ) , t h e r e i s a c o r r e s p o n d i n g p a t h i n t h e s u b p r o b l e m g r a p h o f A c o n n e c t i n g v e r t e x P a n d a b a s e - c a s e v e r t e x .  A t o p - l e v e l r e c u r s i v e c o m p u t a t i o n t r a v e r s e t h e e n t i r e s u b p r o b l e m g r a p h i n s o m e m e m o r y l e s s s t y l e .  T h e s u b p r o b l e m g r a p h c a n b e v i e w e d a s a d e p e n d e n c y g r a p h o f s u b t a s k s t o b e s o l v e d . B a s i c I d e a f o r D y n a m i c P r o g r a m m i n g  C o m p u t i n g e a c h s u b p r o b l e m o n l y o n c e  F i n d a r e v e r s e t o p o l o g i c a l o r d e r f o r t h e s u b p r o b l e m g r a p h  I n m o s t c a s e s , t h e o r d e r c a n b e d e t e r m i n e d b y p a r t i c u l a r k n o w l e d g e o f t h e p r o b l e m .  G e n e r a l m e t h o d b a s e d o n D F S i s a v a i l a b l e  S c h e d u l i n g t h e s u b p r o b l e m s a c c o r d i n g t o t h e r e v e r s e t o p o l o g i c a l o r d e r  R e c o r d t h e s u b p r o b l e m s o l u t i o n s f o r l a t e r u s e T o b a c k t r a c k i n g , r e c o r d t h e r e s u l t i n t o t h e d i c t i o n a r y ( Q , t u r n e d b l a c k ) D y n a m i c P r o g r a m m i n g V e r s i o n D P ( A ) o f a R e c u r s i v e A l g o r i t h m A Q a i n s t a n c e , Q , t o b e c a l l e d o n Q i s u n d i s c o v e r e d ( w h i t e ) , g o a h e a d w i t h t h e r e c u r s i v e c a l l C a s e 1 : W h i t e Q Q a i n s t a n c e , Q , t o b e c a l l e d o n Q i s f i n i s h e d ( b l a c k ) , o n l y “ c h e c k i n g ” t h e e d g e , r e t r i e v e t h e r e s u l t f r o m t h e d i c t i o n a r y C a s e 2 : B l a c k Q N o t e : f o r D A G , n o g r a y v e r t e x w i l l b e m e t D P ( f i b ) : a n E x a m p l e f i b D P w r a p ( n ) D i c t s o l n = c r e a t e ( n ) ; r e t u r n f i b D P ( s o l n , n ) f i b D P ( s o l n , k ) i n t f i b , f 1 , f 2 ; i f ( k < 2 ) f i b = k ; e l s e i f ( m e m b e r ( s o l n , k - 1 ) = = f a l s e ) f 1 = f i b D P ( s o l n , k - 1 ) ; e l s e f 1 = r e t r i e v e ( s o l n , k - 1 ) ; i f ( m e m b e r ( s o l n , k - 2 ) = = f a l s e ) f 2 = f i b D P ( s o l n , k - 2 ) ; e l s e f 2 = r e t r i e v e ( s o l n , k - 2 ) ; f i b = f 1 + f 2 ; s t o r e ( s o l n , k , f i b ) ; r e t u r n f i b T h i s i s t h e w r a p p e r , w h i c h w i l l c o n t a i n p r o c e s s i n g e x i s t i n g i n o r i g i n a l r e c u r s i v e a l g o r i t h m w r a p p e r . M a t r i x M u l t i p l i c a t i o n O r d e r P r o b l e m  T h e t a s k : F i n d t h e p r o d u c t : A 1  A 2  …  A n - 1  A n A i i s 2 - d i m e n t i o n a l a r r a y o f d i f f e r e n t l e g a l s i z e  T h e i s s u e s :  M a t r i x m u l t i p l i c a t i o n i s a s s o c i a t i v e  D i f f e r e n t c o m p u t i n g o r d e r r e s u l t s i n g r e a t d i f f e r e n c e i n t h e n u m b e r o f o p e r a t i o n s  T h e p r o b l e m :  W h i c h i s t h e b e s t c o m p u t i n g o r d e r C o s t o f M a t r i x M u l t i p l i c a t i o n L e t C = A p  q  B q  r T h e r e a r e q m u l t i p l i c a t i o n C h a s p  r e l e m e n t s a s c i , j S o , p q r m u l t i p l i c a t i o n s a l t o g e t h e r A n e x a m p l e : A 1  A 2  A 3  A 4 3 0  1 1  4 0 4 0  1 0 1 0  2 5 ( ( A 1  A 2 )  A 3 )  A 4 : 2 0 7 0 0 m u l t i p l i c a t i o n s A 1  ( A 2  ( A 3  A 4 ) ) : 1 1 7 5 0 ( A 1  A 2 )  ( A 3  A 4 ) : 4 1 2 0 0 A 1  ( ( A 2  A 3 )  A 4 ) : 1 4 0 0 L o o k i n g f o r a G r e e d y S o l u t i o n  G r e e d y a l g o r i t h m s a r e u s u a l l y s i m p l e .  S t r a t e g y 1 : “ c h e a p e s t m u l t i p l i c a t i o n f i r s t ”  S u c c e s s : A 3 0  1  ( ( A 1  4 0  A 4 0  1 0 )  A 1 0  2 5  F a i l : ( A 4  1  A 1  1 0 0 )  A 1 0 0  5  S t r a t e g y 2 : “ l a r g e s t d i m e n s i o n f i r s t ”  C o r r e c t f o r t h e s e c o n d e x a m p l e a b o v e  A 1  1 0  A 1 0  1 0  A 1 0  2 : t w o r e s u l t s P r o b l e m a n d S u b - p r o b l e m : I n t u i t i o n  M a t r i c e s : A 1 , A 2 , … , A n  D i m e n s i o n : d i m : d 0 , d 1 , d 2 , … , d n - 1 , d n , f o r A i i s d i - 1  d i  S u b - p r o b l e m : s e q : s 0 , s 1 , s 2 , … , s k - 1 , s l e n , w h i c h m e a n s t h e m u l t i p l i c a t i o n o f k m a t r i c e s , w i t h t h e d i m e n s i o n s : d s 0  d s 1 , d s 1  d s 2 , … , d s [ l e n ] - 1  d s [ l e n ] .  N o t e : t h e o r i g i n a l p r o b l e m i s : s e q = ( 0 , 1 , 2 , … , n ) m m T r y 1 ( d i m , l e n , s e q ) i f ( l e n < 3 ) b e s t C o s t = 0 e l s e b e s t C o s t =  ; f o r ( i = 1 ; i  l e n - 1 ; i + + ) c = c o s t o f m u l t i p l i c a t i o n a t p o s i t i o n s e q [ i ] ; n e w S e q = s e q w i t h i t h e l e m e n t d e l e t e d ; b = m m T r y 1 ( D i m , l e n - 1 , n e w S e q ) ; b e s t C o s t = m i n ( b e s t C o s t , b + c ) ; r e t u r n b e s t C o s t C o s t o f t h e O p t i m u m O r d e r b y R e c u r s i o n R e c u r s i o n o n i n d e x s e q u e n c e : ( s e q ) : 0 , 1 , 2 , … , n ( l e n = n ) w i t h t h e k t h m a t r i x i s A k ( k  0 ) o f t h e s i z e d k - 1  d k , a n d t h e k t h ( k < n ) m u l t i p l i c a t i o n i s A k  A k + 1 . T ( n ) = ( n - 1 ) T ( n - 1 ) + n , i n  ( ( n - 1 ) ! ) C o n s t r u c t i n g t h e S u b p r o b l e m G r a p h  T h e k e y i s s u e i s : h o w c a n a s u b p r o b l e m b e d e n o t e d u s i n g a c o n c i s e i d e n t i f i e r ?  F o r m m T r y 1 , t h e d i f f i c u l t o r i g i n a t e s f r o m t h e v a r i e d i n t e r v a l s i n e a c h n e w S e q .  I f w e l o o k a t t h e l a s t ( c o n t r a s t t o t h e f i r s t ) m u l t i p l i c a t i o n , t h e t w o ( n o t o n e ) r e s u l t e d s u b p r o b l e m s a r e b o t h c o n t i g u o u s s u b s e q u e n c e s , w h i c h c a n b e u n i q u e l y d e t e r m i n e d b y t h e p a i r : < h e a d - i n d e x , t a i l - i n d e x > B e s t O r d e r b y R e c u r s i o n : I m p r o v e d m m T r y 2 ( d i m , l o w , h i g h ) i f ( h i g h - l o w = = 1 ) b e s t C o s t = 0 e l s e b e s t C o s t =  ; f o r ( k = l o w + 1 ; k  h i g h - 1 ; k + + ) a = m m T r y 2 ( d i m , l o w , k ) ; b = m m T r y 2 ( d i m , k , h i g h ) ; c = c o s t o f m u l t i p l i c a t i o n a t p o s i t i o n k ; b e s t C o s t = m i n ( b e s t C o s t , a + b + c ) ; r e t u r n b e s t C o s t w i t h d i m e n s i o n s : d i m [ l o w ] , d i m [ k ] , a n d d i m [ h i g h ] S t i l l i n   ( 2 n ) ! O n l y o n e m a t r i x T ( n ] = B e s t O r d e r b y D y n a m i c P r o g r a m m i n g  D F S c a n t r a v e r s e t h e s u b p r o b l e m g r a p h i n t i m e O ( n 3 )  A t m o s t n 2 / 2 v e r t i c e s , a s < i , j > , 0  i < j  n .  A t m o s t 2 n e d g e s l e a v i n g a v e r t e x m m T r y 2 D P ( d i m , l o w , h i g h , c o s t ) … … f o r ( k = l o w + 1 ; k  h i g h - 1 ; k + + ) i f ( m e m b e r ( l o w , k ) = = f a l s e ) a = m m T r y 2 ( d i m , l o w , k ) ; e l s e a = r e t r i e v e ( c o s t , l o w , k ) ; i f ( m e m b e r ( k , h i g h ) = = f a l s e ) b = m m T r y 2 ( d i m , k , h i g h ) ; e l s e b = r e t r i e v e ( c o s t , k , h i g h ) ; … … s t o r e ( c o s t , l o w , h i g h , b e s t C o s t ) ; r e t u r n b e s t C o s t C o r r e s p o n d i n g t o t h e r e c u r s i v e p r o c e d u r e o f D F S S i m p l i f i c a t i o n U s i n g O r d e r i n g F e a t u r e  C o m p u t i n g s u b p r o b l e m s a c c o r d i n g t h e d e p e n d e n c y o r d e r  m a t r i x O r d e r ( n , c o s t , l a s t )  f o r ( l o w = n - 1 ; l o w  1 ; l o w - - )  f o r ( h i g h = l o w + 1 ; h i g h  n ; h i g h + + )  r e t u r n c o s t [ 0 ] [ n ] C o m p u t e s o l u t i o n o f s u b p r o b l e m ( l o w , h i g h ) a n d s t o r e i t i n c o s t [ l o w ] [ h i g h ] a n d l a s t [ l o w ] [ h i g h ] M a t r i x M u l t i p l i c a t i o n O r d e r : A l g o r i t h m  I n p u t : a r r a y d i m = ( d 0 , d 1 , … , d n ) , t h e d i m e n s i o n o f t h e m a t r i c e s .  O u t p u t : a r r a y m u l t O r d e r , o f w h i c h t h e i t h e n t r y i s t h e i n d e x o f t h e i t h m u l t i p l i c a t i o n i n a n o p t i m u m s e q u e n c e . f l o a t m a t r i x O r d e r ( i n t [ ] d i m , i n t n , i n t [ ] m u l t O r d e r ) < i n i t i a l i z a t i o n o f l a s t , c o s t , b e s t c o s t , b e s t l a s t … > f o r ( l o w = n - 1 ; l o w  1 ; l o w - - ) f o r ( h i g h = l o w + 1 ; h i g h  n ; h i g h + + ) i f ( h i g h - l o w = = 1 ) < b a s e c a s e > e l s e b e s t c o s t =  ; f o r ( k = l o w + 1 ; k  h i g h - 1 ; k + + ) a = c o s t [ l o w ] [ k ] ; b = c o s t [ k ] [ h i g h ] c = m u l t C o s t ( d i m [ l o w ] , d i m [ k ] , d i m [ h i g h ] ) ; i f ( a + b + c < b e s t C o s t ) b e s t C o s t = a + b + c ; b e s t L a s t = k ; c o s t [ l o w ] [ h i g h ] = b e s t C o s t ; l a s t [ l o w ] [ h i g h ] = b e s t L a s t ; e x t r c t O r d e r W r a p ( n , l a s t , m u l t O r d e r ) r e t u r n c o s t [ 0 ] [ n ] U s i n g t h e s t o r e d r e s u l t s A n E x a m p l e  I n p u t : d 0 = 3 0 , d 1 = 1 , d 2 = 4 0 , d 3 = 1 0 , d 4 = 2 5 c o s t a s f i n i s h e d F i r s t e n t r y f i l l e d L a s t e n t r y f i l l e d N o t e : c o s t [ i ] [ j ] i s t h e l e a s t c o s t o f A i + 1  A i + 2  … A j . F o r e a c h s e l e c t e d k , r e t r i e v i n g : • l e a s t c o s t o f A i + 1  …  A k . • l e a s t c o s t o f A k + 1  …  A j . a n d c o m p u t i n g : • c o s t o f t h e l a s t m u l t i p l i c a t i o n A r r a y l a s t a n d t h e A r i t h m e t i c - E x p r e s s i o n T r e e  E x a m p l e i n p u t : d 0 = 3 0 , d 1 = 1 , d 2 = 4 0 , d 3 = 1 0 , d 4 = 2 5 l a s t a s f i n i s h e d A 1 A 2 A 3 A 4 ( 0 , 1 ) ( 1 , 2 ) ( 3 , 4 ) ( 1 , 3 ) ( 1 , 4 ) ( 0 , 4 ) ( 2 , 3 ) A s r o o t    C o m p u t i n g i n p o s t o r d e r  T h e c o r e p r o c e d u r e i s e x t r a c t O r d e r , w h i c h f i l l s t h e m u l t i O r d e r a r r a y f o r s u b p r o b l e m ( l o w , h i g h ) , u s i n g i n f o r m a t i o n s i n l a s t a r r a y . e x t r a c t O r d e r ( l o w , h i g h , l a s t , m u l t O r d e r ) i n t k ; i f ( h i g h - l o w > 1 ) k = l a s t [ l o w ] [ h i g h ] ; e x t r a c t O r d e r ( l o w , k , l a s t , m u l t O r d e r ) ; e x t r a c t O r d e r ( k , h i g h , l a s t , m u l t O r d e r ) ; m u l t O r d e r [ m u l t O r d e r N e x t ] = k ; m u l t O r d e r N e x t + + ; E x t r a c t i n g t h e O p t i m a l O r d e r J u s t a p o s t - o r d e r t r a v e r s a l i n i t i a l i z e d i n t h e w r a p p e r C a l l i n g M a p f l o a t m a t r i x O r d e r ( i n t [ ] d i m , i n t n , i n t [ ] m u l t O r d e r ) i n t [ ] l a s t ; f l o a t [ ] c o s t ; i n t l o w , h i g h , . . . . . . f o r ( l o w = n - 1 ; l o w  1 ; l o w - - ) f o r ( h i g h = l o w + 1 ; h i g h  n ; h i g h + + ) . . . . . . f o r ( k = l o w + 1 ; k  h i g h - 1 ; k + + ) < C o m p u t i n g a l l p o s s i b l e m u l t C o s t b y c a l l i n g m u l t C o s t > < F i l l i n g t h e e n t r i e s i n c o s t a n d l a s t ( o n e e n t r y f o r e a c h ) > e x t r a c t O r d e r W r a p ( n , l a s t , m u l t O r d e r ) r e t u r n c o s t [ 0 ] [ n ] ; O u t p u t , p a s s e d t o e x t r a c t O r d e r e x t r a c t O r d e r ( l o w , h i g h , l a s t , m u l t O r d e r ) < W h e n e v e r h i g h > l o w , c a l l r e c u r s i v e l y o n ( l o w , k ) a n d ( k , h i g h ) w h e r e k = l a s t [ l o w ] [ h i g h ] > A n a l y s i s o f m a t r i x O r d e r  M a i n b o d y : 3 l a y e r o f l o o p s  T i m e : t h e i n n e r m o s t p r o c e s s i n g c o s t s c o n s t a n t , w h i c h i s e x e c u t e d  ( n 3 ) t i m e s .  S p a c e : e x t r a s p a c e f o r c o s t a n d l a s t , b o t h i n  ( n 2 )  O r d e r e x t r a c t i n g  T h e r e a r e 2 n - 1 n o d e s i n t h e a r i t h m e t i c - e x p r e s s i o n t r e e . F o r e a c h n o d e , e x t r a c t O r d e r i s c a l l e d o n c e . S i n c e n o n - r e c u r s i v e c o s t f o r e x t r a c t O r d e r i s c o n s t a n t , s o , t h e c o m p l e x i t y o f e x t r a c t O r d e r i s i n  ( n ) H o m e A s s i g n m e n t  1 0 . 1  1 0 . 4  1 0 . 6  1 0 . 7","libVersion":"0.2.4","langs":""}