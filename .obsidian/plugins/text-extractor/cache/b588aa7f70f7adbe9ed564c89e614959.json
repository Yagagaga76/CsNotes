{"path":"pdf/金融风险管理/7 基于var的组合风险来源分析和风险预算.pdf","text":"基于VaR的组合风险来源分析 与风险预算 主讲教师：刘烨 南京大学工程管理学院 Financial Risk Management 第7章 1 目录 • 1. 回顾：投资组合的VaR • 2. 边际VaR • 3. 增量VaR • 4. 成份VaR • 5. 综合案例：边际VaR、增量VaR和成份VaR的应用 • 6. 组合风险预算 • 7. Matlab代码：边际VaR、增量VaR和成份VaR 组合风险来源分析工具 1.回顾：投资组合的VaR 多资产且每个资产的收益率服从正态分布 • 假设组合由 n 种资产构成，组合的初始价值为 ，组合中n 种资产的初始 价值分别为 。n 种资产的日收益率向量 服 从n 维正态分布 ，则该组合在置信度c下的日VaRA为： 其中， 是权重。 0P 0,1 0,2 0,, ,, nPP P (, )N µ Σ 12, ,, )nRR R( 1 n i i iA wµµ = =∑ 2 22 ,, 1 11 2 nn n nn A i j ij i j i i i j ij i j i j=1 i i j i ww w wwσ ρ σσ σ ρ σσ = = = > += =∑∑ ∑ ∑∑ 0, 0 i i P w P = 1 0 ( () )A AAVaR P c σµ −= Φ− 1.投资组合的VaR ——贯穿本章的案例 • 例：考虑含两种货币——加拿大元（CAD）和欧元（EUR）的投资组合。这两 种货币不相关，且相对美元各自有5%和12%的波动性。该投资组合有200万 美元投资与CAD，100万美元投资与EUR。 • Q1：计算95%置信水平下的组合VaR。 • 已知条件： • 计算组合的方差： • 计算VaR： • 万美元 22 1 0.05σ = 22 2 0.12σ = 0 0,1 0,2 200 100 300PPP += + == 1 0,1 0 2 /3PwP == 2 0,2 0 1/ 3PwP == 12 0ρ = 22 22 2 2 2 2 11 22 1 2 12 1 22 ( ) 0.05 (1 3) 0.12A w w + w w = 2/3 =5.21%σ σ σ ρ σσ+ ⋅ + ⋅= 1 0 (0.95) 300 1.65 0.0521 25.7738AAVaR P =σ −= ⋅Φ ⋅ = ⋅⋅ 12 0=µµ = 目录 • 1. 回顾：投资组合的VaR • 2. 边际VaR • 3. 增量VaR • 4. 成份VaR • 5. 综合案例：边际VaR、增量VaR和成份VaR的应用 • 6. 组合风险预算 • 7. Matlab代码：边际VaR、增量VaR和成份VaR 组合风险来源分析工具 2. 边际VaR——定义 • 边际VaR (Marginal VaR，M-VaR)， • 定义：是指组合中资产 i 增加1美元时，引起的组合VaR的变化值，即 其中， 是组合的VaR， 是第 i 种资产的价值。 • 含义：增加1美元资产 i 引起的组合风险的变化值。 A i i VaR M-VaR = P ∂ ∂ AVaR iP 2. 边际VaR ——计算公式 • 边际VaR (Marginal VaR，M-VaR)， • 定义：是指组合中资产 i 增加1美元时，引起的组合VaR的变化值，即 计算公式1： 计算公式2： 其中， 是组合的VaR， 、 分别是第 i 种资产的价值和日收益率， 、 是 组合的当前价值和日收益率。 A i i VaR M-VaR = P ∂ ∂ AVaR iP 0PiR AR 1 cov( , ) () - iA A RR c σ = Φ , , 2 0 cov( , ) , iAA iA iA A RRVaR = where = P ββ σ 2. 边际VaR ——计算公式 • 证明公式1： 00 1 10 0 1 ( () ) ()1 () AA A i ii i - -A A ii VaR VaR VaR M-VaR = = = P w P P w P c = c Pw w σ σ ∂∂ ∂ ⋅ ∂∂ ∂ ∂ ⋅Φ ∂ ⋅=Φ ∂∂ 2. 边际VaR ——计算公式 • 证明公式1： 又因为： 00 1 10 0 1 ( () ) ()1 () AA A i ii i - -A A ii VaR VaR VaR M-VaR = = = P w P P w P c = c Pw w σ σ ∂∂ ∂ ⋅ ∂∂ ∂ ∂ ⋅Φ ∂ ⋅=Φ ∂∂ 2 22 , 1 1 n nn A i i i j ij i j i i ji w wwσ σ ρ σσ = = ≠ +=∑ ∑∑ 2 ,22 2 cov( , ) 2 cov( , ) 2 cov( , ) 2 cov( , ) 2 cov( , ) 2 cov( , ) 2 n A A ii j i ji j j=1,j ii n ii i ji j j=1,j i n i ii i j j j=1,j i n i ii j j i A j=1,j i w w = w RR w RR = R w R R w R =R w R + w R =R R w σ σ σ ρ σσ ≠ ≠ ≠ ≠ ∂ + ∂ + + = ∑ ∑ ∑ ∑ cov( , )iAA iA RR w σ σ ∂ ∂ = 2. 边际VaR ——计算公式 • 证明公式1： 又因为： 所以， 00 1 10 0 1 ( () ) ()1 () AA A i ii i - -A A ii VaR VaR VaR M-VaR = = = P w P P w P c = c Pw w σ σ ∂∂ ∂ ⋅ ∂∂ ∂ ∂ ⋅Φ ∂ ⋅=Φ ∂∂ cov( , )iAA iA RR w σ σ ∂ ∂ = 1 cov( , ) () - iAA i i A RRVaR M-VaR = c P σ ∂ = Φ ∂ 2. 边际VaR ——计算公式 • 证明公式2： • 资产 i 的收益率与组合收益率的相关性越大（即资产 i 的系统性风险越大），则 该资产对组合风险的贡献越大。 1 1 0 2 0 2 0 0 cov( , ) () ( ) cov( , ) cov( , ) - iAA i i A - A iA A iAA A A i,A RRVaR M-VaR = c P P c RR = P RRVaR = P VaR = P σ σ σ σ β ∂ = Φ ∂ Φ ⋅ ⋅ ⋅ 目录 • 1. 回顾：投资组合的VaR • 2. 边际VaR • 3. 增量VaR • 4. 成份VaR • 5. 综合案例：边际VaR、增量VaR和成份VaR的应用 • 6. 组合风险预算 • 7. Matlab代码：边际VaR、增量VaR和成份VaR 组合风险来源分析工具 3. 增量VaR • 增量VaR（Incremental VaR，简记为I-VaR） • 定义：假设在原来投资组合基础上，增加（或者减少）一个投资组合，并 将原投资组合的VaR记为 ，调整后组合的VaR记为 ，于是，增量 VaR定义为： • 含义：头寸变化对VaR的影响，或者，做或不做某个交易对VaR的影响。 AVaR A+aVaR A+a AI-VaR=VaR VaR− 3. 增量VaR • 增量VaR（Incremental VaR，简记为I-VaR） • 定义：假设在原来投资组合基础上，新增加（或者减少）一个投资组合， 并将原投资组合的VaR记为 ，调整后组合的VaR记为 ，于是，增 量VaR定义为： • 精确计算方法：分别计算 和 。 • 对于金额很大、包含资产种类很多的的组合，该方法的计算量极大； • 然而，在考虑一笔交易时，可能需要在几分钟内决定，否则会因计算时间过长而耽误 新交易的最佳时机。 AVaR A+aVaR A+a AI-VaR=VaR VaR− AVaR A+aVaR 3. 增量VaR • 增量VaR（Incremental VaR，简记为I-VaR） • 定义：假设在原来投资组合基础上，新增加（或者减少）一个投资组合， 并将原投资组合的VaR记为 ，调整后组合的VaR记为 ，于是，增 量VaR定义为： • 近似计算方法： • 其中， 表示资产 i 增加的头寸（金额）。 • 该方法适合新交易的金额较小，而原组合金额巨大的情况。 AVaR A+aVaR A+a AI-VaR=VaR VaR− 1 n ii i I-VaR M-VaR a = ≈⋅∑ ia 目录 • 1. 回顾：投资组合的VaR • 2. 边际VaR • 3. 增量VaR • 4. 成份VaR • 5. 综合案例：边际VaR、增量VaR和成份VaR的应用 • 6. 组合风险预算 • 7. Matlab代码：边际VaR、增量VaR和成份VaR 组合风险来源分析工具 4. 成份VaR——定义 • 成份VaR（Component VaR，简记为C-VaR） • 定义：从投资组合中删除某成分（资产 i ）时，组合VaR的近似变化量，记 为 。具体定义为： • 含义：资产 i 对组合风险的贡献量。 iC-VaR 0,i iiC-VaR =M-VaR P⋅ 4. 成份VaR——计算公式 • 成份VaR（Component VaR，简记为C-VaR） • 定义：从投资组合中删除某成分（资产 i ）时，组合VaR的近似变化量，记 为 。具体定义为： • 含义：资产 i 对组合风险的贡献量。 • 计算公式： • 其中， 是原组合的VaR。 iC-VaR 0,i iiC-VaR =M-VaR P⋅ i,A i,A= =( ) = A i i 0,i 0,i A i 0 VaR C -VaR M -VaR P P VaR w P ββ× ⋅⋅ ⋅ AVaR 4. 成份VaR——计算公式 • 成份VaR（Component VaR，简记为C-VaR） • 定义：从投资组合中删除某成分（资产 i ）时，组合VaR的近似变化量，记 为 。具体定义为： • 含义：资产 i 对组合风险的贡献量。 • 计算公式： • 可推出所谓的Euler定理： 这是因为 iC-VaR 0,i iiC-VaR =M-VaR P⋅ i,A i,A= =( ) = A i i 0,i 0,i A i 0 VaR C -VaR M -VaR P P VaR w P ββ× ⋅⋅ ⋅ =iA i C -VaR VaR∑ i,A 2 2 cov( , )cov( , ) (( = 1 ii AiA i ii ii A A w R RRR w =wβ σσ =∑ ∑∑)) 4. 成份VaR——计算公式 • 成份VaR（Component VaR，简记为C-VaR） • 定义：从投资组合中删除某成分（资产 i ）时，组合VaR的近似变化量，记 为 。具体定义为： • 含义：资产 i 对组合风险的贡献量。 • 计算公式： • 可推出所谓的Euler定理： 交易组合的成份VaR的总和等于交易组合的整体VaR；在做风险预算时，如果 某一成份的VaR过高，则需要调整组合。 iC-VaR 0,i iiC-VaR =M-VaR P⋅ i,A i,A= =( ) = A i i 0,i 0,i A i 0 VaR C -VaR M -VaR P P VaR w P ββ× ⋅⋅ ⋅ =iA i C -VaR VaR∑ 百分比贡献率： , i i iA A C -VaR w VaR β= 目录 • 1. 回顾：投资组合的VaR • 2. 边际VaR • 3. 增量VaR • 4. 成份VaR • 5. 综合案例：边际VaR、增量VaR和成份VaR的应用 • 6. 组合风险预算 • 7. Matlab代码：边际VaR、增量VaR和成份VaR 组合风险来源分析工具 4. 综合案例：边际VaR、增量VaR和成份VaR的应用 • 例：考虑含两种货币——加拿大元（CAD）和欧元（EUR）的投资组合。这两 种货币不相关，且相对美元各自有5%和12%的波动性。该投资组合有200万 美元投资与CAD，100万美元投资与EUR。计算95%置信水平下的组合VaR。 • Q2：计算M-VaR和C-VaR。 （ ） 货币 头寸 波动率 协方差 Beta CAD 200万 EUR 100万 Total 300万 1 5%σ = 2 12%σ = 5.21A %σ = 1 1 11 2 2 22 11 cov( , ) , 2 3 0.05 cov( )AR R wR w RR w σ + = × = = 2 2 11 2 2 22 2 2 cov( , ) , 1 3 0.12 cov( )AR R wR w RR w σ + = × = = 1 1, 2 cov( , ) 0.61 A A A RR =β σ = 2 2, 2 cov( , ) 1.77 A A A RR =β σ = 0 A i i,A VaR M-VaR = P β⋅ 4. 综合案例：边际VaR、增量VaR和成份VaR的应用（续） • 例：考虑含两种货币——加拿大元（CAD）和欧元（EUR）的投资组合。这两 种货币不相关，且相对美元各自有5%和12%的波动性。该投资组合有200万 美元投资与CAD，100万美元投资与EUR。计算95%置信水平下的组合VaR。 • Q2：计算M-VaR和C-VaR。 货币 头寸 Beta M-VaR C-VaR Percent Conribution CAD 200万 0.61 0.0528 10.5630万 41% EUR 100万 1.77 0.1521 15.2108万 59% VaR 25.7738万 25.7738万 100% ,iAβ , 0 A i iA VaR M VaR P β−= 0,i iiC VaR M VaR P− = − ⋅ , i i iA A C VaR w VaR β − = • 应用于组合管理： • 应用1：调整组合权重 ，使得组合的风险最小。在最优解处， 或： 基金经理如果想减少组合风险，一般会先找出边际VaR最大的资产，并减少其头寸，如此循 环此过程，直至所有资产的边际VaR相等。 12, ,, nww w 12 nM VaR M VaR M VaR−= − = = − 1, 2, ,A A nAβ β β= = = 4. 综合案例：边际VaR、增量VaR和成份VaR的应用（续） 0 A i i,A VaR M-VaR = P β⋅ • 应用于组合管理： • 应用1：调整组合权重 ，使得组合的风险最小。在最优解处， 或： • 应用2：在风险和收益之间权衡，选择最优组合（使得夏普比最大的组合）： 此时： 或 12 nM VaR M VaR M VaR−= − = = − 1, 2, ,A A nAβ β β= = = () ()A f A f AA ER R ER R SR VaRσ − − = ⇒ 12 12 () ( ) ( )f f nf n ER R ER R ER R M VaR M VaR M VaR −− − = = = −− −  4. 综合案例：边际VaR、增量VaR和成份VaR的应用（续） 12, ,, nww w 12 12 () ( ) ( )f f nf n ER R ER R ER R ββ β −− − = = = • 例：考虑含两种货币——加拿大元（CAD）和欧元（EUR）的投资组合。这两 种货币不相关，且相对美元各自有5%和12%的波动性。该投资组合有200万 美元投资与CAD，100万美元投资与EUR。计算95%置信水平下的组合VaR。 • Q3：计算使得组合风险最小的最优权重w1和w2。 4. 综合案例：边际VaR、增量VaR和成份VaR的应用（续） Asset Original Position Marginal VaR Final Position Marginal VaR Beta CAD 66.67% 0.0528 85.21% 0.0762 1 EUR 33.33% 0.1521 14.79% 0.0762 1 Total 100% 100% VaR 25.7738万 22.8462万 5.207% 4.615%Aσ • 例：考虑含两种货币——加拿大元（CAD）和欧元（EUR）的投资组合。这两 种货币不相关，且相对美元各自有5%和12%的波动性。该投资组合有200万 美元投资与CAD，100万美元投资与EUR。计算95%置信水平下的组合VaR。 • Q3：计算使得组合风险最小的最优权重w1和w2。 4. 综合案例：边际VaR、增量VaR和成份VaR的应用（续） Asset Original Position Marginal VaR Final Position Marginal VaR Beta CAD 66.67% 0.0528 85.21% 0.0762 1 EUR 33.33% 0.1521 14.79% 0.0762 1 Total 100% 100% VaR 25.7738万 22.8462万 5.207% 4.615%Aσ 1, 2, 1 2 1 1 1 2 2 2 1 1 2 2 1 1 1 2 2 2 22 11 2 2 cov( , ) cov( , ) cov( , ) cov( , ) cov( , ) cov( , ) AA A ARR R R R wR w R R wR w R R wR R w R w =w ββ σσ = ⇒= ⇒ += + ⇒= ⇒ 2 2 2 2 1 2 1 20.05 , 0.12 , 1= = wwσσ += • 例：考虑含两种货币——加拿大元（CAD）和欧元（EUR）的投资组合。这两 种货币不相关，且相对美元各自有5%和12%的波动性。该投资组合有200万 美元投资与CAD，100万美元投资与EUR。计算95%置信水平下的组合VaR。 • Q3：计算使得组合风险最小的最优权重w1和w2。 4. 综合案例：边际VaR、增量VaR和成份VaR的应用（续） Asset Original Position Marginal VaR Final Position Marginal VaR Beta CAD 66.67% 0.0528 85.21% 0.0762 1 EUR 33.33% 0.1521 14.79% 0.0762 1 Total 100% 100% VaR 25.7738万 22.8462万 5.207% 4.615%Aσ 1, 2, 1 2 1 11 2 2 11 2 2 1 11 2 2 2 22 11 2 2 cov( , ) cov( , ) cov( , ) cov( , ) cov( , ) cov( , ) AA A ARR R R R wR w R R wR w R R wR R w R w =w β β σσ = ⇒= ⇒ + = + ⇒= ⇒ 2 2 2 2 1 2 1 20.05 , 0.12 , 1= = wwσσ += 22 1 1 1 1 11 11 1, 2 2 2 22 22 11 22 cov( , ) cov( , )A A A AA R R R wR w w == w w σσ β σ σ σ σ σ = = + • 例：考虑含两种货币——加拿大元（CAD）和欧元（EUR）的投资组合。这两 种货币不相关，且相对美元各自有5%和12%的波动性。该投资组合有200万 美元投资与CAD，100万美元投资与EUR。计算95%置信水平下的组合VaR。 • Q3：计算使得组合风险最小的最优权重w1和w2。 4. 综合案例：边际VaR、增量VaR和成份VaR的应用（续） Asset Original Position Marginal VaR Final Position Marginal VaR Beta CAD 66.67% 0.0528 85.21% 0.0762 1 EUR 33.33% 0.1521 14.79% 0.0762 1 Total 100% 100% VaR 25.7738万 22.8462万 5.207% 4.615%Aσ 1, 2, 1 2 1 11 2 2 11 2 2 1 11 2 2 2 22 11 2 2 cov( , ) cov( , ) cov( , ) cov( , ) cov( , ) cov( , ) AA A ARR R R R wR w R R wR w R R wR R w R w =w β β σσ = ⇒= ⇒ + = + ⇒= ⇒ 2 2 2 2 1 2 1 20.05 , 0.12 , 1= = wwσσ += • 例：考虑含两种货币——加拿大元（CAD）和欧元（EUR）的投资组合。这两种 货币不相关，且相对美元各自有5%和12%的波动性。该投资组合有200万美元投 资与CAD，100万美元投资与EUR。计算95%置信水平下的组合VaR。 • Q4：如果两种货币的期望回报为8%、5%，rf=0，调整w1和w2使得夏普比最大 。 4. 综合案例：边际VaR、增量VaR和成份VaR的应用（续） Asset Original Position Beta Ratio Final Position Beta Ratio CAD 8.00% 66.67% 0.615 0.1301 90.21% 1.038 0.0771 EUR 5.00% 33.33% 1.77 0.0282 9.79% 0.649 0.0771 Total - 100% - - 100% - - VaR - 4.7738万 - - -0.05805万 - - - 5.207% - - 4.661% - - - 7.00% - - 7.71% - - Sharp Ratio - 1.3443 - - 1.6542 - - Aσ ()AER ()iER ( )/i iER β ( )/i iER βiβ iβ iw iw • 例：考虑含两种货币——加拿大元（CAD）和欧元（EUR）的投资组合。这两种 货币不相关，且相对美元各自有5%和12%的波动性。该投资组合有200万美元投 资与CAD，100万美元投资与EUR。计算95%置信水平下的组合VaR。 • Q4：如果两种货币的期望回报为8%、5% ，rf=0，调整w1和w2使得夏普比最大 。 4. 综合案例：边际VaR、增量VaR和成份VaR的应用（续） Asset Original Position Beta Ratio Final Position Beta Ratio CAD 8.00% 66.67% 0.615 0.1301 90.21% 1.038 0.0771 EUR 5.00% 33.33% 1.77 0.0282 9.79% 0.649 0.0771 Total - 100% - - 100% - - VaR - 4.7738万 - - -0.05805万 - - - 5.207% - - 4.661% - - - 7.00% - - 7.71% - - SharpRatio - 1.3443 - - 1.6542 - - Aσ ()AER ()iER ( )/i iER β ( )/i iER βiβ iβ iw iw 2212 2 2 1122 1, 2, 1 1 2 2 () ( ) 0.08 0.05 8 5 AA ER ER = ww ww σσ β β σσ = ⇒ ⇒= 2 2 2 2 1 2 1 20.05 , 0.12 , 1= = wwσσ += • 例：考虑含两种货币——加拿大元（CAD）和欧元（EUR）的投资组合。这两 种货币不相关，且相对美元各自有5%和12%的波动性。该投资组合有200万 美元投资与CAD，100万美元投资与EUR。计算95%置信水平下的组合VaR。 • Q4：如果两种货币的期望回报为8%、5%，调整w1和w2，使得夏普比最大。 4. 综合案例：边际VaR、增量VaR和成份VaR的应用（续） Asset Original Position Beta Ratio Final Position Beta Ratio CAD 8.00% 66.67% 0.615 0.1301 90.21% 1.038 0.0771 EUR 5.00% 33.33% 1.77 0.0282 9.79% 0.649 0.0771 Total - 100% - - 100% - - VaR - 4.7738万 - - -0.05805万 - - - 5.207% - - 4.661% - - - 7.00% - - 7.71% - - SharpRatio - 1.3443 - - 1.6542 - - Aσ ()AER ()iER ( )/i iER β ( )/i iER βiβ iβ iw iw 2212 2 2 1122 1, 2, 1 1 2 2 () ( ) 0.08 0.05 8 5 AA ER ER = ww ww σσ β β σσ = ⇒ ⇒= 2 2 2 2 1 2 1 20.05 , 0.12 , 1= = wwσσ += 22 1 1 1 1 11 11 1, 2 2 2 22 22 11 22 cov( , ) cov( , )A A A AA R R R wR w w == w w σσ β σ σ σ σ σ = = + 4. 综合案例：巴林银行的风险来源分析 • 里森在日经指数期货中持有77亿美元的多头，在日本市政债券期货 中持有160亿美元的空头头寸： • 里森的VaR是多少？ • 哪个成分对VaR的影响最大？ • 每一种头寸是另一种头寸的套期保值还是增强了总体风险？ 4. 综合案例：巴林银行的风险来源分析（续） • 巴林银行的风险来源分析 月波动性 4. 综合案例：巴林银行的风险来源分析（续） • 巴林银行的风险来源分析 月波动性 负相关 4. 综合案例：巴林银行的风险来源分析（续） • 巴林银行的风险来源分析 组合方差 4. 综合案例：巴林银行的风险来源分析（续） • 巴林银行的风险来源分析 组合方差 目录 • 1. 回顾：组合的VaR • 2. 边际VaR和增量VaR • 3. 成份VaR • 4. 综合案例：边际VaR、增量VaR和成份VaR的应用 • 5. 组合风险预算 • 6. Matlab代码：边际VaR、增量VaR和成份VaR 5. 组合风险预算——例子 • A manager has a portfolio with only one position: a $500 million investment in W. • The manager is considering adding a $500 million position X or Y to the portfolio. • The current volatility of W is 10%. • The manager wants to limit portfolio VaR to $200 million at the 99% confidence level. • Position X has a return volatility of 9% and a correlation with W equal to 0.7. • Position Y has a return volatility of 12% and a correlation with W equal to zero. • Determine which of the two proposed additions, X or Y, will keep the manager within his risk budget. 5. 组合风险预算——例子 • A manager has a portfolio with only one position: a $500 million investment in W. • The manager is considering adding a $500 million position X or Y to the portfolio. • The current volatility of W is 10%. • The manager wants to limit portfolio VaR to $200 million at the 99% confidence level. • Position X has a return volatility of 9% and a correlation with W equal to 0.7. • Position Y has a return volatility of 12% and a correlation with W equal to zero. • Determine which of the two proposed additions, X or Y, will keep the manager within his risk budget. 22 1 2 12 1 2 22 22 11 22 1 2 12 1 2 1 0 1 2 1 21 2 0 1 1 0 2 2 0 1 2 12 1 2 2 Pr : 2 () [ () ] [ () ] [ () ] 2 ] A A - A - -- VaR VaR VaR VaR VaR oof w w + ww c P cP w cP w + cP w w ρ σ σ σ ρ σσ σ σ σ ρ σσ = ++ + ⇒Φ = Φ⋅ + Φ⋅ Φ ⋅ = 目录 • 1. 回顾：组合的VaR • 2. 边际VaR和增量VaR • 3. 成份VaR • 4. 综合案例：边际VaR、增量VaR和成份VaR的应用 • 5. 组合风险预算 • 6. Matlab代码：边际VaR、增量VaR和成份VaR 6. Matlab代码：边际VaR、增量VaR和成份VaR • 用Matlab计算投资组合的边际VaR、成分VaR、增量VaR。 • Function [VaR, delta_VaR, incre_VaR, compo_VaR] =delta_compo_VaR(price, w, dw, condidence, V) %输入1：price为投资组合中各资产价格矩阵，M*N矩阵，N资产数，M观测数 %输入2：w为投资组合中各个资产的权重向量，列向量N*1向量 %输入3：dw为投资组合各个资产权重向量变化， 列向量N*1向量 %输入4：confidence为置信水平 %输入5：V为资产价值（今天） %输出1：VaR为资产的VaR 6. Matlab代码：边际VaR、增量VaR和成份VaR(续) • Function [VaR, delta_VaR, incre_VaR, compo_VaR] =delta_compo_VaR(price, w, dw, condidence, V) %输出2：delta_VaR为边际VaR %输出3：incre_VaR为增量VaR %输出4：compo_VaR为成分VaR %第一步，求解对数收益率矩阵 [M, N]=size(price) For i=1:N r(:,i)=diff(log(price:,i))) end 6. Matlab代码：边际VaR、增量VaR和成份VaR（续） %第一步，求解对数收益率矩阵 [M, N]=size(price) For i=1:N r(:,i)=diff(log(price:,i))) End %第二步，求解对数收益率的均值与方差 mu=w’*mean(r,1)’；%mu为投资组合资 产收益率的均值 cov_matrix=cov(r)；%cov_matrix为投资组 合收益率的方差-协方差矩阵 sigma=sqrt(w’*cov_matrix*w)；%sigma为投资组合收 益率的标准差 %第三步，在正态分布的假设下求解VaR alpha=1-confidence VaR=-[mu+norminv(alpha,0,1)*sigma]*V VaR=max(VaR,0) %第四步，求解边际VaR delta_VaR=- (mean(r,1)’+norminv(alpha,0,1)*cov_matrix*w/sigma) %第五步，求解增量VaR和成分VaR incre_VaR=delta_VaR’*dw*V compo_VaR=delta_VaR*w*V 本章结束","libVersion":"0.2.4","langs":""}