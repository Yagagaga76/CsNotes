{"path":"pdf/算法设计与分析/05-MergeSort.pdf","text":"M e r ge S ort A l gori t hm : D e s i gn & A na l ys i s [5] In t he l a s t c l a s s … ● Ins e rt i on s ort ● A na l ys i s of i ns e rt i on s ort i ng a l gori t hm ● L ow e r bound of l oc a l c om pa ri s on ba s e d s ort i ng a l gori t hm ● G e ne ra l pa t t e rn of di vi de -a nd-c onque r ● Q ui c ks ort ● A na l ys i s of Q ui c ks ort M e r ge s ort ● M e r ge s ort ● W ors t Ca s e A na l ys i s of M e r ge s ort ● L ow e r Bounds for S ort i ng by Com pa ri s on of K e ys ● W ors t Ca s e ● A ve ra ge Be ha vi or M e r ge S ort : t he S t ra t e gy ● E a s y di vi s i on ● N o c om pa ri s on i s done duri ng t he di vi s i on ● M i ni m i z i ng t he s i z e di f fe re nc e be t w e e n t he di vi de d s ubprobl e m s ● M e r gi ng t w o s ort e d s ubra nge s ● U s i ng Me r ge M e r gi ng S ort e d A rra ys A [0] A[ k -1] B[0] B[ m -1] M e r ge : t he S pe c i fi c a t i on ● Input : A rra y A w i t h k e l e m e nt s a nd B w i t h m e l e m e nt s , e a c h i n nonde c re a s i ng orde r of t he i r ke y . ● O ut put : C , a n a rra y c ont a i ni ng n = k + m e l e m e nt s from A a nd B i n nonde c re a s i ng orde r . C i s pa s s e d i n a nd t he a l gori t hm fi l l s i t . M e r ge : t he Re c urs i ve V e rs i on m e r ge ( A , B , C ) if ( A i s e m pt y) re s t of C = re s t of B e l s e i f ( B i s e m pt y) re s t of C = re s t of A else if (fi rs t of A \u0000 fi rs t of B ) fi rs t of C =fi rs t of A m e r ge (re s t of A , B , re s t of C ) else fi rs t of C =fi rs t of B m e r ge (A , re s t of B, re s t of C ) r e tu r n Ba s e c a s e s W ors t Ca s e Com pl e xi t y of M e r ge ● O bs e rva t i ons : ● A ft e r e a c h c om pa ri s on, one e l e m e nt i s i ns e rt e d i nt o A rra y C, at l e as t . ● A ft e r e nt e ri ng A rra y C, a n e l e m e nt w i l l ne ve r be c om pa re d a ga i n ● A ft e r t he l a s t c om pa ri s on, a t l e a s t t w o e l e m e nt s ha ve not ye t be e n m ove d t o A rra y C. S o a t m os t n -1 c om pa ri s ons a re done . ● W ors t c a s e i s t ha t t he l a s t c om pa ri s on i s c onduc t e d be t w e e n A [ k -1] a nd B[ m -1] ● In w ors t c a s e , n -1 c om pa ri s ons a re done , w he re n = k + m O pt i m a l i t y of M e r ge ● A ny a l gori t hm t o m e r ge t w o s ort e d a rra ys , e a c h c ont a i ni ng k = m = n / 2 e nt ri e s , by c om pa ri s on of ke ys , doe s a t l e a s t n -1 c om pa ri s ons i n t he w ors t c a s e . ● Choos e ke ys s o t ha t : b 0 <a 0 <b 1 < a 1 <...< b i < a i < b i +1 ,...,< b m -1 < a k-1 ● T he n t he a l gori t hm m us t c om pa re a i w i t h b i for e ve ry i i n [0, m -1], a nd m us t c om pa re a i w i t h b i +1 for e ve ry i i n [0, m -2], s o, t he re a re n -1 c om pa ri s ons . V a l i d for | k - m | \u0000 1, a s w e l l . S pa c e Com pl e xi t y of M e r ge ● A a l gori t hm i s “ i n s pa c e ” , i f t he e xt ra s pa c e i t ha s t o us e i s i n \u0000 (1) ● M e r ge i s n ot a a l gori t hm “ i n s pa c e ” , s i nc e i t ne e d e nough e xt ra s pa c e t o s t ore t he m e r ge d s e que nc e duri ng t he m e r gi ng proc e s s . O ve rl a ppi ng A rra ys for M e r ge 0 k -1 m -10 Be fore t he m e r ge k+m -1 A B M e r ge from t he ri ght 0 k -1 m -10k+m -1 0 k -1 m -10k+m -1 A/C F i ni s he d M e r ge d e xt ra s pa c e P a rt l y fi ni s he d M e r ge S ort ● Input : A rra y E a nd i nde xe s first , a nd l as t , s uc h t ha t t he e l e m e nt s of E [ i ] a re de fi ne d for first \u0000 i \u0000 l as t . ● O ut put : E [ first ],…,E [ l as t ] i s a s ort e d re a rra nge m e nt of t he s a m e e l e m e nt s . ● P roc e dure voi d m e r ge S ort (E l e m e nt [] E , int fi rs t , int l a s t ) if (fi rs t <l a s t ) int m i d=(fi rs t +l a s t )/ 2; m e r ge S ort (E , fi rs t , m i d); m e r ge S ort (E , m i d+1, l a s t ); m e r ge (E , fi rs t , m i d, l a s t ) r e tu r n A na l ys i s of M e r ge s ort ● T he re c urre nc e e qua t i on for M e r ge s ort ● W (n)=W ( \u0000 n/ 2 \u0000 )+W ( \u0000 n/ 2 \u0000 )+n-1 ● W (1)=0 W he re n =l a s t -fi rs t +1, t he s i z e of ra nge t o be s ort e d ● T he Mas t e r T he or e m a ppl i e s for t he e qua t i on, s o: W ( n ) \u0000 \u0000( n l og n ) k / 2 m a y be \u0000 k /2 \u0000 or \u0000 k /2 \u0000 Ba s e c a s e s oc c ur a t de pt h \u0000 l g(n+1) \u0000 -1 a nd \u0000 l g(n+1) \u0000 Re c urs i on T re e for M e r ge s ort T (n) n-1 T (n/ 2) n/ 2-1 T (n/ 8) n/ 8-1T (n/ 4) n/ 4-1 n-1 n-2 n-4 n-8 L e ve l 0 L e ve l 1 L e ve l 2 L e ve l 3 N ot e : nonre c urs i ve c os t s on l e ve l k is n -2 k for a l l l e ve l w i t hout ba s e c a s e node N on-c om pl e t e Re c urs i ve T re e B ba s e -c a s e node s on t he s e c ond l ow e s t l e ve l n - B ba s e -c a s e node s N o nonba s e -c a s e node s a t t hi s de pt h 2 D -1 node s S i nc e e a c h nonba s e -c a s e node ha s 2 c hi l dre n, t he re a re ( n - B )/ 2 nonba s e -c a s e node s a t de pt h D -1 E x am pl e : n= 1 1 N um be r of Com pa ri s on of M e r ge s ort ● T he m a xi m um de pt h D of t he re c urs i ve t re e i s \u0000 l g(n+1) \u0000 . ● Let B ba s e c a s e node s on de pt h D -1, a nd n - B on de pt h D , (N ot e : ba s e c a s e node ha s nonre c urs i ve c os t 0). ● ( n - B )/ 2 nonba s e c a s e node s a t de pt h D -1, e a c h ha s nonre c urs i ve c os t 1. ● S o: ● \u0000\u0000 n l g(n )-n + 1 \u0000 \u0000 \u0000 \u0000 n u mb e r of c omp ar i s on \u0000 \u0000\u0000 \u0000 n l g(n )-0.914n \u0000\u0000 D e c i s i on T re e for S ort i ng A e xa m pl e for n=3 ● D e c i s i on t re e i s a 2-t re e .(A s s um i ng no s a m e ke ys ) ● T he a c t i on of S ort on a pa rt i c ul a r i nput c orre s ponds t o fol l ow i ng on pa t h i n i t s de c i s i on t re e from t he root t o a l e a f a s s oc i a t e d t o t he s pe c i fi c out put Int e rna l node E xt e rna l node M e r ge S ort A l gori t hm : D e s i gn & A na l ys i s [5] In t he l a s t c l a s s … ● Ins e rt i on s ort ● A na l ys i s of i ns e rt i on s ort i ng a l gori t hm ● L ow e r bound of l oc a l c om pa ri s on ba s e d s ort i ng a l gori t hm ● G e ne ra l pa t t e rn of di vi de -a nd-c onque r ● Q ui c ks ort ● A na l ys i s of Q ui c ks ort M e r ge s ort ● M e r ge s ort ● W ors t Ca s e A na l ys i s of M e r ge s ort ● L ow e r Bounds for S ort i ng by Com pa ri s on of K e ys ● W ors t Ca s e ● A ve ra ge Be ha vi or M e r ge S ort : t he S t ra t e gy ● E a s y di vi s i on ● N o c om pa ri s on i s done duri ng t he di vi s i on ● M i ni m i z i ng t he s i z e di f fe re nc e be t w e e n t he di vi de d s ubprobl e m s ● M e r gi ng t w o s ort e d s ubra nge s ● U s i ng Me r ge M e r gi ng S ort e d A rra ys A [0] A[ k -1] B[0] B[ m -1] M e r ge : t he S pe c i fi c a t i on ● Input : A rra y A w i t h k e l e m e nt s a nd B w i t h m e l e m e nt s , e a c h i n nonde c re a s i ng orde r of t he i r ke y . ● O ut put : C , a n a rra y c ont a i ni ng n = k + m e l e m e nt s from A a nd B i n nonde c re a s i ng orde r . C i s pa s s e d i n a nd t he a l gori t hm fi l l s i t . M e r ge : t he Re c urs i ve V e rs i on m e r ge ( A , B , C ) if ( A i s e m pt y) re s t of C = re s t of B e l s e i f ( B i s e m pt y) re s t of C = re s t of A else if (fi rs t of A \u0000 fi rs t of B ) fi rs t of C =fi rs t of A m e r ge (re s t of A , B , re s t of C ) else fi rs t of C =fi rs t of B m e r ge (A , re s t of B, re s t of C ) r e tu r n Ba s e c a s e s W ors t Ca s e Com pl e xi t y of M e r ge ● O bs e rva t i ons : ● A ft e r e a c h c om pa ri s on, one e l e m e nt i s i ns e rt e d i nt o A rra y C, at l e as t . ● A ft e r e nt e ri ng A rra y C, a n e l e m e nt w i l l ne ve r be c om pa re d a ga i n ● A ft e r t he l a s t c om pa ri s on, a t l e a s t t w o e l e m e nt s ha ve not ye t be e n m ove d t o A rra y C. S o a t m os t n -1 c om pa ri s ons a re done . ● W ors t c a s e i s t ha t t he l a s t c om pa ri s on i s c onduc t e d be t w e e n A [ k -1] a nd B[ m -1] ● In w ors t c a s e , n -1 c om pa ri s ons a re done , w he re n = k + m O pt i m a l i t y of M e r ge ● A ny a l gori t hm t o m e r ge t w o s ort e d a rra ys , e a c h c ont a i ni ng k = m = n / 2 e nt ri e s , by c om pa ri s on of ke ys , doe s a t l e a s t n -1 c om pa ri s ons i n t he w ors t c a s e . ● Choos e ke ys s o t ha t : b 0 <a 0 <b 1 < a 1 <...< b i < a i < b i +1 ,...,< b m -1 < a k-1 ● T he n t he a l gori t hm m us t c om pa re a i w i t h b i for e ve ry i i n [0, m -1], a nd m us t c om pa re a i w i t h b i +1 for e ve ry i i n [0, m -2], s o, t he re a re n -1 c om pa ri s ons . V a l i d for | k - m | \u0000 1, a s w e l l . S pa c e Com pl e xi t y of M e r ge ● A a l gori t hm i s “ i n s pa c e ” , i f t he e xt ra s pa c e i t ha s t o us e i s i n \u0000 (1) ● M e r ge i s n ot a a l gori t hm “ i n s pa c e ” , s i nc e i t ne e d e nough e xt ra s pa c e t o s t ore t he m e r ge d s e que nc e duri ng t he m e r gi ng proc e s s . O ve rl a ppi ng A rra ys for M e r ge 0 k -1 m -10 Be fore t he m e r ge k+m -1 A B M e r ge from t he ri ght 0 k -1 m -10k+m -1 0 k -1 m -10k+m -1 A/C F i ni s he d M e r ge d e xt ra s pa c e P a rt l y fi ni s he d M e r ge S ort ● Input : A rra y E a nd i nde xe s first , a nd l as t , s uc h t ha t t he e l e m e nt s of E [ i ] a re de fi ne d for first \u0000 i \u0000 l as t . ● O ut put : E [ first ],…,E [ l as t ] i s a s ort e d re a rra nge m e nt of t he s a m e e l e m e nt s . ● P roc e dure voi d m e r ge S ort (E l e m e nt [] E , int fi rs t , int l a s t ) if (fi rs t <l a s t ) int m i d=(fi rs t +l a s t )/ 2; m e r ge S ort (E , fi rs t , m i d); m e r ge S ort (E , m i d+1, l a s t ); m e r ge (E , fi rs t , m i d, l a s t ) r e tu r n A na l ys i s of M e r ge s ort ● T he re c urre nc e e qua t i on for M e r ge s ort ● W (n)=W ( \u0000 n/ 2 \u0000 )+W ( \u0000 n/ 2 \u0000 )+n-1 ● W (1)=0 W he re n =l a s t -fi rs t +1, t he s i z e of ra nge t o be s ort e d ● T he Mas t e r T he or e m a ppl i e s for t he e qua t i on, s o: W ( n ) \u0000 \u0000( n l og n ) k / 2 m a y be \u0000 k /2 \u0000 or \u0000 k /2 \u0000 Ba s e c a s e s oc c ur a t de pt h \u0000 l g(n+1) \u0000 -1 a nd \u0000 l g(n+1) \u0000 Re c urs i on T re e for M e r ge s ort T (n) n-1 T (n/ 2) n/ 2-1 T (n/ 8) n/ 8-1T (n/ 4) n/ 4-1 n-1 n-2 n-4 n-8 L e ve l 0 L e ve l 1 L e ve l 2 L e ve l 3 N ot e : nonre c urs i ve c os t s on l e ve l k is n -2 k for a l l l e ve l w i t hout ba s e c a s e node N on-c om pl e t e Re c urs i ve T re e B ba s e -c a s e node s on t he s e c ond l ow e s t l e ve l n - B ba s e -c a s e node s N o nonba s e -c a s e node s a t t hi s de pt h 2 D -1 node s S i nc e e a c h nonba s e -c a s e node ha s 2 c hi l dre n, t he re a re ( n - B )/ 2 nonba s e -c a s e node s a t de pt h D -1 E x am pl e : n= 1 1 N um be r of Com pa ri s on of M e r ge s ort ● T he m a xi m um de pt h D of t he re c urs i ve t re e i s \u0000 l g(n+1) \u0000 . ● Let B ba s e c a s e node s on de pt h D -1, a nd n - B on de pt h D , (N ot e : ba s e c a s e node ha s nonre c urs i ve c os t 0). ● ( n - B )/ 2 nonba s e c a s e node s a t de pt h D -1, e a c h ha s nonre c urs i ve c os t 1. ● S o: ● \u0000\u0000 n l g(n )-n + 1 \u0000 \u0000 \u0000 \u0000 n u mb e r of c omp ar i s on \u0000 \u0000\u0000 \u0000 n l g(n )-0.914n \u0000\u0000 D e c i s i on T re e for S ort i ng A e xa m pl e for n=3 ● D e c i s i on t re e i s a 2-t re e .(A s s um i ng no s a m e ke ys ) ● T he a c t i on of S ort on a pa rt i c ul a r i nput c orre s ponds t o fol l ow i ng on pa t h i n i t s de c i s i on t re e from t he root t o a l e a f a s s oc i a t e d t o t he s pe c i fi c out put Int e rna l node E xt e rna l node M e r ge S ort A l gori t hm : D e s i gn & A na l ys i s [5] In t he l a s t c l a s s … ● Ins e rt i on s ort ● A na l ys i s of i ns e rt i on s ort i ng a l gori t hm ● L ow e r bound of l oc a l c om pa ri s on ba s e d s ort i ng a l gori t hm ● G e ne ra l pa t t e rn of di vi de -a nd-c onque r ● Q ui c ks ort ● A na l ys i s of Q ui c ks ort M e r ge s ort ● M e r ge s ort ● W ors t Ca s e A na l ys i s of M e r ge s ort ● L ow e r Bounds for S ort i ng by Com pa ri s on of K e ys ● W ors t Ca s e ● A ve ra ge Be ha vi or M e r ge S ort : t he S t ra t e gy ● E a s y di vi s i on ● N o c om pa ri s on i s done duri ng t he di vi s i on ● M i ni m i z i ng t he s i z e di f fe re nc e be t w e e n t he di vi de d s ubprobl e m s ● M e r gi ng t w o s ort e d s ubra nge s ● U s i ng Me r ge M e r gi ng S ort e d A rra ys A [0] A[ k -1] B[0] B[ m -1] M e r ge : t he S pe c i fi c a t i on ● Input : A rra y A w i t h k e l e m e nt s a nd B w i t h m e l e m e nt s , e a c h i n nonde c re a s i ng orde r of t he i r ke y . ● O ut put : C , a n a rra y c ont a i ni ng n = k + m e l e m e nt s from A a nd B i n nonde c re a s i ng orde r . C i s pa s s e d i n a nd t he a l gori t hm fi l l s i t . M e r ge : t he Re c urs i ve V e rs i on m e r ge ( A , B , C ) if ( A i s e m pt y) re s t of C = re s t of B e l s e i f ( B i s e m pt y) re s t of C = re s t of A else if (fi rs t of A \u0000 fi rs t of B ) fi rs t of C =fi rs t of A m e r ge (re s t of A , B , re s t of C ) else fi rs t of C =fi rs t of B m e r ge (A , re s t of B, re s t of C ) r e tu r n Ba s e c a s e s W ors t Ca s e Com pl e xi t y of M e r ge ● O bs e rva t i ons : ● A ft e r e a c h c om pa ri s on, one e l e m e nt i s i ns e rt e d i nt o A rra y C, at l e as t . ● A ft e r e nt e ri ng A rra y C, a n e l e m e nt w i l l ne ve r be c om pa re d a ga i n ● A ft e r t he l a s t c om pa ri s on, a t l e a s t t w o e l e m e nt s ha ve not ye t be e n m ove d t o A rra y C. S o a t m os t n -1 c om pa ri s ons a re done . ● W ors t c a s e i s t ha t t he l a s t c om pa ri s on i s c onduc t e d be t w e e n A [ k -1] a nd B[ m -1] ● In w ors t c a s e , n -1 c om pa ri s ons a re done , w he re n = k + m O pt i m a l i t y of M e r ge ● A ny a l gori t hm t o m e r ge t w o s ort e d a rra ys , e a c h c ont a i ni ng k = m = n / 2 e nt ri e s , by c om pa ri s on of ke ys , doe s a t l e a s t n -1 c om pa ri s ons i n t he w ors t c a s e . ● Choos e ke ys s o t ha t : b 0 <a 0 <b 1 < a 1 <...< b i < a i < b i +1 ,...,< b m -1 < a k-1 ● T he n t he a l gori t hm m us t c om pa re a i w i t h b i for e ve ry i i n [0, m -1], a nd m us t c om pa re a i w i t h b i +1 for e ve ry i i n [0, m -2], s o, t he re a re n -1 c om pa ri s ons . V a l i d for | k - m | \u0000 1, a s w e l l . S pa c e Com pl e xi t y of M e r ge ● A a l gori t hm i s “ i n s pa c e ” , i f t he e xt ra s pa c e i t ha s t o us e i s i n \u0000 (1) ● M e r ge i s n ot a a l gori t hm “ i n s pa c e ” , s i nc e i t ne e d e nough e xt ra s pa c e t o s t ore t he m e r ge d s e que nc e duri ng t he m e r gi ng proc e s s . O ve rl a ppi ng A rra ys for M e r ge 0 k -1 m -10 Be fore t he m e r ge k+m -1 A B M e r ge from t he ri ght 0 k -1 m -10k+m -1 0 k -1 m -10k+m -1 A/C F i ni s he d M e r ge d e xt ra s pa c e P a rt l y fi ni s he d M e r ge S ort ● Input : A rra y E a nd i nde xe s first , a nd l as t , s uc h t ha t t he e l e m e nt s of E [ i ] a re de fi ne d for first \u0000 i \u0000 l as t . ● O ut put : E [ first ],…,E [ l as t ] i s a s ort e d re a rra nge m e nt of t he s a m e e l e m e nt s . ● P roc e dure voi d m e r ge S ort (E l e m e nt [] E , int fi rs t , int l a s t ) if (fi rs t <l a s t ) int m i d=(fi rs t +l a s t )/ 2; m e r ge S ort (E , fi rs t , m i d); m e r ge S ort (E , m i d+1, l a s t ); m e r ge (E , fi rs t , m i d, l a s t ) r e tu r n A na l ys i s of M e r ge s ort ● T he re c urre nc e e qua t i on for M e r ge s ort ● W (n)=W ( \u0000 n/ 2 \u0000 )+W ( \u0000 n/ 2 \u0000 )+n-1 ● W (1)=0 W he re n =l a s t -fi rs t +1, t he s i z e of ra nge t o be s ort e d ● T he Mas t e r T he or e m a ppl i e s for t he e qua t i on, s o: W ( n ) \u0000 \u0000( n l og n ) k / 2 m a y be \u0000 k /2 \u0000 or \u0000 k /2 \u0000 Ba s e c a s e s oc c ur a t de pt h \u0000 l g(n+1) \u0000 -1 a nd \u0000 l g(n+1) \u0000 Re c urs i on T re e for M e r ge s ort T (n) n-1 T (n/ 2) n/ 2-1 T (n/ 8) n/ 8-1T (n/ 4) n/ 4-1 n-1 n-2 n-4 n-8 L e ve l 0 L e ve l 1 L e ve l 2 L e ve l 3 N ot e : nonre c urs i ve c os t s on l e ve l k is n -2 k for a l l l e ve l w i t hout ba s e c a s e node N on-c om pl e t e Re c urs i ve T re e B ba s e -c a s e node s on t he s e c ond l ow e s t l e ve l n - B ba s e -c a s e node s N o nonba s e -c a s e node s a t t hi s de pt h 2 D -1 node s S i nc e e a c h nonba s e -c a s e node ha s 2 c hi l dre n, t he re a re ( n - B )/ 2 nonba s e -c a s e node s a t de pt h D -1 E x am pl e : n= 1 1 N um be r of Com pa ri s on of M e r ge s ort ● T he m a xi m um de pt h D of t he re c urs i ve t re e i s \u0000 l g(n+1) \u0000 . ● Let B ba s e c a s e node s on de pt h D -1, a nd n - B on de pt h D , (N ot e : ba s e c a s e node ha s nonre c urs i ve c os t 0). ● ( n - B )/ 2 nonba s e c a s e node s a t de pt h D -1, e a c h ha s nonre c urs i ve c os t 1. ● S o: ● \u0000\u0000 n l g(n )-n + 1 \u0000 \u0000 \u0000 \u0000 n u mb e r of c omp ar i s on \u0000 \u0000\u0000 \u0000 n l g(n )-0.914n \u0000\u0000 D e c i s i on T re e for S ort i ng A e xa m pl e for n=3 ● D e c i s i on t re e i s a 2-t re e .(A s s um i ng no s a m e ke ys ) ● T he a c t i on of S ort on a pa rt i c ul a r i nput c orre s ponds t o fol l ow i ng on pa t h i n i t s de c i s i on t re e from t he root t o a l e a f a s s oc i a t e d t o t he s pe c i fi c out put Int e rna l node E xt e rna l node M e r ge S ort A l gori t hm : D e s i gn & A na l ys i s [5] In t he l a s t c l a s s … ● Ins e rt i on s ort ● A na l ys i s of i ns e rt i on s ort i ng a l gori t hm ● L ow e r bound of l oc a l c om pa ri s on ba s e d s ort i ng a l gori t hm ● G e ne ra l pa t t e rn of di vi de -a nd-c onque r ● Q ui c ks ort ● A na l ys i s of Q ui c ks ort M e r ge s ort ● M e r ge s ort ● W ors t Ca s e A na l ys i s of M e r ge s ort ● L ow e r Bounds for S ort i ng by Com pa ri s on of K e ys ● W ors t Ca s e ● A ve ra ge Be ha vi or M e r ge S ort : t he S t ra t e gy ● E a s y di vi s i on ● N o c om pa ri s on i s done duri ng t he di vi s i on ● M i ni m i z i ng t he s i z e di f fe re nc e be t w e e n t he di vi de d s ubprobl e m s ● M e r gi ng t w o s ort e d s ubra nge s ● U s i ng Me r ge M e r gi ng S ort e d A rra ys A [0] A[ k -1] B[0] B[ m -1] M e r ge : t he S pe c i fi c a t i on ● Input : A rra y A w i t h k e l e m e nt s a nd B w i t h m e l e m e nt s , e a c h i n nonde c re a s i ng orde r of t he i r ke y . ● O ut put : C , a n a rra y c ont a i ni ng n = k + m e l e m e nt s from A a nd B i n nonde c re a s i ng orde r . C i s pa s s e d i n a nd t he a l gori t hm fi l l s i t . M e r ge : t he Re c urs i ve V e rs i on m e r ge ( A , B , C ) if ( A i s e m pt y) re s t of C = re s t of B e l s e i f ( B i s e m pt y) re s t of C = re s t of A else if (fi rs t of A \u0000 fi rs t of B ) fi rs t of C =fi rs t of A m e r ge (re s t of A , B , re s t of C ) else fi rs t of C =fi rs t of B m e r ge (A , re s t of B, re s t of C ) r e tu r n Ba s e c a s e s W ors t Ca s e Com pl e xi t y of M e r ge ● O bs e rva t i ons : ● A ft e r e a c h c om pa ri s on, one e l e m e nt i s i ns e rt e d i nt o A rra y C, at l e as t . ● A ft e r e nt e ri ng A rra y C, a n e l e m e nt w i l l ne ve r be c om pa re d a ga i n ● A ft e r t he l a s t c om pa ri s on, a t l e a s t t w o e l e m e nt s ha ve not ye t be e n m ove d t o A rra y C. S o a t m os t n -1 c om pa ri s ons a re done . ● W ors t c a s e i s t ha t t he l a s t c om pa ri s on i s c onduc t e d be t w e e n A [ k -1] a nd B[ m -1] ● In w ors t c a s e , n -1 c om pa ri s ons a re done , w he re n = k + m O pt i m a l i t y of M e r ge ● A ny a l gori t hm t o m e r ge t w o s ort e d a rra ys , e a c h c ont a i ni ng k = m = n / 2 e nt ri e s , by c om pa ri s on of ke ys , doe s a t l e a s t n -1 c om pa ri s ons i n t he w ors t c a s e . ● Choos e ke ys s o t ha t : b 0 <a 0 <b 1 < a 1 <...< b i < a i < b i +1 ,...,< b m -1 < a k-1 ● T he n t he a l gori t hm m us t c om pa re a i w i t h b i for e ve ry i i n [0, m -1], a nd m us t c om pa re a i w i t h b i +1 for e ve ry i i n [0, m -2], s o, t he re a re n -1 c om pa ri s ons . V a l i d for | k - m | \u0000 1, a s w e l l . S pa c e Com pl e xi t y of M e r ge ● A a l gori t hm i s “ i n s pa c e ” , i f t he e xt ra s pa c e i t ha s t o us e i s i n \u0000 (1) ● M e r ge i s n ot a a l gori t hm “ i n s pa c e ” , s i nc e i t ne e d e nough e xt ra s pa c e t o s t ore t he m e r ge d s e que nc e duri ng t he m e r gi ng proc e s s . O ve rl a ppi ng A rra ys for M e r ge 0 k -1 m -10 Be fore t he m e r ge k+m -1 A B M e r ge from t he ri ght 0 k -1 m -10k+m -1 0 k -1 m -10k+m -1 A/C F i ni s he d M e r ge d e xt ra s pa c e P a rt l y fi ni s he d M e r ge S ort ● Input : A rra y E a nd i nde xe s first , a nd l as t , s uc h t ha t t he e l e m e nt s of E [ i ] a re de fi ne d for first \u0000 i \u0000 l as t . ● O ut put : E [ first ],…,E [ l as t ] i s a s ort e d re a rra nge m e nt of t he s a m e e l e m e nt s . ● P roc e dure voi d m e r ge S ort (E l e m e nt [] E , int fi rs t , int l a s t ) if (fi rs t <l a s t ) int m i d=(fi rs t +l a s t )/ 2; m e r ge S ort (E , fi rs t , m i d); m e r ge S ort (E , m i d+1, l a s t ); m e r ge (E , fi rs t , m i d, l a s t ) r e tu r n A na l ys i s of M e r ge s ort ● T he re c urre nc e e qua t i on for M e r ge s ort ● W (n)=W ( \u0000 n/ 2 \u0000 )+W ( \u0000 n/ 2 \u0000 )+n-1 ● W (1)=0 W he re n =l a s t -fi rs t +1, t he s i z e of ra nge t o be s ort e d ● T he Mas t e r T he or e m a ppl i e s for t he e qua t i on, s o: W ( n ) \u0000 \u0000( n l og n ) k / 2 m a y be \u0000 k /2 \u0000 or \u0000 k /2 \u0000 Ba s e c a s e s oc c ur a t de pt h \u0000 l g(n+1) \u0000 -1 a nd \u0000 l g(n+1) \u0000 Re c urs i on T re e for M e r ge s ort T (n) n-1 T (n/ 2) n/ 2-1 T (n/ 8) n/ 8-1T (n/ 4) n/ 4-1 n-1 n-2 n-4 n-8 L e ve l 0 L e ve l 1 L e ve l 2 L e ve l 3 N ot e : nonre c urs i ve c os t s on l e ve l k is n -2 k for a l l l e ve l w i t hout ba s e c a s e node N on-c om pl e t e Re c urs i ve T re e B ba s e -c a s e node s on t he s e c ond l ow e s t l e ve l n - B ba s e -c a s e node s N o nonba s e -c a s e node s a t t hi s de pt h 2 D -1 node s S i nc e e a c h nonba s e -c a s e node ha s 2 c hi l dre n, t he re a re ( n - B )/ 2 nonba s e -c a s e node s a t de pt h D -1 E x am pl e : n= 1 1 N um be r of Com pa ri s on of M e r ge s ort ● T he m a xi m um de pt h D of t he re c urs i ve t re e i s \u0000 l g(n+1) \u0000 . ● Let B ba s e c a s e node s on de pt h D -1, a nd n - B on de pt h D , (N ot e : ba s e c a s e node ha s nonre c urs i ve c os t 0). ● ( n - B )/ 2 nonba s e c a s e node s a t de pt h D -1, e a c h ha s nonre c urs i ve c os t 1. ● S o: ● \u0000\u0000 n l g(n )-n + 1 \u0000 \u0000 \u0000 \u0000 n u mb e r of c omp ar i s on \u0000 \u0000\u0000 \u0000 n l g(n )-0.914n \u0000\u0000 D e c i s i on T re e for S ort i ng A e xa m pl e for n=3 ● D e c i s i on t re e i s a 2-t re e .(A s s um i ng no s a m e ke ys ) ● T he a c t i on of S ort on a pa rt i c ul a r i nput c orre s ponds t o fol l ow i ng on pa t h i n i t s de c i s i on t re e from t he root t o a l e a f a s s oc i a t e d t o t he s pe c i fi c out put Int e rna l node E xt e rna l node M e r ge S ort A l gori t hm : D e s i gn & A na l ys i s [5] In t he l a s t c l a s s … ● Ins e rt i on s ort ● A na l ys i s of i ns e rt i on s ort i ng a l gori t hm ● L ow e r bound of l oc a l c om pa ri s on ba s e d s ort i ng a l gori t hm ● G e ne ra l pa t t e rn of di vi de -a nd-c onque r ● Q ui c ks ort ● A na l ys i s of Q ui c ks ort M e r ge s ort ● M e r ge s ort ● W ors t Ca s e A na l ys i s of M e r ge s ort ● L ow e r Bounds for S ort i ng by Com pa ri s on of K e ys ● W ors t Ca s e ● A ve ra ge Be ha vi or M e r ge S ort : t he S t ra t e gy ● E a s y di vi s i on ● N o c om pa ri s on i s done duri ng t he di vi s i on ● M i ni m i z i ng t he s i z e di f fe re nc e be t w e e n t he di vi de d s ubprobl e m s ● M e r gi ng t w o s ort e d s ubra nge s ● U s i ng Me r ge M e r gi ng S ort e d A rra ys A [0] A[ k -1] B[0] B[ m -1] M e r ge : t he S pe c i fi c a t i on ● Input : A rra y A w i t h k e l e m e nt s a nd B w i t h m e l e m e nt s , e a c h i n nonde c re a s i ng orde r of t he i r ke y . ● O ut put : C , a n a rra y c ont a i ni ng n = k + m e l e m e nt s from A a nd B i n nonde c re a s i ng orde r . C i s pa s s e d i n a nd t he a l gori t hm fi l l s i t . M e r ge : t he Re c urs i ve V e rs i on m e r ge ( A , B , C ) if ( A i s e m pt y) re s t of C = re s t of B e l s e i f ( B i s e m pt y) re s t of C = re s t of A else if (fi rs t of A \u0000 fi rs t of B ) fi rs t of C =fi rs t of A m e r ge (re s t of A , B , re s t of C ) else fi rs t of C =fi rs t of B m e r ge (A , re s t of B, re s t of C ) r e tu r n Ba s e c a s e s W ors t Ca s e Com pl e xi t y of M e r ge ● O bs e rva t i ons : ● A ft e r e a c h c om pa ri s on, one e l e m e nt i s i ns e rt e d i nt o A rra y C, at l e as t . ● A ft e r e nt e ri ng A rra y C, a n e l e m e nt w i l l ne ve r be c om pa re d a ga i n ● A ft e r t he l a s t c om pa ri s on, a t l e a s t t w o e l e m e nt s ha ve not ye t be e n m ove d t o A rra y C. S o a t m os t n -1 c om pa ri s ons a re done . ● W ors t c a s e i s t ha t t he l a s t c om pa ri s on i s c onduc t e d be t w e e n A [ k -1] a nd B[ m -1] ● In w ors t c a s e , n -1 c om pa ri s ons a re done , w he re n = k + m O pt i m a l i t y of M e r ge ● A ny a l gori t hm t o m e r ge t w o s ort e d a rra ys , e a c h c ont a i ni ng k = m = n / 2 e nt ri e s , by c om pa ri s on of ke ys , doe s a t l e a s t n -1 c om pa ri s ons i n t he w ors t c a s e . ● Choos e ke ys s o t ha t : b 0 <a 0 <b 1 < a 1 <...< b i < a i < b i +1 ,...,< b m -1 < a k-1 ● T he n t he a l gori t hm m us t c om pa re a i w i t h b i for e ve ry i i n [0, m -1], a nd m us t c om pa re a i w i t h b i +1 for e ve ry i i n [0, m -2], s o, t he re a re n -1 c om pa ri s ons . V a l i d for | k - m | \u0000 1, a s w e l l . S pa c e Com pl e xi t y of M e r ge ● A a l gori t hm i s “ i n s pa c e ” , i f t he e xt ra s pa c e i t ha s t o us e i s i n \u0000 (1) ● M e r ge i s n ot a a l gori t hm “ i n s pa c e ” , s i nc e i t ne e d e nough e xt ra s pa c e t o s t ore t he m e r ge d s e que nc e duri ng t he m e r gi ng proc e s s . O ve rl a ppi ng A rra ys for M e r ge 0 k -1 m -10 Be fore t he m e r ge k+m -1 A B M e r ge from t he ri ght 0 k -1 m -10k+m -1 0 k -1 m -10k+m -1 A/C F i ni s he d M e r ge d e xt ra s pa c e P a rt l y fi ni s he d M e r ge S ort ● Input : A rra y E a nd i nde xe s first , a nd l as t , s uc h t ha t t he e l e m e nt s of E [ i ] a re de fi ne d for first \u0000 i \u0000 l as t . ● O ut put : E [ first ],…,E [ l as t ] i s a s ort e d re a rra nge m e nt of t he s a m e e l e m e nt s . ● P roc e dure voi d m e r ge S ort (E l e m e nt [] E , int fi rs t , int l a s t ) if (fi rs t <l a s t ) int m i d=(fi rs t +l a s t )/ 2; m e r ge S ort (E , fi rs t , m i d); m e r ge S ort (E , m i d+1, l a s t ); m e r ge (E , fi rs t , m i d, l a s t ) r e tu r n A na l ys i s of M e r ge s ort ● T he re c urre nc e e qua t i on for M e r ge s ort ● W (n)=W ( \u0000 n/ 2 \u0000 )+W ( \u0000 n/ 2 \u0000 )+n-1 ● W (1)=0 W he re n =l a s t -fi rs t +1, t he s i z e of ra nge t o be s ort e d ● T he Mas t e r T he or e m a ppl i e s for t he e qua t i on, s o: W ( n ) \u0000 \u0000( n l og n ) k / 2 m a y be \u0000 k /2 \u0000 or \u0000 k /2 \u0000 Ba s e c a s e s oc c ur a t de pt h \u0000 l g(n+1) \u0000 -1 a nd \u0000 l g(n+1) \u0000 Re c urs i on T re e for M e r ge s ort T (n) n-1 T (n/ 2) n/ 2-1 T (n/ 8) n/ 8-1T (n/ 4) n/ 4-1 n-1 n-2 n-4 n-8 L e ve l 0 L e ve l 1 L e ve l 2 L e ve l 3 N ot e : nonre c urs i ve c os t s on l e ve l k is n -2 k for a l l l e ve l w i t hout ba s e c a s e node N on-c om pl e t e Re c urs i ve T re e B ba s e -c a s e node s on t he s e c ond l ow e s t l e ve l n - B ba s e -c a s e node s N o nonba s e -c a s e node s a t t hi s de pt h 2 D -1 node s S i nc e e a c h nonba s e -c a s e node ha s 2 c hi l dre n, t he re a re ( n - B )/ 2 nonba s e -c a s e node s a t de pt h D -1 E x am pl e : n= 1 1 N um be r of Com pa ri s on of M e r ge s ort ● T he m a xi m um de pt h D of t he re c urs i ve t re e i s \u0000 l g(n+1) \u0000 . ● Let B ba s e c a s e node s on de pt h D -1, a nd n - B on de pt h D , (N ot e : ba s e c a s e node ha s nonre c urs i ve c os t 0). ● ( n - B )/ 2 nonba s e c a s e node s a t de pt h D -1, e a c h ha s nonre c urs i ve c os t 1. ● S o: ● \u0000\u0000 n l g(n )-n + 1 \u0000 \u0000 \u0000 \u0000 n u mb e r of c omp ar i s on \u0000 \u0000\u0000 \u0000 n l g(n )-0.914n \u0000\u0000 D e c i s i on T re e for S ort i ng A e xa m pl e for n=3 ● D e c i s i on t re e i s a 2-t re e .(A s s um i ng no s a m e ke ys ) ● T he a c t i on of S ort on a pa rt i c ul a r i nput c orre s ponds t o fol l ow i ng on pa t h i n i t s de c i s i on t re e from t he root t o a l e a f a s s oc i a t e d t o t he s pe c i fi c out put Int e rna l node E xt e rna l node M e r ge S ort A l gori t hm : D e s i gn & A na l ys i s [5] In t he l a s t c l a s s … ● Ins e rt i on s ort ● A na l ys i s of i ns e rt i on s ort i ng a l gori t hm ● L ow e r bound of l oc a l c om pa ri s on ba s e d s ort i ng a l gori t hm ● G e ne ra l pa t t e rn of di vi de -a nd-c onque r ● Q ui c ks ort ● A na l ys i s of Q ui c ks ort M e r ge s ort ● M e r ge s ort ● W ors t Ca s e A na l ys i s of M e r ge s ort ● L ow e r Bounds for S ort i ng by Com pa ri s on of K e ys ● W ors t Ca s e ● A ve ra ge Be ha vi or M e r ge S ort : t he S t ra t e gy ● E a s y di vi s i on ● N o c om pa ri s on i s done duri ng t he di vi s i on ● M i ni m i z i ng t he s i z e di f fe re nc e be t w e e n t he di vi de d s ubprobl e m s ● M e r gi ng t w o s ort e d s ubra nge s ● U s i ng Me r ge M e r gi ng S ort e d A rra ys A [0] A[ k -1] B[0] B[ m -1] M e r ge : t he S pe c i fi c a t i on ● Input : A rra y A w i t h k e l e m e nt s a nd B w i t h m e l e m e nt s , e a c h i n nonde c re a s i ng orde r of t he i r ke y . ● O ut put : C , a n a rra y c ont a i ni ng n = k + m e l e m e nt s from A a nd B i n nonde c re a s i ng orde r . C i s pa s s e d i n a nd t he a l gori t hm fi l l s i t . M e r ge : t he Re c urs i ve V e rs i on m e r ge ( A , B , C ) if ( A i s e m pt y) re s t of C = re s t of B e l s e i f ( B i s e m pt y) re s t of C = re s t of A else if (fi rs t of A \u0000 fi rs t of B ) fi rs t of C =fi rs t of A m e r ge (re s t of A , B , re s t of C ) else fi rs t of C =fi rs t of B m e r ge (A , re s t of B, re s t of C ) r e tu r n Ba s e c a s e s W ors t Ca s e Com pl e xi t y of M e r ge ● O bs e rva t i ons : ● A ft e r e a c h c om pa ri s on, one e l e m e nt i s i ns e rt e d i nt o A rra y C, at l e as t . ● A ft e r e nt e ri ng A rra y C, a n e l e m e nt w i l l ne ve r be c om pa re d a ga i n ● A ft e r t he l a s t c om pa ri s on, a t l e a s t t w o e l e m e nt s ha ve not ye t be e n m ove d t o A rra y C. S o a t m os t n -1 c om pa ri s ons a re done . ● W ors t c a s e i s t ha t t he l a s t c om pa ri s on i s c onduc t e d be t w e e n A [ k -1] a nd B[ m -1] ● In w ors t c a s e , n -1 c om pa ri s ons a re done , w he re n = k + m O pt i m a l i t y of M e r ge ● A ny a l gori t hm t o m e r ge t w o s ort e d a rra ys , e a c h c ont a i ni ng k = m = n / 2 e nt ri e s , by c om pa ri s on of ke ys , doe s a t l e a s t n -1 c om pa ri s ons i n t he w ors t c a s e . ● Choos e ke ys s o t ha t : b 0 <a 0 <b 1 < a 1 <...< b i < a i < b i +1 ,...,< b m -1 < a k-1 ● T he n t he a l gori t hm m us t c om pa re a i w i t h b i for e ve ry i i n [0, m -1], a nd m us t c om pa re a i w i t h b i +1 for e ve ry i i n [0, m -2], s o, t he re a re n -1 c om pa ri s ons . V a l i d for | k - m | \u0000 1, a s w e l l . S pa c e Com pl e xi t y of M e r ge ● A a l gori t hm i s “ i n s pa c e ” , i f t he e xt ra s pa c e i t ha s t o us e i s i n \u0000 (1) ● M e r ge i s n ot a a l gori t hm “ i n s pa c e ” , s i nc e i t ne e d e nough e xt ra s pa c e t o s t ore t he m e r ge d s e que nc e duri ng t he m e r gi ng proc e s s . O ve rl a ppi ng A rra ys for M e r ge 0 k -1 m -10 Be fore t he m e r ge k+m -1 A B M e r ge from t he ri ght 0 k -1 m -10k+m -1 0 k -1 m -10k+m -1 A/C F i ni s he d M e r ge d e xt ra s pa c e P a rt l y fi ni s he d M e r ge S ort ● Input : A rra y E a nd i nde xe s first , a nd l as t , s uc h t ha t t he e l e m e nt s of E [ i ] a re de fi ne d for first \u0000 i \u0000 l as t . ● O ut put : E [ first ],…,E [ l as t ] i s a s ort e d re a rra nge m e nt of t he s a m e e l e m e nt s . ● P roc e dure voi d m e r ge S ort (E l e m e nt [] E , int fi rs t , int l a s t ) if (fi rs t <l a s t ) int m i d=(fi rs t +l a s t )/ 2; m e r ge S ort (E , fi rs t , m i d); m e r ge S ort (E , m i d+1, l a s t ); m e r ge (E , fi rs t , m i d, l a s t ) r e tu r n A na l ys i s of M e r ge s ort ● T he re c urre nc e e qua t i on for M e r ge s ort ● W (n)=W ( \u0000 n/ 2 \u0000 )+W ( \u0000 n/ 2 \u0000 )+n-1 ● W (1)=0 W he re n =l a s t -fi rs t +1, t he s i z e of ra nge t o be s ort e d ● T he Mas t e r T he or e m a ppl i e s for t he e qua t i on, s o: W ( n ) \u0000 \u0000( n l og n ) k / 2 m a y be \u0000 k /2 \u0000 or \u0000 k /2 \u0000 Ba s e c a s e s oc c ur a t de pt h \u0000 l g(n+1) \u0000 -1 a nd \u0000 l g(n+1) \u0000 Re c urs i on T re e for M e r ge s ort T (n) n-1 T (n/ 2) n/ 2-1 T (n/ 8) n/ 8-1T (n/ 4) n/ 4-1 n-1 n-2 n-4 n-8 L e ve l 0 L e ve l 1 L e ve l 2 L e ve l 3 N ot e : nonre c urs i ve c os t s on l e ve l k is n -2 k for a l l l e ve l w i t hout ba s e c a s e node N on-c om pl e t e Re c urs i ve T re e B ba s e -c a s e node s on t he s e c ond l ow e s t l e ve l n - B ba s e -c a s e node s N o nonba s e -c a s e node s a t t hi s de pt h 2 D -1 node s S i nc e e a c h nonba s e -c a s e node ha s 2 c hi l dre n, t he re a re ( n - B )/ 2 nonba s e -c a s e node s a t de pt h D -1 E x am pl e : n= 1 1 N um be r of Com pa ri s on of M e r ge s ort ● T he m a xi m um de pt h D of t he re c urs i ve t re e i s \u0000 l g(n+1) \u0000 . ● Let B ba s e c a s e node s on de pt h D -1, a nd n - B on de pt h D , (N ot e : ba s e c a s e node ha s nonre c urs i ve c os t 0). ● ( n - B )/ 2 nonba s e c a s e node s a t de pt h D -1, e a c h ha s nonre c urs i ve c os t 1. ● S o: ● \u0000\u0000 n l g(n )-n + 1 \u0000 \u0000 \u0000 \u0000 n u mb e r of c omp ar i s on \u0000 \u0000\u0000 \u0000 n l g(n )-0.914n \u0000\u0000 D e c i s i on T re e for S ort i ng A e xa m pl e for n=3 ● D e c i s i on t re e i s a 2-t re e .(A s s um i ng no s a m e ke ys ) ● T he a c t i on of S ort on a pa rt i c ul a r i nput c orre s ponds t o fol l ow i ng on pa t h i n i t s de c i s i on t re e from t he root t o a l e a f a s s oc i a t e d t o t he s pe c i fi c out put Int e rna l node E xt e rna l node 合并 有序 数组 M e r ge S ort A l gori t hm : D e s i gn & A na l ys i s [5] In t he l a s t c l a s s … ● Ins e rt i on s ort ● A na l ys i s of i ns e rt i on s ort i ng a l gori t hm ● L ow e r bound of l oc a l c om pa ri s on ba s e d s ort i ng a l gori t hm ● G e ne ra l pa t t e rn of di vi de -a nd-c onque r ● Q ui c ks ort ● A na l ys i s of Q ui c ks ort M e r ge s ort ● M e r ge s ort ● W ors t Ca s e A na l ys i s of M e r ge s ort ● L ow e r Bounds for S ort i ng by Com pa ri s on of K e ys ● W ors t Ca s e ● A ve ra ge Be ha vi or M e r ge S ort : t he S t ra t e gy ● E a s y di vi s i on ● N o c om pa ri s on i s done duri ng t he di vi s i on ● M i ni m i z i ng t he s i z e di f fe re nc e be t w e e n t he di vi de d s ubprobl e m s ● M e r gi ng t w o s ort e d s ubra nge s ● U s i ng Me r ge M e r gi ng S ort e d A rra ys A [0] A[ k -1] B[0] B[ m -1] M e r ge : t he S pe c i fi c a t i on ● Input : A rra y A w i t h k e l e m e nt s a nd B w i t h m e l e m e nt s , e a c h i n nonde c re a s i ng orde r of t he i r ke y . ● O ut put : C , a n a rra y c ont a i ni ng n = k + m e l e m e nt s from A a nd B i n nonde c re a s i ng orde r . C i s pa s s e d i n a nd t he a l gori t hm fi l l s i t . M e r ge : t he Re c urs i ve V e rs i on m e r ge ( A , B , C ) if ( A i s e m pt y) re s t of C = re s t of B e l s e i f ( B i s e m pt y) re s t of C = re s t of A else if (fi rs t of A \u0000 fi rs t of B ) fi rs t of C =fi rs t of A m e r ge (re s t of A , B , re s t of C ) else fi rs t of C =fi rs t of B m e r ge (A , re s t of B, re s t of C ) r e tu r n Ba s e c a s e s W ors t Ca s e Com pl e xi t y of M e r ge ● O bs e rva t i ons : ● A ft e r e a c h c om pa ri s on, one e l e m e nt i s i ns e rt e d i nt o A rra y C, at l e as t . ● A ft e r e nt e ri ng A rra y C, a n e l e m e nt w i l l ne ve r be c om pa re d a ga i n ● A ft e r t he l a s t c om pa ri s on, a t l e a s t t w o e l e m e nt s ha ve not ye t be e n m ove d t o A rra y C. S o a t m os t n -1 c om pa ri s ons a re done . ● W ors t c a s e i s t ha t t he l a s t c om pa ri s on i s c onduc t e d be t w e e n A [ k -1] a nd B[ m -1] ● In w ors t c a s e , n -1 c om pa ri s ons a re done , w he re n = k + m O pt i m a l i t y of M e r ge ● A ny a l gori t hm t o m e r ge t w o s ort e d a rra ys , e a c h c ont a i ni ng k = m = n / 2 e nt ri e s , by c om pa ri s on of ke ys , doe s a t l e a s t n -1 c om pa ri s ons i n t he w ors t c a s e . ● Choos e ke ys s o t ha t : b 0 <a 0 <b 1 < a 1 <...< b i < a i < b i +1 ,...,< b m -1 < a k-1 ● T he n t he a l gori t hm m us t c om pa re a i w i t h b i for e ve ry i i n [0, m -1], a nd m us t c om pa re a i w i t h b i +1 for e ve ry i i n [0, m -2], s o, t he re a re n -1 c om pa ri s ons . V a l i d for | k - m | \u0000 1, a s w e l l . S pa c e Com pl e xi t y of M e r ge ● A a l gori t hm i s “ i n s pa c e ” , i f t he e xt ra s pa c e i t ha s t o us e i s i n \u0000 (1) ● M e r ge i s n ot a a l gori t hm “ i n s pa c e ” , s i nc e i t ne e d e nough e xt ra s pa c e t o s t ore t he m e r ge d s e que nc e duri ng t he m e r gi ng proc e s s . O ve rl a ppi ng A rra ys for M e r ge 0 k -1 m -10 Be fore t he m e r ge k+m -1 A B M e r ge from t he ri ght 0 k -1 m -10k+m -1 0 k -1 m -10k+m -1 A/C F i ni s he d M e r ge d e xt ra s pa c e P a rt l y fi ni s he d M e r ge S ort ● Input : A rra y E a nd i nde xe s first , a nd l as t , s uc h t ha t t he e l e m e nt s of E [ i ] a re de fi ne d for first \u0000 i \u0000 l as t . ● O ut put : E [ first ],…,E [ l as t ] i s a s ort e d re a rra nge m e nt of t he s a m e e l e m e nt s . ● P roc e dure voi d m e r ge S ort (E l e m e nt [] E , int fi rs t , int l a s t ) if (fi rs t <l a s t ) int m i d=(fi rs t +l a s t )/ 2; m e r ge S ort (E , fi rs t , m i d); m e r ge S ort (E , m i d+1, l a s t ); m e r ge (E , fi rs t , m i d, l a s t ) r e tu r n A na l ys i s of M e r ge s ort ● T he re c urre nc e e qua t i on for M e r ge s ort ● W (n)=W ( \u0000 n/ 2 \u0000 )+W ( \u0000 n/ 2 \u0000 )+n-1 ● W (1)=0 W he re n =l a s t -fi rs t +1, t he s i z e of ra nge t o be s ort e d ● T he Mas t e r T he or e m a ppl i e s for t he e qua t i on, s o: W ( n ) \u0000 \u0000( n l og n ) k / 2 m a y be \u0000 k /2 \u0000 or \u0000 k /2 \u0000 Ba s e c a s e s oc c ur a t de pt h \u0000 l g(n+1) \u0000 -1 a nd \u0000 l g(n+1) \u0000 Re c urs i on T re e for M e r ge s ort T (n) n-1 T (n/ 2) n/ 2-1 T (n/ 8) n/ 8-1T (n/ 4) n/ 4-1 n-1 n-2 n-4 n-8 L e ve l 0 L e ve l 1 L e ve l 2 L e ve l 3 N ot e : nonre c urs i ve c os t s on l e ve l k is n -2 k for a l l l e ve l w i t hout ba s e c a s e node N on-c om pl e t e Re c urs i ve T re e B ba s e -c a s e node s on t he s e c ond l ow e s t l e ve l n - B ba s e -c a s e node s N o nonba s e -c a s e node s a t t hi s de pt h 2 D -1 node s S i nc e e a c h nonba s e -c a s e node ha s 2 c hi l dre n, t he re a re ( n - B )/ 2 nonba s e -c a s e node s a t de pt h D -1 E x am pl e : n= 1 1 N um be r of Com pa ri s on of M e r ge s ort ● T he m a xi m um de pt h D of t he re c urs i ve t re e i s \u0000 l g(n+1) \u0000 . ● Let B ba s e c a s e node s on de pt h D -1, a nd n - B on de pt h D , (N ot e : ba s e c a s e node ha s nonre c urs i ve c os t 0). ● ( n - B )/ 2 nonba s e c a s e node s a t de pt h D -1, e a c h ha s nonre c urs i ve c os t 1. ● S o: ● \u0000\u0000 n l g(n )-n + 1 \u0000 \u0000 \u0000 \u0000 n u mb e r of c omp ar i s on \u0000 \u0000\u0000 \u0000 n l g(n )-0.914n \u0000\u0000 D e c i s i on T re e for S ort i ng A e xa m pl e for n=3 ● D e c i s i on t re e i s a 2-t re e .(A s s um i ng no s a m e ke ys ) ● T he a c t i on of S ort on a pa rt i c ul a r i nput c orre s ponds t o fol l ow i ng on pa t h i n i t s de c i s i on t re e from t he root t o a l e a f a s s oc i a t e d t o t he s pe c i fi c out put Int e rna l node E xt e rna l node \" ) M e r ge S ort A l gori t hm : D e s i gn & A na l ys i s [5] In t he l a s t c l a s s … ● Ins e rt i on s ort ● A na l ys i s of i ns e rt i on s ort i ng a l gori t hm ● L ow e r bound of l oc a l c om pa ri s on ba s e d s ort i ng a l gori t hm ● G e ne ra l pa t t e rn of di vi de -a nd-c onque r ● Q ui c ks ort ● A na l ys i s of Q ui c ks ort M e r ge s ort ● M e r ge s ort ● W ors t Ca s e A na l ys i s of M e r ge s ort ● L ow e r Bounds for S ort i ng by Com pa ri s on of K e ys ● W ors t Ca s e ● A ve ra ge Be ha vi or M e r ge S ort : t he S t ra t e gy ● E a s y di vi s i on ● N o c om pa ri s on i s done duri ng t he di vi s i on ● M i ni m i z i ng t he s i z e di f fe re nc e be t w e e n t he di vi de d s ubprobl e m s ● M e r gi ng t w o s ort e d s ubra nge s ● U s i ng Me r ge M e r gi ng S ort e d A rra ys A [0] A[ k -1] B[0] B[ m -1] M e r ge : t he S pe c i fi c a t i on ● Input : A rra y A w i t h k e l e m e nt s a nd B w i t h m e l e m e nt s , e a c h i n nonde c re a s i ng orde r of t he i r ke y . ● O ut put : C , a n a rra y c ont a i ni ng n = k + m e l e m e nt s from A a nd B i n nonde c re a s i ng orde r . C i s pa s s e d i n a nd t he a l gori t hm fi l l s i t . M e r ge : t he Re c urs i ve V e rs i on m e r ge ( A , B , C ) if ( A i s e m pt y) re s t of C = re s t of B e l s e i f ( B i s e m pt y) re s t of C = re s t of A else if (fi rs t of A \u0000 fi rs t of B ) fi rs t of C =fi rs t of A m e r ge (re s t of A , B , re s t of C ) else fi rs t of C =fi rs t of B m e r ge (A , re s t of B, re s t of C ) r e tu r n Ba s e c a s e s W ors t Ca s e Com pl e xi t y of M e r ge ● O bs e rva t i ons : ● A ft e r e a c h c om pa ri s on, one e l e m e nt i s i ns e rt e d i nt o A rra y C, at l e as t . ● A ft e r e nt e ri ng A rra y C, a n e l e m e nt w i l l ne ve r be c om pa re d a ga i n ● A ft e r t he l a s t c om pa ri s on, a t l e a s t t w o e l e m e nt s ha ve not ye t be e n m ove d t o A rra y C. S o a t m os t n -1 c om pa ri s ons a re done . ● W ors t c a s e i s t ha t t he l a s t c om pa ri s on i s c onduc t e d be t w e e n A [ k -1] a nd B[ m -1] ● In w ors t c a s e , n -1 c om pa ri s ons a re done , w he re n = k + m O pt i m a l i t y of M e r ge ● A ny a l gori t hm t o m e r ge t w o s ort e d a rra ys , e a c h c ont a i ni ng k = m = n / 2 e nt ri e s , by c om pa ri s on of ke ys , doe s a t l e a s t n -1 c om pa ri s ons i n t he w ors t c a s e . ● Choos e ke ys s o t ha t : b 0 <a 0 <b 1 < a 1 <...< b i < a i < b i +1 ,...,< b m -1 < a k-1 ● T he n t he a l gori t hm m us t c om pa re a i w i t h b i for e ve ry i i n [0, m -1], a nd m us t c om pa re a i w i t h b i +1 for e ve ry i i n [0, m -2], s o, t he re a re n -1 c om pa ri s ons . V a l i d for | k - m | \u0000 1, a s w e l l . S pa c e Com pl e xi t y of M e r ge ● A a l gori t hm i s “ i n s pa c e ” , i f t he e xt ra s pa c e i t ha s t o us e i s i n \u0000 (1) ● M e r ge i s n ot a a l gori t hm “ i n s pa c e ” , s i nc e i t ne e d e nough e xt ra s pa c e t o s t ore t he m e r ge d s e que nc e duri ng t he m e r gi ng proc e s s . O ve rl a ppi ng A rra ys for M e r ge 0 k -1 m -10 Be fore t he m e r ge k+m -1 A B M e r ge from t he ri ght 0 k -1 m -10k+m -1 0 k -1 m -10k+m -1 A/C F i ni s he d M e r ge d e xt ra s pa c e P a rt l y fi ni s he d M e r ge S ort ● Input : A rra y E a nd i nde xe s first , a nd l as t , s uc h t ha t t he e l e m e nt s of E [ i ] a re de fi ne d for first \u0000 i \u0000 l as t . ● O ut put : E [ first ],…,E [ l as t ] i s a s ort e d re a rra nge m e nt of t he s a m e e l e m e nt s . ● P roc e dure voi d m e r ge S ort (E l e m e nt [] E , int fi rs t , int l a s t ) if (fi rs t <l a s t ) int m i d=(fi rs t +l a s t )/ 2; m e r ge S ort (E , fi rs t , m i d); m e r ge S ort (E , m i d+1, l a s t ); m e r ge (E , fi rs t , m i d, l a s t ) r e tu r n A na l ys i s of M e r ge s ort ● T he re c urre nc e e qua t i on for M e r ge s ort ● W (n)=W ( \u0000 n/ 2 \u0000 )+W ( \u0000 n/ 2 \u0000 )+n-1 ● W (1)=0 W he re n =l a s t -fi rs t +1, t he s i z e of ra nge t o be s ort e d ● T he Mas t e r T he or e m a ppl i e s for t he e qua t i on, s o: W ( n ) \u0000 \u0000( n l og n ) k / 2 m a y be \u0000 k /2 \u0000 or \u0000 k /2 \u0000 Ba s e c a s e s oc c ur a t de pt h \u0000 l g(n+1) \u0000 -1 a nd \u0000 l g(n+1) \u0000 Re c urs i on T re e for M e r ge s ort T (n) n-1 T (n/ 2) n/ 2-1 T (n/ 8) n/ 8-1T (n/ 4) n/ 4-1 n-1 n-2 n-4 n-8 L e ve l 0 L e ve l 1 L e ve l 2 L e ve l 3 N ot e : nonre c urs i ve c os t s on l e ve l k is n -2 k for a l l l e ve l w i t hout ba s e c a s e node N on-c om pl e t e Re c urs i ve T re e B ba s e -c a s e node s on t he s e c ond l ow e s t l e ve l n - B ba s e -c a s e node s N o nonba s e -c a s e node s a t t hi s de pt h 2 D -1 node s S i nc e e a c h nonba s e -c a s e node ha s 2 c hi l dre n, t he re a re ( n - B )/ 2 nonba s e -c a s e node s a t de pt h D -1 E x am pl e : n= 1 1 N um be r of Com pa ri s on of M e r ge s ort ● T he m a xi m um de pt h D of t he re c urs i ve t re e i s \u0000 l g(n+1) \u0000 . ● Let B ba s e c a s e node s on de pt h D -1, a nd n - B on de pt h D , (N ot e : ba s e c a s e node ha s nonre c urs i ve c os t 0). ● ( n - B )/ 2 nonba s e c a s e node s a t de pt h D -1, e a c h ha s nonre c urs i ve c os t 1. ● S o: ● \u0000\u0000 n l g(n )-n + 1 \u0000 \u0000 \u0000 \u0000 n u mb e r of c omp ar i s on \u0000 \u0000\u0000 \u0000 n l g(n )-0.914n \u0000\u0000 D e c i s i on T re e for S ort i ng A e xa m pl e for n=3 ● D e c i s i on t re e i s a 2-t re e .(A s s um i ng no s a m e ke ys ) ● T he a c t i on of S ort on a pa rt i c ul a r i nput c orre s ponds t o fol l ow i ng on pa t h i n i t s de c i s i on t re e from t he root t o a l e a f a s s oc i a t e d t o t he s pe c i fi c out put Int e rna l node E xt e rna l node l ^ 即 意 批量 导⼊ , ⼀次 1 只 插⼊ ⼀个 元 末 - - 即 ktm -1 M e r ge S ort A l gori t hm : D e s i gn & A na l ys i s [5] In t he l a s t c l a s s … ● Ins e rt i on s ort ● A na l ys i s of i ns e rt i on s ort i ng a l gori t hm ● L ow e r bound of l oc a l c om pa ri s on ba s e d s ort i ng a l gori t hm ● G e ne ra l pa t t e rn of di vi de -a nd-c onque r ● Q ui c ks ort ● A na l ys i s of Q ui c ks ort M e r ge s ort ● M e r ge s ort ● W ors t Ca s e A na l ys i s of M e r ge s ort ● L ow e r Bounds for S ort i ng by Com pa ri s on of K e ys ● W ors t Ca s e ● A ve ra ge Be ha vi or M e r ge S ort : t he S t ra t e gy ● E a s y di vi s i on ● N o c om pa ri s on i s done duri ng t he di vi s i on ● M i ni m i z i ng t he s i z e di f fe re nc e be t w e e n t he di vi de d s ubprobl e m s ● M e r gi ng t w o s ort e d s ubra nge s ● U s i ng Me r ge M e r gi ng S ort e d A rra ys A [0] A[ k -1] B[0] B[ m -1] M e r ge : t he S pe c i fi c a t i on ● Input : A rra y A w i t h k e l e m e nt s a nd B w i t h m e l e m e nt s , e a c h i n nonde c re a s i ng orde r of t he i r ke y . ● O ut put : C , a n a rra y c ont a i ni ng n = k + m e l e m e nt s from A a nd B i n nonde c re a s i ng orde r . C i s pa s s e d i n a nd t he a l gori t hm fi l l s i t . M e r ge : t he Re c urs i ve V e rs i on m e r ge ( A , B , C ) if ( A i s e m pt y) re s t of C = re s t of B e l s e i f ( B i s e m pt y) re s t of C = re s t of A else if (fi rs t of A \u0000 fi rs t of B ) fi rs t of C =fi rs t of A m e r ge (re s t of A , B , re s t of C ) else fi rs t of C =fi rs t of B m e r ge (A , re s t of B, re s t of C ) r e tu r n Ba s e c a s e s W ors t Ca s e Com pl e xi t y of M e r ge ● O bs e rva t i ons : ● A ft e r e a c h c om pa ri s on, one e l e m e nt i s i ns e rt e d i nt o A rra y C, at l e as t . ● A ft e r e nt e ri ng A rra y C, a n e l e m e nt w i l l ne ve r be c om pa re d a ga i n ● A ft e r t he l a s t c om pa ri s on, a t l e a s t t w o e l e m e nt s ha ve not ye t be e n m ove d t o A rra y C. S o a t m os t n -1 c om pa ri s ons a re done . ● W ors t c a s e i s t ha t t he l a s t c om pa ri s on i s c onduc t e d be t w e e n A [ k -1] a nd B[ m -1] ● In w ors t c a s e , n -1 c om pa ri s ons a re done , w he re n = k + m O pt i m a l i t y of M e r ge ● A ny a l gori t hm t o m e r ge t w o s ort e d a rra ys , e a c h c ont a i ni ng k = m = n / 2 e nt ri e s , by c om pa ri s on of ke ys , doe s a t l e a s t n -1 c om pa ri s ons i n t he w ors t c a s e . ● Choos e ke ys s o t ha t : b 0 <a 0 <b 1 < a 1 <...< b i < a i < b i +1 ,...,< b m -1 < a k-1 ● T he n t he a l gori t hm m us t c om pa re a i w i t h b i for e ve ry i i n [0, m -1], a nd m us t c om pa re a i w i t h b i +1 for e ve ry i i n [0, m -2], s o, t he re a re n -1 c om pa ri s ons . V a l i d for | k - m | \u0000 1, a s w e l l . S pa c e Com pl e xi t y of M e r ge ● A a l gori t hm i s “ i n s pa c e ” , i f t he e xt ra s pa c e i t ha s t o us e i s i n \u0000 (1) ● M e r ge i s n ot a a l gori t hm “ i n s pa c e ” , s i nc e i t ne e d e nough e xt ra s pa c e t o s t ore t he m e r ge d s e que nc e duri ng t he m e r gi ng proc e s s . O ve rl a ppi ng A rra ys for M e r ge 0 k -1 m -10 Be fore t he m e r ge k+m -1 A B M e r ge from t he ri ght 0 k -1 m -10k+m -1 0 k -1 m -10k+m -1 A/C F i ni s he d M e r ge d e xt ra s pa c e P a rt l y fi ni s he d M e r ge S ort ● Input : A rra y E a nd i nde xe s first , a nd l as t , s uc h t ha t t he e l e m e nt s of E [ i ] a re de fi ne d for first \u0000 i \u0000 l as t . ● O ut put : E [ first ],…,E [ l as t ] i s a s ort e d re a rra nge m e nt of t he s a m e e l e m e nt s . ● P roc e dure voi d m e r ge S ort (E l e m e nt [] E , int fi rs t , int l a s t ) if (fi rs t <l a s t ) int m i d=(fi rs t +l a s t )/ 2; m e r ge S ort (E , fi rs t , m i d); m e r ge S ort (E , m i d+1, l a s t ); m e r ge (E , fi rs t , m i d, l a s t ) r e tu r n A na l ys i s of M e r ge s ort ● T he re c urre nc e e qua t i on for M e r ge s ort ● W (n)=W ( \u0000 n/ 2 \u0000 )+W ( \u0000 n/ 2 \u0000 )+n-1 ● W (1)=0 W he re n =l a s t -fi rs t +1, t he s i z e of ra nge t o be s ort e d ● T he Mas t e r T he or e m a ppl i e s for t he e qua t i on, s o: W ( n ) \u0000 \u0000( n l og n ) k / 2 m a y be \u0000 k /2 \u0000 or \u0000 k /2 \u0000 Ba s e c a s e s oc c ur a t de pt h \u0000 l g(n+1) \u0000 -1 a nd \u0000 l g(n+1) \u0000 Re c urs i on T re e for M e r ge s ort T (n) n-1 T (n/ 2) n/ 2-1 T (n/ 8) n/ 8-1T (n/ 4) n/ 4-1 n-1 n-2 n-4 n-8 L e ve l 0 L e ve l 1 L e ve l 2 L e ve l 3 N ot e : nonre c urs i ve c os t s on l e ve l k is n -2 k for a l l l e ve l w i t hout ba s e c a s e node N on-c om pl e t e Re c urs i ve T re e B ba s e -c a s e node s on t he s e c ond l ow e s t l e ve l n - B ba s e -c a s e node s N o nonba s e -c a s e node s a t t hi s de pt h 2 D -1 node s S i nc e e a c h nonba s e -c a s e node ha s 2 c hi l dre n, t he re a re ( n - B )/ 2 nonba s e -c a s e node s a t de pt h D -1 E x am pl e : n= 1 1 N um be r of Com pa ri s on of M e r ge s ort ● T he m a xi m um de pt h D of t he re c urs i ve t re e i s \u0000 l g(n+1) \u0000 . ● Let B ba s e c a s e node s on de pt h D -1, a nd n - B on de pt h D , (N ot e : ba s e c a s e node ha s nonre c urs i ve c os t 0). ● ( n - B )/ 2 nonba s e c a s e node s a t de pt h D -1, e a c h ha s nonre c urs i ve c os t 1. ● S o: ● \u0000\u0000 n l g(n )-n + 1 \u0000 \u0000 \u0000 \u0000 n u mb e r of c omp ar i s on \u0000 \u0000\u0000 \u0000 n l g(n )-0.914n \u0000\u0000 D e c i s i on T re e for S ort i ng A e xa m pl e for n=3 ● D e c i s i on t re e i s a 2-t re e .(A s s um i ng no s a m e ke ys ) ● T he a c t i on of S ort on a pa rt i c ul a r i nput c orre s ponds t o fol l ow i ng on pa t h i n i t s de c i s i on t re e from t he root t o a l e a f a s s oc i a t e d t o t he s pe c i fi c out put Int e rna l node E xt e rna l node = M e r ge S ort A l gori t hm : D e s i gn & A na l ys i s [5] In t he l a s t c l a s s … ● Ins e rt i on s ort ● A na l ys i s of i ns e rt i on s ort i ng a l gori t hm ● L ow e r bound of l oc a l c om pa ri s on ba s e d s ort i ng a l gori t hm ● G e ne ra l pa t t e rn of di vi de -a nd-c onque r ● Q ui c ks ort ● A na l ys i s of Q ui c ks ort M e r ge s ort ● M e r ge s ort ● W ors t Ca s e A na l ys i s of M e r ge s ort ● L ow e r Bounds for S ort i ng by Com pa ri s on of K e ys ● W ors t Ca s e ● A ve ra ge Be ha vi or M e r ge S ort : t he S t ra t e gy ● E a s y di vi s i on ● N o c om pa ri s on i s done duri ng t he di vi s i on ● M i ni m i z i ng t he s i z e di f fe re nc e be t w e e n t he di vi de d s ubprobl e m s ● M e r gi ng t w o s ort e d s ubra nge s ● U s i ng Me r ge M e r gi ng S ort e d A rra ys A [0] A[ k -1] B[0] B[ m -1] M e r ge : t he S pe c i fi c a t i on ● Input : A rra y A w i t h k e l e m e nt s a nd B w i t h m e l e m e nt s , e a c h i n nonde c re a s i ng orde r of t he i r ke y . ● O ut put : C , a n a rra y c ont a i ni ng n = k + m e l e m e nt s from A a nd B i n nonde c re a s i ng orde r . C i s pa s s e d i n a nd t he a l gori t hm fi l l s i t . M e r ge : t he Re c urs i ve V e rs i on m e r ge ( A , B , C ) if ( A i s e m pt y) re s t of C = re s t of B e l s e i f ( B i s e m pt y) re s t of C = re s t of A else if (fi rs t of A \u0000 fi rs t of B ) fi rs t of C =fi rs t of A m e r ge (re s t of A , B , re s t of C ) else fi rs t of C =fi rs t of B m e r ge (A , re s t of B, re s t of C ) r e tu r n Ba s e c a s e s W ors t Ca s e Com pl e xi t y of M e r ge ● O bs e rva t i ons : ● A ft e r e a c h c om pa ri s on, one e l e m e nt i s i ns e rt e d i nt o A rra y C, at l e as t . ● A ft e r e nt e ri ng A rra y C, a n e l e m e nt w i l l ne ve r be c om pa re d a ga i n ● A ft e r t he l a s t c om pa ri s on, a t l e a s t t w o e l e m e nt s ha ve not ye t be e n m ove d t o A rra y C. S o a t m os t n -1 c om pa ri s ons a re done . ● W ors t c a s e i s t ha t t he l a s t c om pa ri s on i s c onduc t e d be t w e e n A [ k -1] a nd B[ m -1] ● In w ors t c a s e , n -1 c om pa ri s ons a re done , w he re n = k + m O pt i m a l i t y of M e r ge ● A ny a l gori t hm t o m e r ge t w o s ort e d a rra ys , e a c h c ont a i ni ng k = m = n / 2 e nt ri e s , by c om pa ri s on of ke ys , doe s a t l e a s t n -1 c om pa ri s ons i n t he w ors t c a s e . ● Choos e ke ys s o t ha t : b 0 <a 0 <b 1 < a 1 <...< b i < a i < b i +1 ,...,< b m -1 < a k-1 ● T he n t he a l gori t hm m us t c om pa re a i w i t h b i for e ve ry i i n [0, m -1], a nd m us t c om pa re a i w i t h b i +1 for e ve ry i i n [0, m -2], s o, t he re a re n -1 c om pa ri s ons . V a l i d for | k - m | \u0000 1, a s w e l l . S pa c e Com pl e xi t y of M e r ge ● A a l gori t hm i s “ i n s pa c e ” , i f t he e xt ra s pa c e i t ha s t o us e i s i n \u0000 (1) ● M e r ge i s n ot a a l gori t hm “ i n s pa c e ” , s i nc e i t ne e d e nough e xt ra s pa c e t o s t ore t he m e r ge d s e que nc e duri ng t he m e r gi ng proc e s s . O ve rl a ppi ng A rra ys for M e r ge 0 k -1 m -10 Be fore t he m e r ge k+m -1 A B M e r ge from t he ri ght 0 k -1 m -10k+m -1 0 k -1 m -10k+m -1 A/C F i ni s he d M e r ge d e xt ra s pa c e P a rt l y fi ni s he d M e r ge S ort ● Input : A rra y E a nd i nde xe s first , a nd l as t , s uc h t ha t t he e l e m e nt s of E [ i ] a re de fi ne d for first \u0000 i \u0000 l as t . ● O ut put : E [ first ],…,E [ l as t ] i s a s ort e d re a rra nge m e nt of t he s a m e e l e m e nt s . ● P roc e dure voi d m e r ge S ort (E l e m e nt [] E , int fi rs t , int l a s t ) if (fi rs t <l a s t ) int m i d=(fi rs t +l a s t )/ 2; m e r ge S ort (E , fi rs t , m i d); m e r ge S ort (E , m i d+1, l a s t ); m e r ge (E , fi rs t , m i d, l a s t ) r e tu r n A na l ys i s of M e r ge s ort ● T he re c urre nc e e qua t i on for M e r ge s ort ● W (n)=W ( \u0000 n/ 2 \u0000 )+W ( \u0000 n/ 2 \u0000 )+n-1 ● W (1)=0 W he re n =l a s t -fi rs t +1, t he s i z e of ra nge t o be s ort e d ● T he Mas t e r T he or e m a ppl i e s for t he e qua t i on, s o: W ( n ) \u0000 \u0000( n l og n ) k / 2 m a y be \u0000 k /2 \u0000 or \u0000 k /2 \u0000 Ba s e c a s e s oc c ur a t de pt h \u0000 l g(n+1) \u0000 -1 a nd \u0000 l g(n+1) \u0000 Re c urs i on T re e for M e r ge s ort T (n) n-1 T (n/ 2) n/ 2-1 T (n/ 8) n/ 8-1T (n/ 4) n/ 4-1 n-1 n-2 n-4 n-8 L e ve l 0 L e ve l 1 L e ve l 2 L e ve l 3 N ot e : nonre c urs i ve c os t s on l e ve l k is n -2 k for a l l l e ve l w i t hout ba s e c a s e node N on-c om pl e t e Re c urs i ve T re e B ba s e -c a s e node s on t he s e c ond l ow e s t l e ve l n - B ba s e -c a s e node s N o nonba s e -c a s e node s a t t hi s de pt h 2 D -1 node s S i nc e e a c h nonba s e -c a s e node ha s 2 c hi l dre n, t he re a re ( n - B )/ 2 nonba s e -c a s e node s a t de pt h D -1 E x am pl e : n= 1 1 N um be r of Com pa ri s on of M e r ge s ort ● T he m a xi m um de pt h D of t he re c urs i ve t re e i s \u0000 l g(n+1) \u0000 . ● Let B ba s e c a s e node s on de pt h D -1, a nd n - B on de pt h D , (N ot e : ba s e c a s e node ha s nonre c urs i ve c os t 0). ● ( n - B )/ 2 nonba s e c a s e node s a t de pt h D -1, e a c h ha s nonre c urs i ve c os t 1. ● S o: ● \u0000\u0000 n l g(n )-n + 1 \u0000 \u0000 \u0000 \u0000 n u mb e r of c omp ar i s on \u0000 \u0000\u0000 \u0000 n l g(n )-0.914n \u0000\u0000 D e c i s i on T re e for S ort i ng A e xa m pl e for n=3 ● D e c i s i on t re e i s a 2-t re e .(A s s um i ng no s a m e ke ys ) ● T he a c t i on of S ort on a pa rt i c ul a r i nput c orre s ponds t o fol l ow i ng on pa t h i n i t s de c i s i on t re e from t he root t o a l e a f a s s oc i a t e d t o t he s pe c i fi c out put Int e rna l node E xt e rna l node ④ M e r ge S ort A l gori t hm : D e s i gn & A na l ys i s [5] In t he l a s t c l a s s … ● Ins e rt i on s ort ● A na l ys i s of i ns e rt i on s ort i ng a l gori t hm ● L ow e r bound of l oc a l c om pa ri s on ba s e d s ort i ng a l gori t hm ● G e ne ra l pa t t e rn of di vi de -a nd-c onque r ● Q ui c ks ort ● A na l ys i s of Q ui c ks ort M e r ge s ort ● M e r ge s ort ● W ors t Ca s e A na l ys i s of M e r ge s ort ● L ow e r Bounds for S ort i ng by Com pa ri s on of K e ys ● W ors t Ca s e ● A ve ra ge Be ha vi or M e r ge S ort : t he S t ra t e gy ● E a s y di vi s i on ● N o c om pa ri s on i s done duri ng t he di vi s i on ● M i ni m i z i ng t he s i z e di f fe re nc e be t w e e n t he di vi de d s ubprobl e m s ● M e r gi ng t w o s ort e d s ubra nge s ● U s i ng Me r ge M e r gi ng S ort e d A rra ys A [0] A[ k -1] B[0] B[ m -1] M e r ge : t he S pe c i fi c a t i on ● Input : A rra y A w i t h k e l e m e nt s a nd B w i t h m e l e m e nt s , e a c h i n nonde c re a s i ng orde r of t he i r ke y . ● O ut put : C , a n a rra y c ont a i ni ng n = k + m e l e m e nt s from A a nd B i n nonde c re a s i ng orde r . C i s pa s s e d i n a nd t he a l gori t hm fi l l s i t . M e r ge : t he Re c urs i ve V e rs i on m e r ge ( A , B , C ) if ( A i s e m pt y) re s t of C = re s t of B e l s e i f ( B i s e m pt y) re s t of C = re s t of A else if (fi rs t of A \u0000 fi rs t of B ) fi rs t of C =fi rs t of A m e r ge (re s t of A , B , re s t of C ) else fi rs t of C =fi rs t of B m e r ge (A , re s t of B, re s t of C ) r e tu r n Ba s e c a s e s W ors t Ca s e Com pl e xi t y of M e r ge ● O bs e rva t i ons : ● A ft e r e a c h c om pa ri s on, one e l e m e nt i s i ns e rt e d i nt o A rra y C, at l e as t . ● A ft e r e nt e ri ng A rra y C, a n e l e m e nt w i l l ne ve r be c om pa re d a ga i n ● A ft e r t he l a s t c om pa ri s on, a t l e a s t t w o e l e m e nt s ha ve not ye t be e n m ove d t o A rra y C. S o a t m os t n -1 c om pa ri s ons a re done . ● W ors t c a s e i s t ha t t he l a s t c om pa ri s on i s c onduc t e d be t w e e n A [ k -1] a nd B[ m -1] ● In w ors t c a s e , n -1 c om pa ri s ons a re done , w he re n = k + m O pt i m a l i t y of M e r ge ● A ny a l gori t hm t o m e r ge t w o s ort e d a rra ys , e a c h c ont a i ni ng k = m = n / 2 e nt ri e s , by c om pa ri s on of ke ys , doe s a t l e a s t n -1 c om pa ri s ons i n t he w ors t c a s e . ● Choos e ke ys s o t ha t : b 0 <a 0 <b 1 < a 1 <...< b i < a i < b i +1 ,...,< b m -1 < a k-1 ● T he n t he a l gori t hm m us t c om pa re a i w i t h b i for e ve ry i i n [0, m -1], a nd m us t c om pa re a i w i t h b i +1 for e ve ry i i n [0, m -2], s o, t he re a re n -1 c om pa ri s ons . V a l i d for | k - m | \u0000 1, a s w e l l . S pa c e Com pl e xi t y of M e r ge ● A a l gori t hm i s “ i n s pa c e ” , i f t he e xt ra s pa c e i t ha s t o us e i s i n \u0000 (1) ● M e r ge i s n ot a a l gori t hm “ i n s pa c e ” , s i nc e i t ne e d e nough e xt ra s pa c e t o s t ore t he m e r ge d s e que nc e duri ng t he m e r gi ng proc e s s . O ve rl a ppi ng A rra ys for M e r ge 0 k -1 m -10 Be fore t he m e r ge k+m -1 A B M e r ge from t he ri ght 0 k -1 m -10k+m -1 0 k -1 m -10k+m -1 A/C F i ni s he d M e r ge d e xt ra s pa c e P a rt l y fi ni s he d M e r ge S ort ● Input : A rra y E a nd i nde xe s first , a nd l as t , s uc h t ha t t he e l e m e nt s of E [ i ] a re de fi ne d for first \u0000 i \u0000 l as t . ● O ut put : E [ first ],…,E [ l as t ] i s a s ort e d re a rra nge m e nt of t he s a m e e l e m e nt s . ● P roc e dure voi d m e r ge S ort (E l e m e nt [] E , int fi rs t , int l a s t ) if (fi rs t <l a s t ) int m i d=(fi rs t +l a s t )/ 2; m e r ge S ort (E , fi rs t , m i d); m e r ge S ort (E , m i d+1, l a s t ); m e r ge (E , fi rs t , m i d, l a s t ) r e tu r n A na l ys i s of M e r ge s ort ● T he re c urre nc e e qua t i on for M e r ge s ort ● W (n)=W ( \u0000 n/ 2 \u0000 )+W ( \u0000 n/ 2 \u0000 )+n-1 ● W (1)=0 W he re n =l a s t -fi rs t +1, t he s i z e of ra nge t o be s ort e d ● T he Mas t e r T he or e m a ppl i e s for t he e qua t i on, s o: W ( n ) \u0000 \u0000( n l og n ) k / 2 m a y be \u0000 k /2 \u0000 or \u0000 k /2 \u0000 Ba s e c a s e s oc c ur a t de pt h \u0000 l g(n+1) \u0000 -1 a nd \u0000 l g(n+1) \u0000 Re c urs i on T re e for M e r ge s ort T (n) n-1 T (n/ 2) n/ 2-1 T (n/ 8) n/ 8-1T (n/ 4) n/ 4-1 n-1 n-2 n-4 n-8 L e ve l 0 L e ve l 1 L e ve l 2 L e ve l 3 N ot e : nonre c urs i ve c os t s on l e ve l k is n -2 k for a l l l e ve l w i t hout ba s e c a s e node N on-c om pl e t e Re c urs i ve T re e B ba s e -c a s e node s on t he s e c ond l ow e s t l e ve l n - B ba s e -c a s e node s N o nonba s e -c a s e node s a t t hi s de pt h 2 D -1 node s S i nc e e a c h nonba s e -c a s e node ha s 2 c hi l dre n, t he re a re ( n - B )/ 2 nonba s e -c a s e node s a t de pt h D -1 E x am pl e : n= 1 1 N um be r of Com pa ri s on of M e r ge s ort ● T he m a xi m um de pt h D of t he re c urs i ve t re e i s \u0000 l g(n+1) \u0000 . ● Let B ba s e c a s e node s on de pt h D -1, a nd n - B on de pt h D , (N ot e : ba s e c a s e node ha s nonre c urs i ve c os t 0). ● ( n - B )/ 2 nonba s e c a s e node s a t de pt h D -1, e a c h ha s nonre c urs i ve c os t 1. ● S o: ● \u0000\u0000 n l g(n )-n + 1 \u0000 \u0000 \u0000 \u0000 n u mb e r of c omp ar i s on \u0000 \u0000\u0000 \u0000 n l g(n )-0.914n \u0000\u0000 D e c i s i on T re e for S ort i ng A e xa m pl e for n=3 ● D e c i s i on t re e i s a 2-t re e .(A s s um i ng no s a m e ke ys ) ● T he a c t i on of S ort on a pa rt i c ul a r i nput c orre s ponds t o fol l ow i ng on pa t h i n i t s de c i s i on t re e from t he root t o a l e a f a s s oc i a t e d t o t he s pe c i fi c out put Int e rna l node E xt e rna l node ↓ _ , t ↓ 从 ⼤ 到 ⼩ ⽐ ↓ 选 ⼤的 延⻓ 俄 M e r ge S ort A l gori t hm : D e s i gn & A na l ys i s [5] In t he l a s t c l a s s … ● Ins e rt i on s ort ● A na l ys i s of i ns e rt i on s ort i ng a l gori t hm ● L ow e r bound of l oc a l c om pa ri s on ba s e d s ort i ng a l gori t hm ● G e ne ra l pa t t e rn of di vi de -a nd-c onque r ● Q ui c ks ort ● A na l ys i s of Q ui c ks ort M e r ge s ort ● M e r ge s ort ● W ors t Ca s e A na l ys i s of M e r ge s ort ● L ow e r Bounds for S ort i ng by Com pa ri s on of K e ys ● W ors t Ca s e ● A ve ra ge Be ha vi or M e r ge S ort : t he S t ra t e gy ● E a s y di vi s i on ● N o c om pa ri s on i s done duri ng t he di vi s i on ● M i ni m i z i ng t he s i z e di f fe re nc e be t w e e n t he di vi de d s ubprobl e m s ● M e r gi ng t w o s ort e d s ubra nge s ● U s i ng Me r ge M e r gi ng S ort e d A rra ys A [0] A[ k -1] B[0] B[ m -1] M e r ge : t he S pe c i fi c a t i on ● Input : A rra y A w i t h k e l e m e nt s a nd B w i t h m e l e m e nt s , e a c h i n nonde c re a s i ng orde r of t he i r ke y . ● O ut put : C , a n a rra y c ont a i ni ng n = k + m e l e m e nt s from A a nd B i n nonde c re a s i ng orde r . C i s pa s s e d i n a nd t he a l gori t hm fi l l s i t . M e r ge : t he Re c urs i ve V e rs i on m e r ge ( A , B , C ) if ( A i s e m pt y) re s t of C = re s t of B e l s e i f ( B i s e m pt y) re s t of C = re s t of A else if (fi rs t of A \u0000 fi rs t of B ) fi rs t of C =fi rs t of A m e r ge (re s t of A , B , re s t of C ) else fi rs t of C =fi rs t of B m e r ge (A , re s t of B, re s t of C ) r e tu r n Ba s e c a s e s W ors t Ca s e Com pl e xi t y of M e r ge ● O bs e rva t i ons : ● A ft e r e a c h c om pa ri s on, one e l e m e nt i s i ns e rt e d i nt o A rra y C, at l e as t . ● A ft e r e nt e ri ng A rra y C, a n e l e m e nt w i l l ne ve r be c om pa re d a ga i n ● A ft e r t he l a s t c om pa ri s on, a t l e a s t t w o e l e m e nt s ha ve not ye t be e n m ove d t o A rra y C. S o a t m os t n -1 c om pa ri s ons a re done . ● W ors t c a s e i s t ha t t he l a s t c om pa ri s on i s c onduc t e d be t w e e n A [ k -1] a nd B[ m -1] ● In w ors t c a s e , n -1 c om pa ri s ons a re done , w he re n = k + m O pt i m a l i t y of M e r ge ● A ny a l gori t hm t o m e r ge t w o s ort e d a rra ys , e a c h c ont a i ni ng k = m = n / 2 e nt ri e s , by c om pa ri s on of ke ys , doe s a t l e a s t n -1 c om pa ri s ons i n t he w ors t c a s e . ● Choos e ke ys s o t ha t : b 0 <a 0 <b 1 < a 1 <...< b i < a i < b i +1 ,...,< b m -1 < a k-1 ● T he n t he a l gori t hm m us t c om pa re a i w i t h b i for e ve ry i i n [0, m -1], a nd m us t c om pa re a i w i t h b i +1 for e ve ry i i n [0, m -2], s o, t he re a re n -1 c om pa ri s ons . V a l i d for | k - m | \u0000 1, a s w e l l . S pa c e Com pl e xi t y of M e r ge ● A a l gori t hm i s “ i n s pa c e ” , i f t he e xt ra s pa c e i t ha s t o us e i s i n \u0000 (1) ● M e r ge i s n ot a a l gori t hm “ i n s pa c e ” , s i nc e i t ne e d e nough e xt ra s pa c e t o s t ore t he m e r ge d s e que nc e duri ng t he m e r gi ng proc e s s . O ve rl a ppi ng A rra ys for M e r ge 0 k -1 m -10 Be fore t he m e r ge k+m -1 A B M e r ge from t he ri ght 0 k -1 m -10k+m -1 0 k -1 m -10k+m -1 A/C F i ni s he d M e r ge d e xt ra s pa c e P a rt l y fi ni s he d M e r ge S ort ● Input : A rra y E a nd i nde xe s first , a nd l as t , s uc h t ha t t he e l e m e nt s of E [ i ] a re de fi ne d for first \u0000 i \u0000 l as t . ● O ut put : E [ first ],…,E [ l as t ] i s a s ort e d re a rra nge m e nt of t he s a m e e l e m e nt s . ● P roc e dure voi d m e r ge S ort (E l e m e nt [] E , int fi rs t , int l a s t ) if (fi rs t <l a s t ) int m i d=(fi rs t +l a s t )/ 2; m e r ge S ort (E , fi rs t , m i d); m e r ge S ort (E , m i d+1, l a s t ); m e r ge (E , fi rs t , m i d, l a s t ) r e tu r n A na l ys i s of M e r ge s ort ● T he re c urre nc e e qua t i on for M e r ge s ort ● W (n)=W ( \u0000 n/ 2 \u0000 )+W ( \u0000 n/ 2 \u0000 )+n-1 ● W (1)=0 W he re n =l a s t -fi rs t +1, t he s i z e of ra nge t o be s ort e d ● T he Mas t e r T he or e m a ppl i e s for t he e qua t i on, s o: W ( n ) \u0000 \u0000( n l og n ) k / 2 m a y be \u0000 k /2 \u0000 or \u0000 k /2 \u0000 Ba s e c a s e s oc c ur a t de pt h \u0000 l g(n+1) \u0000 -1 a nd \u0000 l g(n+1) \u0000 Re c urs i on T re e for M e r ge s ort T (n) n-1 T (n/ 2) n/ 2-1 T (n/ 8) n/ 8-1T (n/ 4) n/ 4-1 n-1 n-2 n-4 n-8 L e ve l 0 L e ve l 1 L e ve l 2 L e ve l 3 N ot e : nonre c urs i ve c os t s on l e ve l k is n -2 k for a l l l e ve l w i t hout ba s e c a s e node N on-c om pl e t e Re c urs i ve T re e B ba s e -c a s e node s on t he s e c ond l ow e s t l e ve l n - B ba s e -c a s e node s N o nonba s e -c a s e node s a t t hi s de pt h 2 D -1 node s S i nc e e a c h nonba s e -c a s e node ha s 2 c hi l dre n, t he re a re ( n - B )/ 2 nonba s e -c a s e node s a t de pt h D -1 E x am pl e : n= 1 1 N um be r of Com pa ri s on of M e r ge s ort ● T he m a xi m um de pt h D of t he re c urs i ve t re e i s \u0000 l g(n+1) \u0000 . ● Let B ba s e c a s e node s on de pt h D -1, a nd n - B on de pt h D , (N ot e : ba s e c a s e node ha s nonre c urs i ve c os t 0). ● ( n - B )/ 2 nonba s e c a s e node s a t de pt h D -1, e a c h ha s nonre c urs i ve c os t 1. ● S o: ● \u0000\u0000 n l g(n )-n + 1 \u0000 \u0000 \u0000 \u0000 n u mb e r of c omp ar i s on \u0000 \u0000\u0000 \u0000 n l g(n )-0.914n \u0000\u0000 D e c i s i on T re e for S ort i ng A e xa m pl e for n=3 ● D e c i s i on t re e i s a 2-t re e .(A s s um i ng no s a m e ke ys ) ● T he a c t i on of S ort on a pa rt i c ul a r i nput c orre s ponds t o fol l ow i ng on pa t h i n i t s de c i s i on t re e from t he root t o a l e a f a s s oc i a t e d t o t he s pe c i fi c out put Int e rna l node E xt e rna l node ≤ ≤ M e r ge S ort A l gori t hm : D e s i gn & A na l ys i s [5] In t he l a s t c l a s s … ● Ins e rt i on s ort ● A na l ys i s of i ns e rt i on s ort i ng a l gori t hm ● L ow e r bound of l oc a l c om pa ri s on ba s e d s ort i ng a l gori t hm ● G e ne ra l pa t t e rn of di vi de -a nd-c onque r ● Q ui c ks ort ● A na l ys i s of Q ui c ks ort M e r ge s ort ● M e r ge s ort ● W ors t Ca s e A na l ys i s of M e r ge s ort ● L ow e r Bounds for S ort i ng by Com pa ri s on of K e ys ● W ors t Ca s e ● A ve ra ge Be ha vi or M e r ge S ort : t he S t ra t e gy ● E a s y di vi s i on ● N o c om pa ri s on i s done duri ng t he di vi s i on ● M i ni m i z i ng t he s i z e di f fe re nc e be t w e e n t he di vi de d s ubprobl e m s ● M e r gi ng t w o s ort e d s ubra nge s ● U s i ng Me r ge M e r gi ng S ort e d A rra ys A [0] A[ k -1] B[0] B[ m -1] M e r ge : t he S pe c i fi c a t i on ● Input : A rra y A w i t h k e l e m e nt s a nd B w i t h m e l e m e nt s , e a c h i n nonde c re a s i ng orde r of t he i r ke y . ● O ut put : C , a n a rra y c ont a i ni ng n = k + m e l e m e nt s from A a nd B i n nonde c re a s i ng orde r . C i s pa s s e d i n a nd t he a l gori t hm fi l l s i t . M e r ge : t he Re c urs i ve V e rs i on m e r ge ( A , B , C ) if ( A i s e m pt y) re s t of C = re s t of B e l s e i f ( B i s e m pt y) re s t of C = re s t of A else if (fi rs t of A \u0000 fi rs t of B ) fi rs t of C =fi rs t of A m e r ge (re s t of A , B , re s t of C ) else fi rs t of C =fi rs t of B m e r ge (A , re s t of B, re s t of C ) r e tu r n Ba s e c a s e s W ors t Ca s e Com pl e xi t y of M e r ge ● O bs e rva t i ons : ● A ft e r e a c h c om pa ri s on, one e l e m e nt i s i ns e rt e d i nt o A rra y C, at l e as t . ● A ft e r e nt e ri ng A rra y C, a n e l e m e nt w i l l ne ve r be c om pa re d a ga i n ● A ft e r t he l a s t c om pa ri s on, a t l e a s t t w o e l e m e nt s ha ve not ye t be e n m ove d t o A rra y C. S o a t m os t n -1 c om pa ri s ons a re done . ● W ors t c a s e i s t ha t t he l a s t c om pa ri s on i s c onduc t e d be t w e e n A [ k -1] a nd B[ m -1] ● In w ors t c a s e , n -1 c om pa ri s ons a re done , w he re n = k + m O pt i m a l i t y of M e r ge ● A ny a l gori t hm t o m e r ge t w o s ort e d a rra ys , e a c h c ont a i ni ng k = m = n / 2 e nt ri e s , by c om pa ri s on of ke ys , doe s a t l e a s t n -1 c om pa ri s ons i n t he w ors t c a s e . ● Choos e ke ys s o t ha t : b 0 <a 0 <b 1 < a 1 <...< b i < a i < b i +1 ,...,< b m -1 < a k-1 ● T he n t he a l gori t hm m us t c om pa re a i w i t h b i for e ve ry i i n [0, m -1], a nd m us t c om pa re a i w i t h b i +1 for e ve ry i i n [0, m -2], s o, t he re a re n -1 c om pa ri s ons . V a l i d for | k - m | \u0000 1, a s w e l l . S pa c e Com pl e xi t y of M e r ge ● A a l gori t hm i s “ i n s pa c e ” , i f t he e xt ra s pa c e i t ha s t o us e i s i n \u0000 (1) ● M e r ge i s n ot a a l gori t hm “ i n s pa c e ” , s i nc e i t ne e d e nough e xt ra s pa c e t o s t ore t he m e r ge d s e que nc e duri ng t he m e r gi ng proc e s s . O ve rl a ppi ng A rra ys for M e r ge 0 k -1 m -10 Be fore t he m e r ge k+m -1 A B M e r ge from t he ri ght 0 k -1 m -10k+m -1 0 k -1 m -10k+m -1 A/C F i ni s he d M e r ge d e xt ra s pa c e P a rt l y fi ni s he d M e r ge S ort ● Input : A rra y E a nd i nde xe s first , a nd l as t , s uc h t ha t t he e l e m e nt s of E [ i ] a re de fi ne d for first \u0000 i \u0000 l as t . ● O ut put : E [ first ],…,E [ l as t ] i s a s ort e d re a rra nge m e nt of t he s a m e e l e m e nt s . ● P roc e dure voi d m e r ge S ort (E l e m e nt [] E , int fi rs t , int l a s t ) if (fi rs t <l a s t ) int m i d=(fi rs t +l a s t )/ 2; m e r ge S ort (E , fi rs t , m i d); m e r ge S ort (E , m i d+1, l a s t ); m e r ge (E , fi rs t , m i d, l a s t ) r e tu r n A na l ys i s of M e r ge s ort ● T he re c urre nc e e qua t i on for M e r ge s ort ● W (n)=W ( \u0000 n/ 2 \u0000 )+W ( \u0000 n/ 2 \u0000 )+n-1 ● W (1)=0 W he re n =l a s t -fi rs t +1, t he s i z e of ra nge t o be s ort e d ● T he Mas t e r T he or e m a ppl i e s for t he e qua t i on, s o: W ( n ) \u0000 \u0000( n l og n ) k / 2 m a y be \u0000 k /2 \u0000 or \u0000 k /2 \u0000 Ba s e c a s e s oc c ur a t de pt h \u0000 l g(n+1) \u0000 -1 a nd \u0000 l g(n+1) \u0000 Re c urs i on T re e for M e r ge s ort T (n) n-1 T (n/ 2) n/ 2-1 T (n/ 8) n/ 8-1T (n/ 4) n/ 4-1 n-1 n-2 n-4 n-8 L e ve l 0 L e ve l 1 L e ve l 2 L e ve l 3 N ot e : nonre c urs i ve c os t s on l e ve l k is n -2 k for a l l l e ve l w i t hout ba s e c a s e node N on-c om pl e t e Re c urs i ve T re e B ba s e -c a s e node s on t he s e c ond l ow e s t l e ve l n - B ba s e -c a s e node s N o nonba s e -c a s e node s a t t hi s de pt h 2 D -1 node s S i nc e e a c h nonba s e -c a s e node ha s 2 c hi l dre n, t he re a re ( n - B )/ 2 nonba s e -c a s e node s a t de pt h D -1 E x am pl e : n= 1 1 N um be r of Com pa ri s on of M e r ge s ort ● T he m a xi m um de pt h D of t he re c urs i ve t re e i s \u0000 l g(n+1) \u0000 . ● Let B ba s e c a s e node s on de pt h D -1, a nd n - B on de pt h D , (N ot e : ba s e c a s e node ha s nonre c urs i ve c os t 0). ● ( n - B )/ 2 nonba s e c a s e node s a t de pt h D -1, e a c h ha s nonre c urs i ve c os t 1. ● S o: ● \u0000\u0000 n l g(n )-n + 1 \u0000 \u0000 \u0000 \u0000 n u mb e r of c omp ar i s on \u0000 \u0000\u0000 \u0000 n l g(n )-0.914n \u0000\u0000 D e c i s i on T re e for S ort i ng A e xa m pl e for n=3 ● D e c i s i on t re e i s a 2-t re e .(A s s um i ng no s a m e ke ys ) ● T he a c t i on of S ort on a pa rt i c ul a r i nput c orre s ponds t o fol l ow i ng on pa t h i n i t s de c i s i on t re e from t he root t o a l e a f a s s oc i a t e d t o t he s pe c i fi c out put Int e rna l node E xt e rna l node L J T 1 wc n i Ez w c) + 叫 f ④ M e r ge S ort A l gori t hm : D e s i gn & A na l ys i s [5] In t he l a s t c l a s s … ● Ins e rt i on s ort ● A na l ys i s of i ns e rt i on s ort i ng a l gori t hm ● L ow e r bound of l oc a l c om pa ri s on ba s e d s ort i ng a l gori t hm ● G e ne ra l pa t t e rn of di vi de -a nd-c onque r ● Q ui c ks ort ● A na l ys i s of Q ui c ks ort M e r ge s ort ● M e r ge s ort ● W ors t Ca s e A na l ys i s of M e r ge s ort ● L ow e r Bounds for S ort i ng by Com pa ri s on of K e ys ● W ors t Ca s e ● A ve ra ge Be ha vi or M e r ge S ort : t he S t ra t e gy ● E a s y di vi s i on ● N o c om pa ri s on i s done duri ng t he di vi s i on ● M i ni m i z i ng t he s i z e di f fe re nc e be t w e e n t he di vi de d s ubprobl e m s ● M e r gi ng t w o s ort e d s ubra nge s ● U s i ng Me r ge M e r gi ng S ort e d A rra ys A [0] A[ k -1] B[0] B[ m -1] M e r ge : t he S pe c i fi c a t i on ● Input : A rra y A w i t h k e l e m e nt s a nd B w i t h m e l e m e nt s , e a c h i n nonde c re a s i ng orde r of t he i r ke y . ● O ut put : C , a n a rra y c ont a i ni ng n = k + m e l e m e nt s from A a nd B i n nonde c re a s i ng orde r . C i s pa s s e d i n a nd t he a l gori t hm fi l l s i t . M e r ge : t he Re c urs i ve V e rs i on m e r ge ( A , B , C ) if ( A i s e m pt y) re s t of C = re s t of B e l s e i f ( B i s e m pt y) re s t of C = re s t of A else if (fi rs t of A \u0000 fi rs t of B ) fi rs t of C =fi rs t of A m e r ge (re s t of A , B , re s t of C ) else fi rs t of C =fi rs t of B m e r ge (A , re s t of B, re s t of C ) r e tu r n Ba s e c a s e s W ors t Ca s e Com pl e xi t y of M e r ge ● O bs e rva t i ons : ● A ft e r e a c h c om pa ri s on, one e l e m e nt i s i ns e rt e d i nt o A rra y C, at l e as t . ● A ft e r e nt e ri ng A rra y C, a n e l e m e nt w i l l ne ve r be c om pa re d a ga i n ● A ft e r t he l a s t c om pa ri s on, a t l e a s t t w o e l e m e nt s ha ve not ye t be e n m ove d t o A rra y C. S o a t m os t n -1 c om pa ri s ons a re done . ● W ors t c a s e i s t ha t t he l a s t c om pa ri s on i s c onduc t e d be t w e e n A [ k -1] a nd B[ m -1] ● In w ors t c a s e , n -1 c om pa ri s ons a re done , w he re n = k + m O pt i m a l i t y of M e r ge ● A ny a l gori t hm t o m e r ge t w o s ort e d a rra ys , e a c h c ont a i ni ng k = m = n / 2 e nt ri e s , by c om pa ri s on of ke ys , doe s a t l e a s t n -1 c om pa ri s ons i n t he w ors t c a s e . ● Choos e ke ys s o t ha t : b 0 <a 0 <b 1 < a 1 <...< b i < a i < b i +1 ,...,< b m -1 < a k-1 ● T he n t he a l gori t hm m us t c om pa re a i w i t h b i for e ve ry i i n [0, m -1], a nd m us t c om pa re a i w i t h b i +1 for e ve ry i i n [0, m -2], s o, t he re a re n -1 c om pa ri s ons . V a l i d for | k - m | \u0000 1, a s w e l l . S pa c e Com pl e xi t y of M e r ge ● A a l gori t hm i s “ i n s pa c e ” , i f t he e xt ra s pa c e i t ha s t o us e i s i n \u0000 (1) ● M e r ge i s n ot a a l gori t hm “ i n s pa c e ” , s i nc e i t ne e d e nough e xt ra s pa c e t o s t ore t he m e r ge d s e que nc e duri ng t he m e r gi ng proc e s s . O ve rl a ppi ng A rra ys for M e r ge 0 k -1 m -10 Be fore t he m e r ge k+m -1 A B M e r ge from t he ri ght 0 k -1 m -10k+m -1 0 k -1 m -10k+m -1 A/C F i ni s he d M e r ge d e xt ra s pa c e P a rt l y fi ni s he d M e r ge S ort ● Input : A rra y E a nd i nde xe s first , a nd l as t , s uc h t ha t t he e l e m e nt s of E [ i ] a re de fi ne d for first \u0000 i \u0000 l as t . ● O ut put : E [ first ],…,E [ l as t ] i s a s ort e d re a rra nge m e nt of t he s a m e e l e m e nt s . ● P roc e dure voi d m e r ge S ort (E l e m e nt [] E , int fi rs t , int l a s t ) if (fi rs t <l a s t ) int m i d=(fi rs t +l a s t )/ 2; m e r ge S ort (E , fi rs t , m i d); m e r ge S ort (E , m i d+1, l a s t ); m e r ge (E , fi rs t , m i d, l a s t ) r e tu r n A na l ys i s of M e r ge s ort ● T he re c urre nc e e qua t i on for M e r ge s ort ● W (n)=W ( \u0000 n/ 2 \u0000 )+W ( \u0000 n/ 2 \u0000 )+n-1 ● W (1)=0 W he re n =l a s t -fi rs t +1, t he s i z e of ra nge t o be s ort e d ● T he Mas t e r T he or e m a ppl i e s for t he e qua t i on, s o: W ( n ) \u0000 \u0000( n l og n ) k / 2 m a y be \u0000 k /2 \u0000 or \u0000 k /2 \u0000 Ba s e c a s e s oc c ur a t de pt h \u0000 l g(n+1) \u0000 -1 a nd \u0000 l g(n+1) \u0000 Re c urs i on T re e for M e r ge s ort T (n) n-1 T (n/ 2) n/ 2-1 T (n/ 8) n/ 8-1T (n/ 4) n/ 4-1 n-1 n-2 n-4 n-8 L e ve l 0 L e ve l 1 L e ve l 2 L e ve l 3 N ot e : nonre c urs i ve c os t s on l e ve l k is n -2 k for a l l l e ve l w i t hout ba s e c a s e node N on-c om pl e t e Re c urs i ve T re e B ba s e -c a s e node s on t he s e c ond l ow e s t l e ve l n - B ba s e -c a s e node s N o nonba s e -c a s e node s a t t hi s de pt h 2 D -1 node s S i nc e e a c h nonba s e -c a s e node ha s 2 c hi l dre n, t he re a re ( n - B )/ 2 nonba s e -c a s e node s a t de pt h D -1 E x am pl e : n= 1 1 N um be r of Com pa ri s on of M e r ge s ort ● T he m a xi m um de pt h D of t he re c urs i ve t re e i s \u0000 l g(n+1) \u0000 . ● Let B ba s e c a s e node s on de pt h D -1, a nd n - B on de pt h D , (N ot e : ba s e c a s e node ha s nonre c urs i ve c os t 0). ● ( n - B )/ 2 nonba s e c a s e node s a t de pt h D -1, e a c h ha s nonre c urs i ve c os t 1. ● S o: ● \u0000\u0000 n l g(n )-n + 1 \u0000 \u0000 \u0000 \u0000 n u mb e r of c omp ar i s on \u0000 \u0000\u0000 \u0000 n l g(n )-0.914n \u0000\u0000 D e c i s i on T re e for S ort i ng A e xa m pl e for n=3 ● D e c i s i on t re e i s a 2-t re e .(A s s um i ng no s a m e ke ys ) ● T he a c t i on of S ort on a pa rt i c ul a r i nput c orre s ponds t o fol l ow i ng on pa t h i n i t s de c i s i on t re e from t he root t o a l e a f a s s oc i a t e d t o t he s pe c i fi c out put Int e rna l node E xt e rna l node 补 : 设 树 内部 节点 教 为 ✗ , 则 外部 节点 教 为 ✗ +1 ① 苦 总 节点 n 为奇 则 内 ⼭ 外 望 也 为 偶 T T 77 内 ⽢ 进 叶 节点 1 有 ⼀个 ⽗ 节 全 在 后 法 点 只有 ⼀个 ⼦ 节点 ) k T 7 L 」 M e r ge S ort A l gori t hm : D e s i gn & A na l ys i s [5] In t he l a s t c l a s s … ● Ins e rt i on s ort ● A na l ys i s of i ns e rt i on s ort i ng a l gori t hm ● L ow e r bound of l oc a l c om pa ri s on ba s e d s ort i ng a l gori t hm ● G e ne ra l pa t t e rn of di vi de -a nd-c onque r ● Q ui c ks ort ● A na l ys i s of Q ui c ks ort M e r ge s ort ● M e r ge s ort ● W ors t Ca s e A na l ys i s of M e r ge s ort ● L ow e r Bounds for S ort i ng by Com pa ri s on of K e ys ● W ors t Ca s e ● A ve ra ge Be ha vi or M e r ge S ort : t he S t ra t e gy ● E a s y di vi s i on ● N o c om pa ri s on i s done duri ng t he di vi s i on ● M i ni m i z i ng t he s i z e di f fe re nc e be t w e e n t he di vi de d s ubprobl e m s ● M e r gi ng t w o s ort e d s ubra nge s ● U s i ng Me r ge M e r gi ng S ort e d A rra ys A [0] A[ k -1] B[0] B[ m -1] M e r ge : t he S pe c i fi c a t i on ● Input : A rra y A w i t h k e l e m e nt s a nd B w i t h m e l e m e nt s , e a c h i n nonde c re a s i ng orde r of t he i r ke y . ● O ut put : C , a n a rra y c ont a i ni ng n = k + m e l e m e nt s from A a nd B i n nonde c re a s i ng orde r . C i s pa s s e d i n a nd t he a l gori t hm fi l l s i t . M e r ge : t he Re c urs i ve V e rs i on m e r ge ( A , B , C ) if ( A i s e m pt y) re s t of C = re s t of B e l s e i f ( B i s e m pt y) re s t of C = re s t of A else if (fi rs t of A \u0000 fi rs t of B ) fi rs t of C =fi rs t of A m e r ge (re s t of A , B , re s t of C ) else fi rs t of C =fi rs t of B m e r ge (A , re s t of B, re s t of C ) r e tu r n Ba s e c a s e s W ors t Ca s e Com pl e xi t y of M e r ge ● O bs e rva t i ons : ● A ft e r e a c h c om pa ri s on, one e l e m e nt i s i ns e rt e d i nt o A rra y C, at l e as t . ● A ft e r e nt e ri ng A rra y C, a n e l e m e nt w i l l ne ve r be c om pa re d a ga i n ● A ft e r t he l a s t c om pa ri s on, a t l e a s t t w o e l e m e nt s ha ve not ye t be e n m ove d t o A rra y C. S o a t m os t n -1 c om pa ri s ons a re done . ● W ors t c a s e i s t ha t t he l a s t c om pa ri s on i s c onduc t e d be t w e e n A [ k -1] a nd B[ m -1] ● In w ors t c a s e , n -1 c om pa ri s ons a re done , w he re n = k + m O pt i m a l i t y of M e r ge ● A ny a l gori t hm t o m e r ge t w o s ort e d a rra ys , e a c h c ont a i ni ng k = m = n / 2 e nt ri e s , by c om pa ri s on of ke ys , doe s a t l e a s t n -1 c om pa ri s ons i n t he w ors t c a s e . ● Choos e ke ys s o t ha t : b 0 <a 0 <b 1 < a 1 <...< b i < a i < b i +1 ,...,< b m -1 < a k-1 ● T he n t he a l gori t hm m us t c om pa re a i w i t h b i for e ve ry i i n [0, m -1], a nd m us t c om pa re a i w i t h b i +1 for e ve ry i i n [0, m -2], s o, t he re a re n -1 c om pa ri s ons . V a l i d for | k - m | \u0000 1, a s w e l l . S pa c e Com pl e xi t y of M e r ge ● A a l gori t hm i s “ i n s pa c e ” , i f t he e xt ra s pa c e i t ha s t o us e i s i n \u0000 (1) ● M e r ge i s n ot a a l gori t hm “ i n s pa c e ” , s i nc e i t ne e d e nough e xt ra s pa c e t o s t ore t he m e r ge d s e que nc e duri ng t he m e r gi ng proc e s s . O ve rl a ppi ng A rra ys for M e r ge 0 k -1 m -10 Be fore t he m e r ge k+m -1 A B M e r ge from t he ri ght 0 k -1 m -10k+m -1 0 k -1 m -10k+m -1 A/C F i ni s he d M e r ge d e xt ra s pa c e P a rt l y fi ni s he d M e r ge S ort ● Input : A rra y E a nd i nde xe s first , a nd l as t , s uc h t ha t t he e l e m e nt s of E [ i ] a re de fi ne d for first \u0000 i \u0000 l as t . ● O ut put : E [ first ],…,E [ l as t ] i s a s ort e d re a rra nge m e nt of t he s a m e e l e m e nt s . ● P roc e dure voi d m e r ge S ort (E l e m e nt [] E , int fi rs t , int l a s t ) if (fi rs t <l a s t ) int m i d=(fi rs t +l a s t )/ 2; m e r ge S ort (E , fi rs t , m i d); m e r ge S ort (E , m i d+1, l a s t ); m e r ge (E , fi rs t , m i d, l a s t ) r e tu r n A na l ys i s of M e r ge s ort ● T he re c urre nc e e qua t i on for M e r ge s ort ● W (n)=W ( \u0000 n/ 2 \u0000 )+W ( \u0000 n/ 2 \u0000 )+n-1 ● W (1)=0 W he re n =l a s t -fi rs t +1, t he s i z e of ra nge t o be s ort e d ● T he Mas t e r T he or e m a ppl i e s for t he e qua t i on, s o: W ( n ) \u0000 \u0000( n l og n ) k / 2 m a y be \u0000 k /2 \u0000 or \u0000 k /2 \u0000 Ba s e c a s e s oc c ur a t de pt h \u0000 l g(n+1) \u0000 -1 a nd \u0000 l g(n+1) \u0000 Re c urs i on T re e for M e r ge s ort T (n) n-1 T (n/ 2) n/ 2-1 T (n/ 8) n/ 8-1T (n/ 4) n/ 4-1 n-1 n-2 n-4 n-8 L e ve l 0 L e ve l 1 L e ve l 2 L e ve l 3 N ot e : nonre c urs i ve c os t s on l e ve l k is n -2 k for a l l l e ve l w i t hout ba s e c a s e node N on-c om pl e t e Re c urs i ve T re e B ba s e -c a s e node s on t he s e c ond l ow e s t l e ve l n - B ba s e -c a s e node s N o nonba s e -c a s e node s a t t hi s de pt h 2 D -1 node s S i nc e e a c h nonba s e -c a s e node ha s 2 c hi l dre n, t he re a re ( n - B )/ 2 nonba s e -c a s e node s a t de pt h D -1 E x am pl e : n= 1 1 N um be r of Com pa ri s on of M e r ge s ort ● T he m a xi m um de pt h D of t he re c urs i ve t re e i s \u0000 l g(n+1) \u0000 . ● Let B ba s e c a s e node s on de pt h D -1, a nd n - B on de pt h D , (N ot e : ba s e c a s e node ha s nonre c urs i ve c os t 0). ● ( n - B )/ 2 nonba s e c a s e node s a t de pt h D -1, e a c h ha s nonre c urs i ve c os t 1. ● S o: ● \u0000\u0000 n l g(n )-n + 1 \u0000 \u0000 \u0000 \u0000 n u mb e r of c omp ar i s on \u0000 \u0000\u0000 \u0000 n l g(n )-0.914n \u0000\u0000 D e c i s i on T re e for S ort i ng A e xa m pl e for n=3 ● D e c i s i on t re e i s a 2-t re e .(A s s um i ng no s a m e ke ys ) ● T he a c t i on of S ort on a pa rt i c ul a r i nput c orre s ponds t o fol l ow i ng on pa t h i n i t s de c i s i on t re e from t he root t o a l e a f a s s oc i a t e d t o t he s pe c i fi c out put Int e rna l node E xt e rna l node i - 0 1 3 个 义 有 个 共 听 元 ⻋ M e r ge S ort A l gori t hm : D e s i gn & A na l ys i s [5] In t he l a s t c l a s s … ● Ins e rt i on s ort ● A na l ys i s of i ns e rt i on s ort i ng a l gori t hm ● L ow e r bound of l oc a l c om pa ri s on ba s e d s ort i ng a l gori t hm ● G e ne ra l pa t t e rn of di vi de -a nd-c onque r ● Q ui c ks ort ● A na l ys i s of Q ui c ks ort M e r ge s ort ● M e r ge s ort ● W ors t Ca s e A na l ys i s of M e r ge s ort ● L ow e r Bounds for S ort i ng by Com pa ri s on of K e ys ● W ors t Ca s e ● A ve ra ge Be ha vi or M e r ge S ort : t he S t ra t e gy ● E a s y di vi s i on ● N o c om pa ri s on i s done duri ng t he di vi s i on ● M i ni m i z i ng t he s i z e di f fe re nc e be t w e e n t he di vi de d s ubprobl e m s ● M e r gi ng t w o s ort e d s ubra nge s ● U s i ng Me r ge M e r gi ng S ort e d A rra ys A [0] A[ k -1] B[0] B[ m -1] M e r ge : t he S pe c i fi c a t i on ● Input : A rra y A w i t h k e l e m e nt s a nd B w i t h m e l e m e nt s , e a c h i n nonde c re a s i ng orde r of t he i r ke y . ● O ut put : C , a n a rra y c ont a i ni ng n = k + m e l e m e nt s from A a nd B i n nonde c re a s i ng orde r . C i s pa s s e d i n a nd t he a l gori t hm fi l l s i t . M e r ge : t he Re c urs i ve V e rs i on m e r ge ( A , B , C ) if ( A i s e m pt y) re s t of C = re s t of B e l s e i f ( B i s e m pt y) re s t of C = re s t of A else if (fi rs t of A \u0000 fi rs t of B ) fi rs t of C =fi rs t of A m e r ge (re s t of A , B , re s t of C ) else fi rs t of C =fi rs t of B m e r ge (A , re s t of B, re s t of C ) r e tu r n Ba s e c a s e s W ors t Ca s e Com pl e xi t y of M e r ge ● O bs e rva t i ons : ● A ft e r e a c h c om pa ri s on, one e l e m e nt i s i ns e rt e d i nt o A rra y C, at l e as t . ● A ft e r e nt e ri ng A rra y C, a n e l e m e nt w i l l ne ve r be c om pa re d a ga i n ● A ft e r t he l a s t c om pa ri s on, a t l e a s t t w o e l e m e nt s ha ve not ye t be e n m ove d t o A rra y C. S o a t m os t n -1 c om pa ri s ons a re done . ● W ors t c a s e i s t ha t t he l a s t c om pa ri s on i s c onduc t e d be t w e e n A [ k -1] a nd B[ m -1] ● In w ors t c a s e , n -1 c om pa ri s ons a re done , w he re n = k + m O pt i m a l i t y of M e r ge ● A ny a l gori t hm t o m e r ge t w o s ort e d a rra ys , e a c h c ont a i ni ng k = m = n / 2 e nt ri e s , by c om pa ri s on of ke ys , doe s a t l e a s t n -1 c om pa ri s ons i n t he w ors t c a s e . ● Choos e ke ys s o t ha t : b 0 <a 0 <b 1 < a 1 <...< b i < a i < b i +1 ,...,< b m -1 < a k-1 ● T he n t he a l gori t hm m us t c om pa re a i w i t h b i for e ve ry i i n [0, m -1], a nd m us t c om pa re a i w i t h b i +1 for e ve ry i i n [0, m -2], s o, t he re a re n -1 c om pa ri s ons . V a l i d for | k - m | \u0000 1, a s w e l l . S pa c e Com pl e xi t y of M e r ge ● A a l gori t hm i s “ i n s pa c e ” , i f t he e xt ra s pa c e i t ha s t o us e i s i n \u0000 (1) ● M e r ge i s n ot a a l gori t hm “ i n s pa c e ” , s i nc e i t ne e d e nough e xt ra s pa c e t o s t ore t he m e r ge d s e que nc e duri ng t he m e r gi ng proc e s s . O ve rl a ppi ng A rra ys for M e r ge 0 k -1 m -10 Be fore t he m e r ge k+m -1 A B M e r ge from t he ri ght 0 k -1 m -10k+m -1 0 k -1 m -10k+m -1 A/C F i ni s he d M e r ge d e xt ra s pa c e P a rt l y fi ni s he d M e r ge S ort ● Input : A rra y E a nd i nde xe s first , a nd l as t , s uc h t ha t t he e l e m e nt s of E [ i ] a re de fi ne d for first \u0000 i \u0000 l as t . ● O ut put : E [ first ],…,E [ l as t ] i s a s ort e d re a rra nge m e nt of t he s a m e e l e m e nt s . ● P roc e dure voi d m e r ge S ort (E l e m e nt [] E , int fi rs t , int l a s t ) if (fi rs t <l a s t ) int m i d=(fi rs t +l a s t )/ 2; m e r ge S ort (E , fi rs t , m i d); m e r ge S ort (E , m i d+1, l a s t ); m e r ge (E , fi rs t , m i d, l a s t ) r e tu r n A na l ys i s of M e r ge s ort ● T he re c urre nc e e qua t i on for M e r ge s ort ● W (n)=W ( \u0000 n/ 2 \u0000 )+W ( \u0000 n/ 2 \u0000 )+n-1 ● W (1)=0 W he re n =l a s t -fi rs t +1, t he s i z e of ra nge t o be s ort e d ● T he Mas t e r T he or e m a ppl i e s for t he e qua t i on, s o: W ( n ) \u0000 \u0000( n l og n ) k / 2 m a y be \u0000 k /2 \u0000 or \u0000 k /2 \u0000 Ba s e c a s e s oc c ur a t de pt h \u0000 l g(n+1) \u0000 -1 a nd \u0000 l g(n+1) \u0000 Re c urs i on T re e for M e r ge s ort T (n) n-1 T (n/ 2) n/ 2-1 T (n/ 8) n/ 8-1T (n/ 4) n/ 4-1 n-1 n-2 n-4 n-8 L e ve l 0 L e ve l 1 L e ve l 2 L e ve l 3 N ot e : nonre c urs i ve c os t s on l e ve l k is n -2 k for a l l l e ve l w i t hout ba s e c a s e node N on-c om pl e t e Re c urs i ve T re e B ba s e -c a s e node s on t he s e c ond l ow e s t l e ve l n - B ba s e -c a s e node s N o nonba s e -c a s e node s a t t hi s de pt h 2 D -1 node s S i nc e e a c h nonba s e -c a s e node ha s 2 c hi l dre n, t he re a re ( n - B )/ 2 nonba s e -c a s e node s a t de pt h D -1 E x am pl e : n= 1 1 N um be r of Com pa ri s on of M e r ge s ort ● T he m a xi m um de pt h D of t he re c urs i ve t re e i s \u0000 l g(n+1) \u0000 . ● Let B ba s e c a s e node s on de pt h D -1, a nd n - B on de pt h D , (N ot e : ba s e c a s e node ha s nonre c urs i ve c os t 0). ● ( n - B )/ 2 nonba s e c a s e node s a t de pt h D -1, e a c h ha s nonre c urs i ve c os t 1. ● S o: ● \u0000\u0000 n l g(n )-n + 1 \u0000 \u0000 \u0000 \u0000 n u mb e r of c omp ar i s on \u0000 \u0000\u0000 \u0000 n l g(n )-0.914n \u0000\u0000 D e c i s i on T re e for S ort i ng A e xa m pl e for n=3 ● D e c i s i on t re e i s a 2-t re e .(A s s um i ng no s a m e ke ys ) ● T he a c t i on of S ort on a pa rt i c ul a r i nput c orre s ponds t o fol l ow i ng on pa t h i n i t s de c i s i on t re e from t he root t o a l e a f a s s oc i a t e d t o t he s pe c i fi c out put Int e rna l node E xt e rna l node n ( 前 D - 2 层 ( 总 ⽐较 跐 了 后 将 您 未 知 B .cz 吆 3 垇 ✓ -_- -_- en 217 -1 3 M ? 任 ⼀⼀ 上 个 7 M e r ge S ort A l gori t hm : D e s i gn & A na l ys i s [5] In t he l a s t c l a s s … ● Ins e rt i on s ort ● A na l ys i s of i ns e rt i on s ort i ng a l gori t hm ● L ow e r bound of l oc a l c om pa ri s on ba s e d s ort i ng a l gori t hm ● G e ne ra l pa t t e rn of di vi de -a nd-c onque r ● Q ui c ks ort ● A na l ys i s of Q ui c ks ort M e r ge s ort ● M e r ge s ort ● W ors t Ca s e A na l ys i s of M e r ge s ort ● L ow e r Bounds for S ort i ng by Com pa ri s on of K e ys ● W ors t Ca s e ● A ve ra ge Be ha vi or M e r ge S ort : t he S t ra t e gy ● E a s y di vi s i on ● N o c om pa ri s on i s done duri ng t he di vi s i on ● M i ni m i z i ng t he s i z e di f fe re nc e be t w e e n t he di vi de d s ubprobl e m s ● M e r gi ng t w o s ort e d s ubra nge s ● U s i ng Me r ge M e r gi ng S ort e d A rra ys A [0] A[ k -1] B[0] B[ m -1] M e r ge : t he S pe c i fi c a t i on ● Input : A rra y A w i t h k e l e m e nt s a nd B w i t h m e l e m e nt s , e a c h i n nonde c re a s i ng orde r of t he i r ke y . ● O ut put : C , a n a rra y c ont a i ni ng n = k + m e l e m e nt s from A a nd B i n nonde c re a s i ng orde r . C i s pa s s e d i n a nd t he a l gori t hm fi l l s i t . M e r ge : t he Re c urs i ve V e rs i on m e r ge ( A , B , C ) if ( A i s e m pt y) re s t of C = re s t of B e l s e i f ( B i s e m pt y) re s t of C = re s t of A else if (fi rs t of A \u0000 fi rs t of B ) fi rs t of C =fi rs t of A m e r ge (re s t of A , B , re s t of C ) else fi rs t of C =fi rs t of B m e r ge (A , re s t of B, re s t of C ) r e tu r n Ba s e c a s e s W ors t Ca s e Com pl e xi t y of M e r ge ● O bs e rva t i ons : ● A ft e r e a c h c om pa ri s on, one e l e m e nt i s i ns e rt e d i nt o A rra y C, at l e as t . ● A ft e r e nt e ri ng A rra y C, a n e l e m e nt w i l l ne ve r be c om pa re d a ga i n ● A ft e r t he l a s t c om pa ri s on, a t l e a s t t w o e l e m e nt s ha ve not ye t be e n m ove d t o A rra y C. S o a t m os t n -1 c om pa ri s ons a re done . ● W ors t c a s e i s t ha t t he l a s t c om pa ri s on i s c onduc t e d be t w e e n A [ k -1] a nd B[ m -1] ● In w ors t c a s e , n -1 c om pa ri s ons a re done , w he re n = k + m O pt i m a l i t y of M e r ge ● A ny a l gori t hm t o m e r ge t w o s ort e d a rra ys , e a c h c ont a i ni ng k = m = n / 2 e nt ri e s , by c om pa ri s on of ke ys , doe s a t l e a s t n -1 c om pa ri s ons i n t he w ors t c a s e . ● Choos e ke ys s o t ha t : b 0 <a 0 <b 1 < a 1 <...< b i < a i < b i +1 ,...,< b m -1 < a k-1 ● T he n t he a l gori t hm m us t c om pa re a i w i t h b i for e ve ry i i n [0, m -1], a nd m us t c om pa re a i w i t h b i +1 for e ve ry i i n [0, m -2], s o, t he re a re n -1 c om pa ri s ons . V a l i d for | k - m | \u0000 1, a s w e l l . S pa c e Com pl e xi t y of M e r ge ● A a l gori t hm i s “ i n s pa c e ” , i f t he e xt ra s pa c e i t ha s t o us e i s i n \u0000 (1) ● M e r ge i s n ot a a l gori t hm “ i n s pa c e ” , s i nc e i t ne e d e nough e xt ra s pa c e t o s t ore t he m e r ge d s e que nc e duri ng t he m e r gi ng proc e s s . O ve rl a ppi ng A rra ys for M e r ge 0 k -1 m -10 Be fore t he m e r ge k+m -1 A B M e r ge from t he ri ght 0 k -1 m -10k+m -1 0 k -1 m -10k+m -1 A/C F i ni s he d M e r ge d e xt ra s pa c e P a rt l y fi ni s he d M e r ge S ort ● Input : A rra y E a nd i nde xe s first , a nd l as t , s uc h t ha t t he e l e m e nt s of E [ i ] a re de fi ne d for first \u0000 i \u0000 l as t . ● O ut put : E [ first ],…,E [ l as t ] i s a s ort e d re a rra nge m e nt of t he s a m e e l e m e nt s . ● P roc e dure voi d m e r ge S ort (E l e m e nt [] E , int fi rs t , int l a s t ) if (fi rs t <l a s t ) int m i d=(fi rs t +l a s t )/ 2; m e r ge S ort (E , fi rs t , m i d); m e r ge S ort (E , m i d+1, l a s t ); m e r ge (E , fi rs t , m i d, l a s t ) r e tu r n A na l ys i s of M e r ge s ort ● T he re c urre nc e e qua t i on for M e r ge s ort ● W (n)=W ( \u0000 n/ 2 \u0000 )+W ( \u0000 n/ 2 \u0000 )+n-1 ● W (1)=0 W he re n =l a s t -fi rs t +1, t he s i z e of ra nge t o be s ort e d ● T he Mas t e r T he or e m a ppl i e s for t he e qua t i on, s o: W ( n ) \u0000 \u0000( n l og n ) k / 2 m a y be \u0000 k /2 \u0000 or \u0000 k /2 \u0000 Ba s e c a s e s oc c ur a t de pt h \u0000 l g(n+1) \u0000 -1 a nd \u0000 l g(n+1) \u0000 Re c urs i on T re e for M e r ge s ort T (n) n-1 T (n/ 2) n/ 2-1 T (n/ 8) n/ 8-1T (n/ 4) n/ 4-1 n-1 n-2 n-4 n-8 L e ve l 0 L e ve l 1 L e ve l 2 L e ve l 3 N ot e : nonre c urs i ve c os t s on l e ve l k is n -2 k for a l l l e ve l w i t hout ba s e c a s e node N on-c om pl e t e Re c urs i ve T re e B ba s e -c a s e node s on t he s e c ond l ow e s t l e ve l n - B ba s e -c a s e node s N o nonba s e -c a s e node s a t t hi s de pt h 2 D -1 node s S i nc e e a c h nonba s e -c a s e node ha s 2 c hi l dre n, t he re a re ( n - B )/ 2 nonba s e -c a s e node s a t de pt h D -1 E x am pl e : n= 1 1 N um be r of Com pa ri s on of M e r ge s ort ● T he m a xi m um de pt h D of t he re c urs i ve t re e i s \u0000 l g(n+1) \u0000 . ● Let B ba s e c a s e node s on de pt h D -1, a nd n - B on de pt h D , (N ot e : ba s e c a s e node ha s nonre c urs i ve c os t 0). ● ( n - B )/ 2 nonba s e c a s e node s a t de pt h D -1, e a c h ha s nonre c urs i ve c os t 1. ● S o: ● \u0000\u0000 n l g(n )-n + 1 \u0000 \u0000 \u0000 \u0000 n u mb e r of c omp ar i s on \u0000 \u0000\u0000 \u0000 n l g(n )-0.914n \u0000\u0000 D e c i s i on T re e for S ort i ng A e xa m pl e for n=3 ● D e c i s i on t re e i s a 2-t re e .(A s s um i ng no s a m e ke ys ) ● T he a c t i on of S ort on a pa rt i c ul a r i nput c orre s ponds t o fol l ow i ng on pa t h i n i t s de c i s i on t re e from t he root t o a l e a f a s s oc i a t e d t o t he s pe c i fi c out put Int e rna l node E xt e rna l node 如 有 可能 情况 决策 树 最⼤ 深度 即 最坏 情况 平均 深度 即 平均 情况 M e r ge S ort A l gori t hm : D e s i gn & A na l ys i s [5] In t he l a s t c l a s s … ● Ins e rt i on s ort ● A na l ys i s of i ns e rt i on s ort i ng a l gori t hm ● L ow e r bound of l oc a l c om pa ri s on ba s e d s ort i ng a l gori t hm ● G e ne ra l pa t t e rn of di vi de -a nd-c onque r ● Q ui c ks ort ● A na l ys i s of Q ui c ks ort M e r ge s ort ● M e r ge s ort ● W ors t Ca s e A na l ys i s of M e r ge s ort ● L ow e r Bounds for S ort i ng by Com pa ri s on of K e ys ● W ors t Ca s e ● A ve ra ge Be ha vi or M e r ge S ort : t he S t ra t e gy ● E a s y di vi s i on ● N o c om pa ri s on i s done duri ng t he di vi s i on ● M i ni m i z i ng t he s i z e di f fe re nc e be t w e e n t he di vi de d s ubprobl e m s ● M e r gi ng t w o s ort e d s ubra nge s ● U s i ng Me r ge M e r gi ng S ort e d A rra ys A [0] A[ k -1] B[0] B[ m -1] M e r ge : t he S pe c i fi c a t i on ● Input : A rra y A w i t h k e l e m e nt s a nd B w i t h m e l e m e nt s , e a c h i n nonde c re a s i ng orde r of t he i r ke y . ● O ut put : C , a n a rra y c ont a i ni ng n = k + m e l e m e nt s from A a nd B i n nonde c re a s i ng orde r . C i s pa s s e d i n a nd t he a l gori t hm fi l l s i t . M e r ge : t he Re c urs i ve V e rs i on m e r ge ( A , B , C ) if ( A i s e m pt y) re s t of C = re s t of B e l s e i f ( B i s e m pt y) re s t of C = re s t of A else if (fi rs t of A \u0000 fi rs t of B ) fi rs t of C =fi rs t of A m e r ge (re s t of A , B , re s t of C ) else fi rs t of C =fi rs t of B m e r ge (A , re s t of B, re s t of C ) r e tu r n Ba s e c a s e s W ors t Ca s e Com pl e xi t y of M e r ge ● O bs e rva t i ons : ● A ft e r e a c h c om pa ri s on, one e l e m e nt i s i ns e rt e d i nt o A rra y C, at l e as t . ● A ft e r e nt e ri ng A rra y C, a n e l e m e nt w i l l ne ve r be c om pa re d a ga i n ● A ft e r t he l a s t c om pa ri s on, a t l e a s t t w o e l e m e nt s ha ve not ye t be e n m ove d t o A rra y C. S o a t m os t n -1 c om pa ri s ons a re done . ● W ors t c a s e i s t ha t t he l a s t c om pa ri s on i s c onduc t e d be t w e e n A [ k -1] a nd B[ m -1] ● In w ors t c a s e , n -1 c om pa ri s ons a re done , w he re n = k + m O pt i m a l i t y of M e r ge ● A ny a l gori t hm t o m e r ge t w o s ort e d a rra ys , e a c h c ont a i ni ng k = m = n / 2 e nt ri e s , by c om pa ri s on of ke ys , doe s a t l e a s t n -1 c om pa ri s ons i n t he w ors t c a s e . ● Choos e ke ys s o t ha t : b 0 <a 0 <b 1 < a 1 <...< b i < a i < b i +1 ,...,< b m -1 < a k-1 ● T he n t he a l gori t hm m us t c om pa re a i w i t h b i for e ve ry i i n [0, m -1], a nd m us t c om pa re a i w i t h b i +1 for e ve ry i i n [0, m -2], s o, t he re a re n -1 c om pa ri s ons . V a l i d for | k - m | \u0000 1, a s w e l l . S pa c e Com pl e xi t y of M e r ge ● A a l gori t hm i s “ i n s pa c e ” , i f t he e xt ra s pa c e i t ha s t o us e i s i n \u0000 (1) ● M e r ge i s n ot a a l gori t hm “ i n s pa c e ” , s i nc e i t ne e d e nough e xt ra s pa c e t o s t ore t he m e r ge d s e que nc e duri ng t he m e r gi ng proc e s s . O ve rl a ppi ng A rra ys for M e r ge 0 k -1 m -10 Be fore t he m e r ge k+m -1 A B M e r ge from t he ri ght 0 k -1 m -10k+m -1 0 k -1 m -10k+m -1 A/C F i ni s he d M e r ge d e xt ra s pa c e P a rt l y fi ni s he d M e r ge S ort ● Input : A rra y E a nd i nde xe s first , a nd l as t , s uc h t ha t t he e l e m e nt s of E [ i ] a re de fi ne d for first \u0000 i \u0000 l as t . ● O ut put : E [ first ],…,E [ l as t ] i s a s ort e d re a rra nge m e nt of t he s a m e e l e m e nt s . ● P roc e dure voi d m e r ge S ort (E l e m e nt [] E , int fi rs t , int l a s t ) if (fi rs t <l a s t ) int m i d=(fi rs t +l a s t )/ 2; m e r ge S ort (E , fi rs t , m i d); m e r ge S ort (E , m i d+1, l a s t ); m e r ge (E , fi rs t , m i d, l a s t ) r e tu r n A na l ys i s of M e r ge s ort ● T he re c urre nc e e qua t i on for M e r ge s ort ● W (n)=W ( \u0000 n/ 2 \u0000 )+W ( \u0000 n/ 2 \u0000 )+n-1 ● W (1)=0 W he re n =l a s t -fi rs t +1, t he s i z e of ra nge t o be s ort e d ● T he Mas t e r T he or e m a ppl i e s for t he e qua t i on, s o: W ( n ) \u0000 \u0000( n l og n ) k / 2 m a y be \u0000 k /2 \u0000 or \u0000 k /2 \u0000 Ba s e c a s e s oc c ur a t de pt h \u0000 l g(n+1) \u0000 -1 a nd \u0000 l g(n+1) \u0000 Re c urs i on T re e for M e r ge s ort T (n) n-1 T (n/ 2) n/ 2-1 T (n/ 8) n/ 8-1T (n/ 4) n/ 4-1 n-1 n-2 n-4 n-8 L e ve l 0 L e ve l 1 L e ve l 2 L e ve l 3 N ot e : nonre c urs i ve c os t s on l e ve l k is n -2 k for a l l l e ve l w i t hout ba s e c a s e node N on-c om pl e t e Re c urs i ve T re e B ba s e -c a s e node s on t he s e c ond l ow e s t l e ve l n - B ba s e -c a s e node s N o nonba s e -c a s e node s a t t hi s de pt h 2 D -1 node s S i nc e e a c h nonba s e -c a s e node ha s 2 c hi l dre n, t he re a re ( n - B )/ 2 nonba s e -c a s e node s a t de pt h D -1 E x am pl e : n= 1 1 N um be r of Com pa ri s on of M e r ge s ort ● T he m a xi m um de pt h D of t he re c urs i ve t re e i s \u0000 l g(n+1) \u0000 . ● Let B ba s e c a s e node s on de pt h D -1, a nd n - B on de pt h D , (N ot e : ba s e c a s e node ha s nonre c urs i ve c os t 0). ● ( n - B )/ 2 nonba s e c a s e node s a t de pt h D -1, e a c h ha s nonre c urs i ve c os t 1. ● S o: ● \u0000\u0000 n l g(n )-n + 1 \u0000 \u0000 \u0000 \u0000 n u mb e r of c omp ar i s on \u0000 \u0000\u0000 \u0000 n l g(n )-0.914n \u0000\u0000 D e c i s i on T re e for S ort i ng A e xa m pl e for n=3 ● D e c i s i on t re e i s a 2-t re e .(A s s um i ng no s a m e ke ys ) ● T he a c t i on of S ort on a pa rt i c ul a r i nput c orre s ponds t o fol l ow i ng on pa t h i n i t s de c i s i on t re e from t he root t o a l e a f a s s oc i a t e d t o t he s pe c i fi c out put Int e rna l node E xt e rna l node Cha ra c t e ri s t i c s of t he D e c i s i on T re e ● F or a s e que nc e of n di s t i nc t e l e m e nt s , t he re a re n! di f fe re nt pe rm ut a t i on, s o, t he de c i s i on t re e ha s a t l e a s t n! l e a ve s , a nd e xa c t l y n! l e a ve s c a n be re a c he d from t he root . S o, for t he purpos e of l ow e r bounds e va l ua t i on, w e us e t re e s w i t h e xa c t l y n! l e a ve s . ● T he num be r of c om pa ri s on done i n t he wor s t c as e i s t he he i ght of t he t re e . ● T he av e r age num be r of c om pa ri s on done i s t he a ve ra ge of t he l e ngt hs of a l l pa t hs from t he root t o a l e a f. L ow e r Bound for W ors t Ca s e ● T h e or e m : A ny a l gori t hm t o s ort n i t e m s by c om pa ri s ons of ke ys m us t do a t l e a s t \u0000 lg n ! \u0000 , or a pproxi m a t e l y \u0000 n lg n - 1.443 n \u0000 , ke y c om pa ri s ons i n t he w ors t c a s e . ● N ot e : L e t L = n !, w hi c h i s t he num be r of l e a ve s , t he n L \u0000 2 h , w he re h i s t he he i ght of t he t re e , t ha t i s h \u0000 \u0000 lg L \u0000 = \u0000 lg n ! \u0000 ● F or t he a s ym pt ot i c be ha vi or: de ri ve d us i ng: 2-T re e ● 2-T re e ● Com m on Bi na ry T re e i nt e rna l node s e xt e rna l node s no c hi l d a ny t ype Bot h l e ft a nd ri ght c hi l dre n of t he s e node s a re e m pt y t re e E xt e rna l P a t h L e ngt h(E P L ) ● T he EP L of a 2-t re e t i s de fi ne d a s fol l ow s : ● [Ba s e c a s e ] 0 for a s i ngl e e xt e rna l node ● [Re c urs i on] t i s non-l e a f w i t h s ub-t re e s L a nd R , t he n t he s um of: ● t he e xt e rna l pa t h l e ngt h of L ; ● t he num be r of e xt e rna l node of L ; ● t he e xt e rna l pa t h l e ngt h of R ; ● t he num be r of e xt e rna l node of R ; P rope rt i e s of E P L ● Let t i s a 2-t re e , t he n t he e pl of t i s t he s um of t he pa t hs from t he root t o e a c h e xt e rna l node . ● e pl \u0000 m l g( m ), w he re m i s t he num be r of e xt e rna l node s i n t ● e pl = e pl L + e pl R +m \u0000 m L l g( m L )+ m R l g( m R )+ m , ● not e f (x)+ f (y) \u0000 2 f ((x+y)/ 2) for f( x )= x lg x ● s o, e pl \u0000 2(( m L + m R )/ 2)l g(( m L + m R )/ 2)+ m = m (l g( m )-1)+ m = m lg m . L ow e r Bound for A ve ra ge Be ha vi or ● S i nc e a de c i s i on t re e w i t h L l e a ve s i s a 2-t re e , t he a ve ra ge pa t h l e ngt h from t he root t o a l e a f i s . ● T he t re e s t ha t m i ni m i z e e pl a re a s ba l a nc e d a s pos s i bl e . ● Re c a l l t ha t e pl \u0000 L l g( L ). ● Th e or e m : T he a ve ra ge num be r of c om pa ri s on done by a n a l gori t hm t o s ort n i t e m s by c om pa ri s on of ke ys i s a t least l g( n !), w hi c h i s a bout n lg n -1.443 n . t o be prove d Re duc i ng E xt e rna l P a t h L e ngt h A s s um i ng t ha t h - k >1, w he n c a l c ul a t i ng e pl , h + h + k i s re pl a c e d by ( h -1)+2( k +1). T he ne t c ha nge i n e pl i s k - h +1<0, t ha t i s , t he e pl de c re a s e s . S o, m or e bal an c e d 2-t r e e h as s m al l e r e pl . X Y X Y l e ve l k l e ve l h - 1 l e ve l h l e ve l k +1 M e r ge s ort H a s O pt i m a l A ve ra ge P e rform a nc e ● W e ha ve prove d t ha t t he a ve ra ge num be r of c om pa ri s ons done by a n a l gori t hm t o s ort n i t e m s by c om pa ri s on of ke ys i s a t l e a s t a bout n lg n -1.443 n ● T he w or s t c om pl e xi t y of m e r ge s ort i s i n \u0000( n lg n ) ● But , t he a ve ra ge pe rform a nc e c a n not be w ors e t he t he w ors t c a s e pe rform a nc e . ● S o, m e r ge s ort i s opt i m a l a s for i t s a ve ra ge pe rform a nc e . H om e A s s i gnm e nt ● pp.212- ● 4.24 ● 4.25 ● 4.27 ● 4.29 ● 4.30 ● 4.32 ~ 有 n 1 种不同排序结果 Cha ra c t e ri s t i c s of t he D e c i s i on T re e ● F or a s e que nc e of n di s t i nc t e l e m e nt s , t he re a re n! di f fe re nt pe rm ut a t i on, s o, t he de c i s i on t re e ha s a t l e a s t n! l e a ve s , a nd e xa c t l y n! l e a ve s c a n be re a c he d from t he root . S o, for t he purpos e of l ow e r bounds e va l ua t i on, w e us e t re e s w i t h e xa c t l y n! l e a ve s . ● T he num be r of c om pa ri s on done i n t he wor s t c as e i s t he he i ght of t he t re e . ● T he av e r age num be r of c om pa ri s on done i s t he a ve ra ge of t he l e ngt hs of a l l pa t hs from t he root t o a l e a f. L ow e r Bound for W ors t Ca s e ● T h e or e m : A ny a l gori t hm t o s ort n i t e m s by c om pa ri s ons of ke ys m us t do a t l e a s t \u0000 lg n ! \u0000 , or a pproxi m a t e l y \u0000 n lg n - 1.443 n \u0000 , ke y c om pa ri s ons i n t he w ors t c a s e . ● N ot e : L e t L = n !, w hi c h i s t he num be r of l e a ve s , t he n L \u0000 2 h , w he re h i s t he he i ght of t he t re e , t ha t i s h \u0000 \u0000 lg L \u0000 = \u0000 lg n ! \u0000 ● F or t he a s ym pt ot i c be ha vi or: de ri ve d us i ng: 2-T re e ● 2-T re e ● Com m on Bi na ry T re e i nt e rna l node s e xt e rna l node s no c hi l d a ny t ype Bot h l e ft a nd ri ght c hi l dre n of t he s e node s a re e m pt y t re e E xt e rna l P a t h L e ngt h(E P L ) ● T he EP L of a 2-t re e t i s de fi ne d a s fol l ow s : ● [Ba s e c a s e ] 0 for a s i ngl e e xt e rna l node ● [Re c urs i on] t i s non-l e a f w i t h s ub-t re e s L a nd R , t he n t he s um of: ● t he e xt e rna l pa t h l e ngt h of L ; ● t he num be r of e xt e rna l node of L ; ● t he e xt e rna l pa t h l e ngt h of R ; ● t he num be r of e xt e rna l node of R ; P rope rt i e s of E P L ● Let t i s a 2-t re e , t he n t he e pl of t i s t he s um of t he pa t hs from t he root t o e a c h e xt e rna l node . ● e pl \u0000 m l g( m ), w he re m i s t he num be r of e xt e rna l node s i n t ● e pl = e pl L + e pl R +m \u0000 m L l g( m L )+ m R l g( m R )+ m , ● not e f (x)+ f (y) \u0000 2 f ((x+y)/ 2) for f( x )= x lg x ● s o, e pl \u0000 2(( m L + m R )/ 2)l g(( m L + m R )/ 2)+ m = m (l g( m )-1)+ m = m lg m . L ow e r Bound for A ve ra ge Be ha vi or ● S i nc e a de c i s i on t re e w i t h L l e a ve s i s a 2-t re e , t he a ve ra ge pa t h l e ngt h from t he root t o a l e a f i s . ● T he t re e s t ha t m i ni m i z e e pl a re a s ba l a nc e d a s pos s i bl e . ● Re c a l l t ha t e pl \u0000 L l g( L ). ● Th e or e m : T he a ve ra ge num be r of c om pa ri s on done by a n a l gori t hm t o s ort n i t e m s by c om pa ri s on of ke ys i s a t least l g( n !), w hi c h i s a bout n lg n -1.443 n . t o be prove d Re duc i ng E xt e rna l P a t h L e ngt h A s s um i ng t ha t h - k >1, w he n c a l c ul a t i ng e pl , h + h + k i s re pl a c e d by ( h -1)+2( k +1). T he ne t c ha nge i n e pl i s k - h +1<0, t ha t i s , t he e pl de c re a s e s . S o, m or e bal an c e d 2-t r e e h as s m al l e r e pl . X Y X Y l e ve l k l e ve l h - 1 l e ve l h l e ve l k +1 M e r ge s ort H a s O pt i m a l A ve ra ge P e rform a nc e ● W e ha ve prove d t ha t t he a ve ra ge num be r of c om pa ri s ons done by a n a l gori t hm t o s ort n i t e m s by c om pa ri s on of ke ys i s a t l e a s t a bout n lg n -1.443 n ● T he w or s t c om pl e xi t y of m e r ge s ort i s i n \u0000( n lg n ) ● But , t he a ve ra ge pe rform a nc e c a n not be w ors e t he t he w ors t c a s e pe rform a nc e . ● S o, m e r ge s ort i s opt i m a l a s for i t s a ve ra ge pe rform a nc e . H om e A s s i gnm e nt ● pp.212- ● 4.24 ● 4.25 ● 4.27 ● 4.29 ● 4.30 ● 4.32 T T T T ≥ ㄏ 7 T T Cha ra c t e ri s t i c s of t he D e c i s i on T re e ● F or a s e que nc e of n di s t i nc t e l e m e nt s , t he re a re n! di f fe re nt pe rm ut a t i on, s o, t he de c i s i on t re e ha s a t l e a s t n! l e a ve s , a nd e xa c t l y n! l e a ve s c a n be re a c he d from t he root . S o, for t he purpos e of l ow e r bounds e va l ua t i on, w e us e t re e s w i t h e xa c t l y n! l e a ve s . ● T he num be r of c om pa ri s on done i n t he wor s t c as e i s t he he i ght of t he t re e . ● T he av e r age num be r of c om pa ri s on done i s t he a ve ra ge of t he l e ngt hs of a l l pa t hs from t he root t o a l e a f. L ow e r Bound for W ors t Ca s e ● T h e or e m : A ny a l gori t hm t o s ort n i t e m s by c om pa ri s ons of ke ys m us t do a t l e a s t \u0000 lg n ! \u0000 , or a pproxi m a t e l y \u0000 n lg n - 1.443 n \u0000 , ke y c om pa ri s ons i n t he w ors t c a s e . ● N ot e : L e t L = n !, w hi c h i s t he num be r of l e a ve s , t he n L \u0000 2 h , w he re h i s t he he i ght of t he t re e , t ha t i s h \u0000 \u0000 lg L \u0000 = \u0000 lg n ! \u0000 ● F or t he a s ym pt ot i c be ha vi or: de ri ve d us i ng: 2-T re e ● 2-T re e ● Com m on Bi na ry T re e i nt e rna l node s e xt e rna l node s no c hi l d a ny t ype Bot h l e ft a nd ri ght c hi l dre n of t he s e node s a re e m pt y t re e E xt e rna l P a t h L e ngt h(E P L ) ● T he EP L of a 2-t re e t i s de fi ne d a s fol l ow s : ● [Ba s e c a s e ] 0 for a s i ngl e e xt e rna l node ● [Re c urs i on] t i s non-l e a f w i t h s ub-t re e s L a nd R , t he n t he s um of: ● t he e xt e rna l pa t h l e ngt h of L ; ● t he num be r of e xt e rna l node of L ; ● t he e xt e rna l pa t h l e ngt h of R ; ● t he num be r of e xt e rna l node of R ; P rope rt i e s of E P L ● Let t i s a 2-t re e , t he n t he e pl of t i s t he s um of t he pa t hs from t he root t o e a c h e xt e rna l node . ● e pl \u0000 m l g( m ), w he re m i s t he num be r of e xt e rna l node s i n t ● e pl = e pl L + e pl R +m \u0000 m L l g( m L )+ m R l g( m R )+ m , ● not e f (x)+ f (y) \u0000 2 f ((x+y)/ 2) for f( x )= x lg x ● s o, e pl \u0000 2(( m L + m R )/ 2)l g(( m L + m R )/ 2)+ m = m (l g( m )-1)+ m = m lg m . L ow e r Bound for A ve ra ge Be ha vi or ● S i nc e a de c i s i on t re e w i t h L l e a ve s i s a 2-t re e , t he a ve ra ge pa t h l e ngt h from t he root t o a l e a f i s . ● T he t re e s t ha t m i ni m i z e e pl a re a s ba l a nc e d a s pos s i bl e . ● Re c a l l t ha t e pl \u0000 L l g( L ). ● Th e or e m : T he a ve ra ge num be r of c om pa ri s on done by a n a l gori t hm t o s ort n i t e m s by c om pa ri s on of ke ys i s a t least l g( n !), w hi c h i s a bout n lg n -1.443 n . t o be prove d Re duc i ng E xt e rna l P a t h L e ngt h A s s um i ng t ha t h - k >1, w he n c a l c ul a t i ng e pl , h + h + k i s re pl a c e d by ( h -1)+2( k +1). T he ne t c ha nge i n e pl i s k - h +1<0, t ha t i s , t he e pl de c re a s e s . S o, m or e bal an c e d 2-t r e e h as s m al l e r e pl . X Y X Y l e ve l k l e ve l h - 1 l e ve l h l e ve l k +1 M e r ge s ort H a s O pt i m a l A ve ra ge P e rform a nc e ● W e ha ve prove d t ha t t he a ve ra ge num be r of c om pa ri s ons done by a n a l gori t hm t o s ort n i t e m s by c om pa ri s on of ke ys i s a t l e a s t a bout n lg n -1.443 n ● T he w or s t c om pl e xi t y of m e r ge s ort i s i n \u0000( n lg n ) ● But , t he a ve ra ge pe rform a nc e c a n not be w ors e t he t he w ors t c a s e pe rform a nc e . ● S o, m e r ge s ort i s opt i m a l a s for i t s a ve ra ge pe rform a nc e . H om e A s s i gnm e nt ● pp.212- ● 4.24 ● 4.25 ● 4.27 ● 4.29 ● 4.30 ● 4.32 Cha ra c t e ri s t i c s of t he D e c i s i on T re e ● F or a s e que nc e of n di s t i nc t e l e m e nt s , t he re a re n! di f fe re nt pe rm ut a t i on, s o, t he de c i s i on t re e ha s a t l e a s t n! l e a ve s , a nd e xa c t l y n! l e a ve s c a n be re a c he d from t he root . S o, for t he purpos e of l ow e r bounds e va l ua t i on, w e us e t re e s w i t h e xa c t l y n! l e a ve s . ● T he num be r of c om pa ri s on done i n t he wor s t c as e i s t he he i ght of t he t re e . ● T he av e r age num be r of c om pa ri s on done i s t he a ve ra ge of t he l e ngt hs of a l l pa t hs from t he root t o a l e a f. L ow e r Bound for W ors t Ca s e ● T h e or e m : A ny a l gori t hm t o s ort n i t e m s by c om pa ri s ons of ke ys m us t do a t l e a s t \u0000 lg n ! \u0000 , or a pproxi m a t e l y \u0000 n lg n - 1.443 n \u0000 , ke y c om pa ri s ons i n t he w ors t c a s e . ● N ot e : L e t L = n !, w hi c h i s t he num be r of l e a ve s , t he n L \u0000 2 h , w he re h i s t he he i ght of t he t re e , t ha t i s h \u0000 \u0000 lg L \u0000 = \u0000 lg n ! \u0000 ● F or t he a s ym pt ot i c be ha vi or: de ri ve d us i ng: 2-T re e ● 2-T re e ● Com m on Bi na ry T re e i nt e rna l node s e xt e rna l node s no c hi l d a ny t ype Bot h l e ft a nd ri ght c hi l dre n of t he s e node s a re e m pt y t re e E xt e rna l P a t h L e ngt h(E P L ) ● T he EP L of a 2-t re e t i s de fi ne d a s fol l ow s : ● [Ba s e c a s e ] 0 for a s i ngl e e xt e rna l node ● [Re c urs i on] t i s non-l e a f w i t h s ub-t re e s L a nd R , t he n t he s um of: ● t he e xt e rna l pa t h l e ngt h of L ; ● t he num be r of e xt e rna l node of L ; ● t he e xt e rna l pa t h l e ngt h of R ; ● t he num be r of e xt e rna l node of R ; P rope rt i e s of E P L ● Let t i s a 2-t re e , t he n t he e pl of t i s t he s um of t he pa t hs from t he root t o e a c h e xt e rna l node . ● e pl \u0000 m l g( m ), w he re m i s t he num be r of e xt e rna l node s i n t ● e pl = e pl L + e pl R +m \u0000 m L l g( m L )+ m R l g( m R )+ m , ● not e f (x)+ f (y) \u0000 2 f ((x+y)/ 2) for f( x )= x lg x ● s o, e pl \u0000 2(( m L + m R )/ 2)l g(( m L + m R )/ 2)+ m = m (l g( m )-1)+ m = m lg m . L ow e r Bound for A ve ra ge Be ha vi or ● S i nc e a de c i s i on t re e w i t h L l e a ve s i s a 2-t re e , t he a ve ra ge pa t h l e ngt h from t he root t o a l e a f i s . ● T he t re e s t ha t m i ni m i z e e pl a re a s ba l a nc e d a s pos s i bl e . ● Re c a l l t ha t e pl \u0000 L l g( L ). ● Th e or e m : T he a ve ra ge num be r of c om pa ri s on done by a n a l gori t hm t o s ort n i t e m s by c om pa ri s on of ke ys i s a t least l g( n !), w hi c h i s a bout n lg n -1.443 n . t o be prove d Re duc i ng E xt e rna l P a t h L e ngt h A s s um i ng t ha t h - k >1, w he n c a l c ul a t i ng e pl , h + h + k i s re pl a c e d by ( h -1)+2( k +1). T he ne t c ha nge i n e pl i s k - h +1<0, t ha t i s , t he e pl de c re a s e s . S o, m or e bal an c e d 2-t r e e h as s m al l e r e pl . X Y X Y l e ve l k l e ve l h - 1 l e ve l h l e ve l k +1 M e r ge s ort H a s O pt i m a l A ve ra ge P e rform a nc e ● W e ha ve prove d t ha t t he a ve ra ge num be r of c om pa ri s ons done by a n a l gori t hm t o s ort n i t e m s by c om pa ri s on of ke ys i s a t l e a s t a bout n lg n -1.443 n ● T he w or s t c om pl e xi t y of m e r ge s ort i s i n \u0000( n lg n ) ● But , t he a ve ra ge pe rform a nc e c a n not be w ors e t he t he w ors t c a s e pe rform a nc e . ● S o, m e r ge s ort i s opt i m a l a s for i t s a ve ra ge pe rform a nc e . H om e A s s i gnm e nt ● pp.212- ● 4.24 ● 4.25 ● 4.27 ● 4.29 ● 4.30 ● 4.32 ( 也 是 ⽐较 次 牧 , 从 叶 到 根 路径 和 6 9 % 2 - 1 2 + 1 : 5 % % 2 1 2 - 1 2 - 1 2 8 ( 叶 节点 externalpath-D-%6F.PL/2 做 外部 ⻓ 2 , 外 节 缸 就是 平均 复杂 度 Cha ra c t e ri s t i c s of t he D e c i s i on T re e ● F or a s e que nc e of n di s t i nc t e l e m e nt s , t he re a re n! di f fe re nt pe rm ut a t i on, s o, t he de c i s i on t re e ha s a t l e a s t n! l e a ve s , a nd e xa c t l y n! l e a ve s c a n be re a c he d from t he root . S o, for t he purpos e of l ow e r bounds e va l ua t i on, w e us e t re e s w i t h e xa c t l y n! l e a ve s . ● T he num be r of c om pa ri s on done i n t he wor s t c as e i s t he he i ght of t he t re e . ● T he av e r age num be r of c om pa ri s on done i s t he a ve ra ge of t he l e ngt hs of a l l pa t hs from t he root t o a l e a f. L ow e r Bound for W ors t Ca s e ● T h e or e m : A ny a l gori t hm t o s ort n i t e m s by c om pa ri s ons of ke ys m us t do a t l e a s t \u0000 lg n ! \u0000 , or a pproxi m a t e l y \u0000 n lg n - 1.443 n \u0000 , ke y c om pa ri s ons i n t he w ors t c a s e . ● N ot e : L e t L = n !, w hi c h i s t he num be r of l e a ve s , t he n L \u0000 2 h , w he re h i s t he he i ght of t he t re e , t ha t i s h \u0000 \u0000 lg L \u0000 = \u0000 lg n ! \u0000 ● F or t he a s ym pt ot i c be ha vi or: de ri ve d us i ng: 2-T re e ● 2-T re e ● Com m on Bi na ry T re e i nt e rna l node s e xt e rna l node s no c hi l d a ny t ype Bot h l e ft a nd ri ght c hi l dre n of t he s e node s a re e m pt y t re e E xt e rna l P a t h L e ngt h(E P L ) ● T he EP L of a 2-t re e t i s de fi ne d a s fol l ow s : ● [Ba s e c a s e ] 0 for a s i ngl e e xt e rna l node ● [Re c urs i on] t i s non-l e a f w i t h s ub-t re e s L a nd R , t he n t he s um of: ● t he e xt e rna l pa t h l e ngt h of L ; ● t he num be r of e xt e rna l node of L ; ● t he e xt e rna l pa t h l e ngt h of R ; ● t he num be r of e xt e rna l node of R ; P rope rt i e s of E P L ● Let t i s a 2-t re e , t he n t he e pl of t i s t he s um of t he pa t hs from t he root t o e a c h e xt e rna l node . ● e pl \u0000 m l g( m ), w he re m i s t he num be r of e xt e rna l node s i n t ● e pl = e pl L + e pl R +m \u0000 m L l g( m L )+ m R l g( m R )+ m , ● not e f (x)+ f (y) \u0000 2 f ((x+y)/ 2) for f( x )= x lg x ● s o, e pl \u0000 2(( m L + m R )/ 2)l g(( m L + m R )/ 2)+ m = m (l g( m )-1)+ m = m lg m . L ow e r Bound for A ve ra ge Be ha vi or ● S i nc e a de c i s i on t re e w i t h L l e a ve s i s a 2-t re e , t he a ve ra ge pa t h l e ngt h from t he root t o a l e a f i s . ● T he t re e s t ha t m i ni m i z e e pl a re a s ba l a nc e d a s pos s i bl e . ● Re c a l l t ha t e pl \u0000 L l g( L ). ● Th e or e m : T he a ve ra ge num be r of c om pa ri s on done by a n a l gori t hm t o s ort n i t e m s by c om pa ri s on of ke ys i s a t least l g( n !), w hi c h i s a bout n lg n -1.443 n . t o be prove d Re duc i ng E xt e rna l P a t h L e ngt h A s s um i ng t ha t h - k >1, w he n c a l c ul a t i ng e pl , h + h + k i s re pl a c e d by ( h -1)+2( k +1). T he ne t c ha nge i n e pl i s k - h +1<0, t ha t i s , t he e pl de c re a s e s . S o, m or e bal an c e d 2-t r e e h as s m al l e r e pl . X Y X Y l e ve l k l e ve l h - 1 l e ve l h l e ve l k +1 M e r ge s ort H a s O pt i m a l A ve ra ge P e rform a nc e ● W e ha ve prove d t ha t t he a ve ra ge num be r of c om pa ri s ons done by a n a l gori t hm t o s ort n i t e m s by c om pa ri s on of ke ys i s a t l e a s t a bout n lg n -1.443 n ● T he w or s t c om pl e xi t y of m e r ge s ort i s i n \u0000( n lg n ) ● But , t he a ve ra ge pe rform a nc e c a n not be w ors e t he t he w ors t c a s e pe rform a nc e . ● S o, m e r ge s ort i s opt i m a l a s for i t s a ve ra ge pe rform a nc e . H om e A s s i gnm e nt ● pp.212- ● 4.24 ● 4.25 ● 4.27 ● 4.29 ● 4.30 ● 4.32 完全 情况 巍 1 平衡⽊ 对 时 取 等 ) - l m m R ' z 7 7 Cha ra c t e ri s t i c s of t he D e c i s i on T re e ● F or a s e que nc e of n di s t i nc t e l e m e nt s , t he re a re n! di f fe re nt pe rm ut a t i on, s o, t he de c i s i on t re e ha s a t l e a s t n! l e a ve s , a nd e xa c t l y n! l e a ve s c a n be re a c he d from t he root . S o, for t he purpos e of l ow e r bounds e va l ua t i on, w e us e t re e s w i t h e xa c t l y n! l e a ve s . ● T he num be r of c om pa ri s on done i n t he wor s t c as e i s t he he i ght of t he t re e . ● T he av e r age num be r of c om pa ri s on done i s t he a ve ra ge of t he l e ngt hs of a l l pa t hs from t he root t o a l e a f. L ow e r Bound for W ors t Ca s e ● T h e or e m : A ny a l gori t hm t o s ort n i t e m s by c om pa ri s ons of ke ys m us t do a t l e a s t \u0000 lg n ! \u0000 , or a pproxi m a t e l y \u0000 n lg n - 1.443 n \u0000 , ke y c om pa ri s ons i n t he w ors t c a s e . ● N ot e : L e t L = n !, w hi c h i s t he num be r of l e a ve s , t he n L \u0000 2 h , w he re h i s t he he i ght of t he t re e , t ha t i s h \u0000 \u0000 lg L \u0000 = \u0000 lg n ! \u0000 ● F or t he a s ym pt ot i c be ha vi or: de ri ve d us i ng: 2-T re e ● 2-T re e ● Com m on Bi na ry T re e i nt e rna l node s e xt e rna l node s no c hi l d a ny t ype Bot h l e ft a nd ri ght c hi l dre n of t he s e node s a re e m pt y t re e E xt e rna l P a t h L e ngt h(E P L ) ● T he EP L of a 2-t re e t i s de fi ne d a s fol l ow s : ● [Ba s e c a s e ] 0 for a s i ngl e e xt e rna l node ● [Re c urs i on] t i s non-l e a f w i t h s ub-t re e s L a nd R , t he n t he s um of: ● t he e xt e rna l pa t h l e ngt h of L ; ● t he num be r of e xt e rna l node of L ; ● t he e xt e rna l pa t h l e ngt h of R ; ● t he num be r of e xt e rna l node of R ; P rope rt i e s of E P L ● Let t i s a 2-t re e , t he n t he e pl of t i s t he s um of t he pa t hs from t he root t o e a c h e xt e rna l node . ● e pl \u0000 m l g( m ), w he re m i s t he num be r of e xt e rna l node s i n t ● e pl = e pl L + e pl R +m \u0000 m L l g( m L )+ m R l g( m R )+ m , ● not e f (x)+ f (y) \u0000 2 f ((x+y)/ 2) for f( x )= x lg x ● s o, e pl \u0000 2(( m L + m R )/ 2)l g(( m L + m R )/ 2)+ m = m (l g( m )-1)+ m = m lg m . L ow e r Bound for A ve ra ge Be ha vi or ● S i nc e a de c i s i on t re e w i t h L l e a ve s i s a 2-t re e , t he a ve ra ge pa t h l e ngt h from t he root t o a l e a f i s . ● T he t re e s t ha t m i ni m i z e e pl a re a s ba l a nc e d a s pos s i bl e . ● Re c a l l t ha t e pl \u0000 L l g( L ). ● Th e or e m : T he a ve ra ge num be r of c om pa ri s on done by a n a l gori t hm t o s ort n i t e m s by c om pa ri s on of ke ys i s a t least l g( n !), w hi c h i s a bout n lg n -1.443 n . t o be prove d Re duc i ng E xt e rna l P a t h L e ngt h A s s um i ng t ha t h - k >1, w he n c a l c ul a t i ng e pl , h + h + k i s re pl a c e d by ( h -1)+2( k +1). T he ne t c ha nge i n e pl i s k - h +1<0, t ha t i s , t he e pl de c re a s e s . S o, m or e bal an c e d 2-t r e e h as s m al l e r e pl . X Y X Y l e ve l k l e ve l h - 1 l e ve l h l e ve l k +1 M e r ge s ort H a s O pt i m a l A ve ra ge P e rform a nc e ● W e ha ve prove d t ha t t he a ve ra ge num be r of c om pa ri s ons done by a n a l gori t hm t o s ort n i t e m s by c om pa ri s on of ke ys i s a t l e a s t a bout n lg n -1.443 n ● T he w or s t c om pl e xi t y of m e r ge s ort i s i n \u0000( n lg n ) ● But , t he a ve ra ge pe rform a nc e c a n not be w ors e t he t he w ors t c a s e pe rform a nc e . ● S o, m e r ge s ort i s opt i m a l a s for i t s a ve ra ge pe rform a nc e . H om e A s s i gnm e nt ● pp.212- ● 4.24 ● 4.25 ● 4.27 ● 4.29 ● 4.30 ● 4.32 ≥ 0 是 ≥ 414 lin ! Cha ra c t e ri s t i c s of t he D e c i s i on T re e ● F or a s e que nc e of n di s t i nc t e l e m e nt s , t he re a re n! di f fe re nt pe rm ut a t i on, s o, t he de c i s i on t re e ha s a t l e a s t n! l e a ve s , a nd e xa c t l y n! l e a ve s c a n be re a c he d from t he root . S o, for t he purpos e of l ow e r bounds e va l ua t i on, w e us e t re e s w i t h e xa c t l y n! l e a ve s . ● T he num be r of c om pa ri s on done i n t he wor s t c as e i s t he he i ght of t he t re e . ● T he av e r age num be r of c om pa ri s on done i s t he a ve ra ge of t he l e ngt hs of a l l pa t hs from t he root t o a l e a f. L ow e r Bound for W ors t Ca s e ● T h e or e m : A ny a l gori t hm t o s ort n i t e m s by c om pa ri s ons of ke ys m us t do a t l e a s t \u0000 lg n ! \u0000 , or a pproxi m a t e l y \u0000 n lg n - 1.443 n \u0000 , ke y c om pa ri s ons i n t he w ors t c a s e . ● N ot e : L e t L = n !, w hi c h i s t he num be r of l e a ve s , t he n L \u0000 2 h , w he re h i s t he he i ght of t he t re e , t ha t i s h \u0000 \u0000 lg L \u0000 = \u0000 lg n ! \u0000 ● F or t he a s ym pt ot i c be ha vi or: de ri ve d us i ng: 2-T re e ● 2-T re e ● Com m on Bi na ry T re e i nt e rna l node s e xt e rna l node s no c hi l d a ny t ype Bot h l e ft a nd ri ght c hi l dre n of t he s e node s a re e m pt y t re e E xt e rna l P a t h L e ngt h(E P L ) ● T he EP L of a 2-t re e t i s de fi ne d a s fol l ow s : ● [Ba s e c a s e ] 0 for a s i ngl e e xt e rna l node ● [Re c urs i on] t i s non-l e a f w i t h s ub-t re e s L a nd R , t he n t he s um of: ● t he e xt e rna l pa t h l e ngt h of L ; ● t he num be r of e xt e rna l node of L ; ● t he e xt e rna l pa t h l e ngt h of R ; ● t he num be r of e xt e rna l node of R ; P rope rt i e s of E P L ● Let t i s a 2-t re e , t he n t he e pl of t i s t he s um of t he pa t hs from t he root t o e a c h e xt e rna l node . ● e pl \u0000 m l g( m ), w he re m i s t he num be r of e xt e rna l node s i n t ● e pl = e pl L + e pl R +m \u0000 m L l g( m L )+ m R l g( m R )+ m , ● not e f (x)+ f (y) \u0000 2 f ((x+y)/ 2) for f( x )= x lg x ● s o, e pl \u0000 2(( m L + m R )/ 2)l g(( m L + m R )/ 2)+ m = m (l g( m )-1)+ m = m lg m . L ow e r Bound for A ve ra ge Be ha vi or ● S i nc e a de c i s i on t re e w i t h L l e a ve s i s a 2-t re e , t he a ve ra ge pa t h l e ngt h from t he root t o a l e a f i s . ● T he t re e s t ha t m i ni m i z e e pl a re a s ba l a nc e d a s pos s i bl e . ● Re c a l l t ha t e pl \u0000 L l g( L ). ● Th e or e m : T he a ve ra ge num be r of c om pa ri s on done by a n a l gori t hm t o s ort n i t e m s by c om pa ri s on of ke ys i s a t least l g( n !), w hi c h i s a bout n lg n -1.443 n . t o be prove d Re duc i ng E xt e rna l P a t h L e ngt h A s s um i ng t ha t h - k >1, w he n c a l c ul a t i ng e pl , h + h + k i s re pl a c e d by ( h -1)+2( k +1). T he ne t c ha nge i n e pl i s k - h +1<0, t ha t i s , t he e pl de c re a s e s . S o, m or e bal an c e d 2-t r e e h as s m al l e r e pl . X Y X Y l e ve l k l e ve l h - 1 l e ve l h l e ve l k +1 M e r ge s ort H a s O pt i m a l A ve ra ge P e rform a nc e ● W e ha ve prove d t ha t t he a ve ra ge num be r of c om pa ri s ons done by a n a l gori t hm t o s ort n i t e m s by c om pa ri s on of ke ys i s a t l e a s t a bout n lg n -1.443 n ● T he w or s t c om pl e xi t y of m e r ge s ort i s i n \u0000( n lg n ) ● But , t he a ve ra ge pe rform a nc e c a n not be w ors e t he t he w ors t c a s e pe rform a nc e . ● S o, m e r ge s ort i s opt i m a l a s for i t s a ve ra ge pe rform a nc e . H om e A s s i gnm e nt ● pp.212- ● 4.24 ● 4.25 ● 4.27 ● 4.29 ● 4.30 ● 4.32 Cha ra c t e ri s t i c s of t he D e c i s i on T re e ● F or a s e que nc e of n di s t i nc t e l e m e nt s , t he re a re n! di f fe re nt pe rm ut a t i on, s o, t he de c i s i on t re e ha s a t l e a s t n! l e a ve s , a nd e xa c t l y n! l e a ve s c a n be re a c he d from t he root . S o, for t he purpos e of l ow e r bounds e va l ua t i on, w e us e t re e s w i t h e xa c t l y n! l e a ve s . ● T he num be r of c om pa ri s on done i n t he wor s t c as e i s t he he i ght of t he t re e . ● T he av e r age num be r of c om pa ri s on done i s t he a ve ra ge of t he l e ngt hs of a l l pa t hs from t he root t o a l e a f. L ow e r Bound for W ors t Ca s e ● T h e or e m : A ny a l gori t hm t o s ort n i t e m s by c om pa ri s ons of ke ys m us t do a t l e a s t \u0000 lg n ! \u0000 , or a pproxi m a t e l y \u0000 n lg n - 1.443 n \u0000 , ke y c om pa ri s ons i n t he w ors t c a s e . ● N ot e : L e t L = n !, w hi c h i s t he num be r of l e a ve s , t he n L \u0000 2 h , w he re h i s t he he i ght of t he t re e , t ha t i s h \u0000 \u0000 lg L \u0000 = \u0000 lg n ! \u0000 ● F or t he a s ym pt ot i c be ha vi or: de ri ve d us i ng: 2-T re e ● 2-T re e ● Com m on Bi na ry T re e i nt e rna l node s e xt e rna l node s no c hi l d a ny t ype Bot h l e ft a nd ri ght c hi l dre n of t he s e node s a re e m pt y t re e E xt e rna l P a t h L e ngt h(E P L ) ● T he EP L of a 2-t re e t i s de fi ne d a s fol l ow s : ● [Ba s e c a s e ] 0 for a s i ngl e e xt e rna l node ● [Re c urs i on] t i s non-l e a f w i t h s ub-t re e s L a nd R , t he n t he s um of: ● t he e xt e rna l pa t h l e ngt h of L ; ● t he num be r of e xt e rna l node of L ; ● t he e xt e rna l pa t h l e ngt h of R ; ● t he num be r of e xt e rna l node of R ; P rope rt i e s of E P L ● Let t i s a 2-t re e , t he n t he e pl of t i s t he s um of t he pa t hs from t he root t o e a c h e xt e rna l node . ● e pl \u0000 m l g( m ), w he re m i s t he num be r of e xt e rna l node s i n t ● e pl = e pl L + e pl R +m \u0000 m L l g( m L )+ m R l g( m R )+ m , ● not e f (x)+ f (y) \u0000 2 f ((x+y)/ 2) for f( x )= x lg x ● s o, e pl \u0000 2(( m L + m R )/ 2)l g(( m L + m R )/ 2)+ m = m (l g( m )-1)+ m = m lg m . L ow e r Bound for A ve ra ge Be ha vi or ● S i nc e a de c i s i on t re e w i t h L l e a ve s i s a 2-t re e , t he a ve ra ge pa t h l e ngt h from t he root t o a l e a f i s . ● T he t re e s t ha t m i ni m i z e e pl a re a s ba l a nc e d a s pos s i bl e . ● Re c a l l t ha t e pl \u0000 L l g( L ). ● Th e or e m : T he a ve ra ge num be r of c om pa ri s on done by a n a l gori t hm t o s ort n i t e m s by c om pa ri s on of ke ys i s a t least l g( n !), w hi c h i s a bout n lg n -1.443 n . t o be prove d Re duc i ng E xt e rna l P a t h L e ngt h A s s um i ng t ha t h - k >1, w he n c a l c ul a t i ng e pl , h + h + k i s re pl a c e d by ( h -1)+2( k +1). T he ne t c ha nge i n e pl i s k - h +1<0, t ha t i s , t he e pl de c re a s e s . S o, m or e bal an c e d 2-t r e e h as s m al l e r e pl . X Y X Y l e ve l k l e ve l h - 1 l e ve l h l e ve l k +1 M e r ge s ort H a s O pt i m a l A ve ra ge P e rform a nc e ● W e ha ve prove d t ha t t he a ve ra ge num be r of c om pa ri s ons done by a n a l gori t hm t o s ort n i t e m s by c om pa ri s on of ke ys i s a t l e a s t a bout n lg n -1.443 n ● T he w or s t c om pl e xi t y of m e r ge s ort i s i n \u0000( n lg n ) ● But , t he a ve ra ge pe rform a nc e c a n not be w ors e t he t he w ors t c a s e pe rform a nc e . ● S o, m e r ge s ort i s opt i m a l a s for i t s a ve ra ge pe rform a nc e . H om e A s s i gnm e nt ● pp.212- ● 4.24 ● 4.25 ● 4.27 ● 4.29 ● 4.30 ● 4.32 ④ Cha ra c t e ri s t i c s of t he D e c i s i on T re e ● F or a s e que nc e of n di s t i nc t e l e m e nt s , t he re a re n! di f fe re nt pe rm ut a t i on, s o, t he de c i s i on t re e ha s a t l e a s t n! l e a ve s , a nd e xa c t l y n! l e a ve s c a n be re a c he d from t he root . S o, for t he purpos e of l ow e r bounds e va l ua t i on, w e us e t re e s w i t h e xa c t l y n! l e a ve s . ● T he num be r of c om pa ri s on done i n t he wor s t c as e i s t he he i ght of t he t re e . ● T he av e r age num be r of c om pa ri s on done i s t he a ve ra ge of t he l e ngt hs of a l l pa t hs from t he root t o a l e a f. L ow e r Bound for W ors t Ca s e ● T h e or e m : A ny a l gori t hm t o s ort n i t e m s by c om pa ri s ons of ke ys m us t do a t l e a s t \u0000 lg n ! \u0000 , or a pproxi m a t e l y \u0000 n lg n - 1.443 n \u0000 , ke y c om pa ri s ons i n t he w ors t c a s e . ● N ot e : L e t L = n !, w hi c h i s t he num be r of l e a ve s , t he n L \u0000 2 h , w he re h i s t he he i ght of t he t re e , t ha t i s h \u0000 \u0000 lg L \u0000 = \u0000 lg n ! \u0000 ● F or t he a s ym pt ot i c be ha vi or: de ri ve d us i ng: 2-T re e ● 2-T re e ● Com m on Bi na ry T re e i nt e rna l node s e xt e rna l node s no c hi l d a ny t ype Bot h l e ft a nd ri ght c hi l dre n of t he s e node s a re e m pt y t re e E xt e rna l P a t h L e ngt h(E P L ) ● T he EP L of a 2-t re e t i s de fi ne d a s fol l ow s : ● [Ba s e c a s e ] 0 for a s i ngl e e xt e rna l node ● [Re c urs i on] t i s non-l e a f w i t h s ub-t re e s L a nd R , t he n t he s um of: ● t he e xt e rna l pa t h l e ngt h of L ; ● t he num be r of e xt e rna l node of L ; ● t he e xt e rna l pa t h l e ngt h of R ; ● t he num be r of e xt e rna l node of R ; P rope rt i e s of E P L ● Let t i s a 2-t re e , t he n t he e pl of t i s t he s um of t he pa t hs from t he root t o e a c h e xt e rna l node . ● e pl \u0000 m l g( m ), w he re m i s t he num be r of e xt e rna l node s i n t ● e pl = e pl L + e pl R +m \u0000 m L l g( m L )+ m R l g( m R )+ m , ● not e f (x)+ f (y) \u0000 2 f ((x+y)/ 2) for f( x )= x lg x ● s o, e pl \u0000 2(( m L + m R )/ 2)l g(( m L + m R )/ 2)+ m = m (l g( m )-1)+ m = m lg m . L ow e r Bound for A ve ra ge Be ha vi or ● S i nc e a de c i s i on t re e w i t h L l e a ve s i s a 2-t re e , t he a ve ra ge pa t h l e ngt h from t he root t o a l e a f i s . ● T he t re e s t ha t m i ni m i z e e pl a re a s ba l a nc e d a s pos s i bl e . ● Re c a l l t ha t e pl \u0000 L l g( L ). ● Th e or e m : T he a ve ra ge num be r of c om pa ri s on done by a n a l gori t hm t o s ort n i t e m s by c om pa ri s on of ke ys i s a t least l g( n !), w hi c h i s a bout n lg n -1.443 n . t o be prove d Re duc i ng E xt e rna l P a t h L e ngt h A s s um i ng t ha t h - k >1, w he n c a l c ul a t i ng e pl , h + h + k i s re pl a c e d by ( h -1)+2( k +1). T he ne t c ha nge i n e pl i s k - h +1<0, t ha t i s , t he e pl de c re a s e s . S o, m or e bal an c e d 2-t r e e h as s m al l e r e pl . X Y X Y l e ve l k l e ve l h - 1 l e ve l h l e ve l k +1 M e r ge s ort H a s O pt i m a l A ve ra ge P e rform a nc e ● W e ha ve prove d t ha t t he a ve ra ge num be r of c om pa ri s ons done by a n a l gori t hm t o s ort n i t e m s by c om pa ri s on of ke ys i s a t l e a s t a bout n lg n -1.443 n ● T he w or s t c om pl e xi t y of m e r ge s ort i s i n \u0000( n lg n ) ● But , t he a ve ra ge pe rform a nc e c a n not be w ors e t he t he w ors t c a s e pe rform a nc e . ● S o, m e r ge s ort i s opt i m a l a s for i t s a ve ra ge pe rform a nc e . H om e A s s i gnm e nt ● pp.212- ● 4.24 ● 4.25 ● 4.27 ● 4.29 ● 4.30 ● 4.32","libVersion":"0.2.4","langs":""}