{"path":"pdf/算法设计与分析/第3章 动态规划.pdf","text":"第第第 333 章章章 动 态 规 划动 态 规 划动 态 规 划 1 • 动 态 规 划 算 法 与 分 治 法 类 似 ， 其 基 本 思 想 也 是 将 待 求 解 问 题 分 解 成 若 ⼲ 个 ⼦ 问 题 算 法 总 体 思 想算 法 总 体 思 想算 法 总 体 思 想 n T ( n / 2 )T ( n / 2 )T ( n / 2 ) T ( n / 2 )T ( n / 2 )T ( n / 2 ) T ( n / 2 )T ( n / 2 )T ( n / 2 ) T ( n / 2 )T ( n / 2 )T ( n / 2 ) T ( n ) = 2 • 但 是 经 分 解 得 到 的 ⼦ 问 题 往 往 不 是 互 相 独 ⽴ 的 。 不 同 ⼦ 问 题 的 数 ⽬ 常 常 只 有 多 项 式 量 级 。 在 ⽤ 分 治 法 求 解 时 ， 有 些 ⼦ 问 题 被 重 复 计 算 了 许 多 次 。 算 法 总 体 思 想算 法 总 体 思 想算 法 总 体 思 想 n T ( n ) = n / 2 T ( n / 4 )T ( n / 4 )T ( n / 4 ) T ( n / 4 )T ( n / 4 )T ( n / 4 ) T ( n / 4 )T ( n / 4 )T ( n / 4 ) T ( n / 4 )T ( n / 4 )T ( n / 4 ) n / 2 T ( n / 4 )T ( n / 4 )T ( n / 4 ) T ( n / 4 )T ( n / 4 )T ( n / 4 ) T ( n / 4 )T ( n / 4 )T ( n / 4 ) T ( n / 4 )T ( n / 4 )T ( n / 4 ) n / 2 T ( n / 4 )T ( n / 4 )T ( n / 4 ) T ( n / 4 )T ( n / 4 )T ( n / 4 ) T ( n / 4 )T ( n / 4 )T ( n / 4 ) T ( n / 4 )T ( n / 4 )T ( n / 4 ) n / 2 T ( n / 4 )T ( n / 4 )T ( n / 4 ) T ( n / 4 )T ( n / 4 )T ( n / 4 ) T ( n / 4 )T ( n / 4 )T ( n / 4 ) T ( n / 4 )T ( n / 4 )T ( n / 4 ) 3 • 如 果 能 够 保 存 已 解 决 的 ⼦ 问 题 的 答 案 ， ⽽ 在 需 要 时 再 找 出 已 求 得 的 答 案 ， 就 可 以 避 免 ⼤ 量 重 复 计 算 ， 从 ⽽ 得 到 多 项 式 时 间 算 法 。 算 法 总 体 思 想算 法 总 体 思 想算 法 总 体 思 想 n = n / 2 T ( n / 4 )T ( n / 4 )T ( n / 4 ) T ( n / 4 )T ( n / 4 )T ( n / 4 ) T ( n / 4 )T ( n / 4 )T ( n / 4 ) T ( n / 4 )T ( n / 4 )T ( n / 4 ) n / 2 n / 2 T ( n / 4 )T ( n / 4 )T ( n / 4 ) T ( n / 4 )T ( n / 4 )T ( n / 4 ) n / 2 T ( n / 4 )T ( n / 4 )T ( n / 4 ) T ( n / 4 )T ( n / 4 )T ( n / 4 ) T ( n / 4 )T ( n / 4 )T ( n / 4 )T ( n / 4 )T ( n / 4 )T ( n / 4 ) T ( n / 4 )T ( n / 4 )T ( n / 4 ) T ( n ) T h o s e w h o c a n n o t r e m e m b e r t h e p a s t a r e d o o m e d t o r e p e a t i t . - - - - - G e o r g e S a n t a y a n a , T h e l i f e o f R e a s o n , B o o k I : I n t r o d u c t i o n a n d R e a s o n i n C o m m o n S e n s e ( 1 9 0 5 ) 4 动 态 规 划 基 本 步 骤动 态 规 划 基 本 步 骤动 态 规 划 基 本 步 骤 • 找 出 最 优 解 的 性 质 ， 并 刻 划 其 结 构 特 征 。 • 递 归 地 定 义 最 优 值 。 • 以 ⾃ 底 向 上 的 ⽅ 式 计 算 出 最 优 值 。 • 根 据 计 算 最 优 值 时 得 到 的 信 息 ， 构 造 最 优 解 。 5 （ 1 ） 单 个 矩 阵 是 完 全 加 括 号 的 ； （ 2 ） 矩 阵 连 乘 积 是 完 全 加 括 号 的 ， 则 可 表 示 为 2 个 完 全 加 括 号 的 矩 阵 连 乘 积 和 的 乘 积 并 加 括 号 ， 即 1 6 0 0 0 , 1 0 5 0 0 , 3 6 0 0 0 , 8 7 5 0 0 , 3 4 5 0 0  完 全 加 括 号 的 矩 阵 连 乘 积 可 递 归 地 定 义 为 ：  设 有 四 个 矩 阵 ， 它 们 的 维 数 分 别 是 ：  总 共 有 五 中 完 全 加 括 号 的 ⽅ 式 完 全 加 括 号 的 矩 阵 连 乘 积完 全 加 括 号 的 矩 阵 连 乘 积完 全 加 括 号 的 矩 阵 连 乘 积 6 矩 阵 连 乘 问 题矩 阵 连 乘 问 题矩 阵 连 乘 问 题  给 定 n 个 矩 阵 ， 其 中 与 是 可 乘 的 ， 。 考 察 这 n 个 矩 阵 的 连 乘 积  由 于 矩 阵 乘 法 满 ⾜ 结 合 律 ， 所 以 计 算 矩 阵 的 连 乘 可 以 有 许 多 不 同 的 计 算 次 序 。 这 种 计 算 次 序 可 以 ⽤ 加 括 号 的 ⽅ 式 来 确 定 。  若 ⼀ 个 矩 阵 连 乘 积 的 计 算 次 序 完 全 确 定 ， 也 就 是 说 该 连 乘 积 已 完 全 加 括 号 ， 则 可 以 依 此 次 序 反 复 调 ⽤ 2 个 矩 阵 相 乘 的 标 准 算 法 计 算 出 矩 阵 连 乘 积 7 矩 阵 连 乘 问 题矩 阵 连 乘 问 题矩 阵 连 乘 问 题 给 定 n 个 矩 阵 ｛ A 1 , A 2 , … , A n ｝ ， 其 中 A i 与 A i + 1 是 可 乘 的 ， i = 1 ， 2 … ， n - 1 。 如 何 确 定 计 算 矩 阵 连 乘 积 的 计 算 次 序 ， 使 得 依 此 次 序 计 算 矩 阵 连 乘 积 需 要 的 数 乘 次 数 最 少 。  穷 举 法穷 举 法穷 举 法 ： 列 举 出 所 有 可 能 的 计 算 次 序 ， 并 计 算 出 每 ⼀ 种 计 算 次 序 相 应 需 要 的 数 乘 次 数 ， 从 中 找 出 ⼀ 种 数 乘 次 数 最 少 的 计 算 次 序 。 算 法 复 杂 度 分 析 ：算 法 复 杂 度 分 析 ：算 法 复 杂 度 分 析 ： 对 于 n 个 矩 阵 的 连 乘 积 ， 设 其 不 同 的 计 算 次 序 为 P ( n ) 。 由 于 每 种 加 括 号 ⽅ 式 都 可 以 分 解 为 两 个 ⼦ 矩 阵 的 加 括 号 问 题 ： ( A 1 . . . A k ) ( A k + 1 … A n ) 可 以 得 到 关 于 P ( n ) 的 递 推 式 如 下 ： 8 矩 阵 连 乘 问 题矩 阵 连 乘 问 题矩 阵 连 乘 问 题  穷 举 法穷 举 法穷 举 法  动 态 规 划动 态 规 划动 态 规 划 将 矩 阵 连 乘 积 简 记 为 A [ i : j ] ， 这 ⾥ i ≤ j 考 察 计 算 A [ i : j ] 的 最 优 计 算 次 序 。 设 这 个 计 算 次 序 在 矩 阵 A k 和 A k + 1 之 间 将 矩 阵 链 断 开 ， i ≤ k < j ， 则 其 相 应 完 全 加 括 号 ⽅ 式 为 计 算 量 ： A [ i : k ] 的 计 算 量 加 上 A [ k + 1 : j ] 的 计 算 量 ， 再 加 上 A [ i : k ] 和 A [ k + 1 : j ] 相 乘 的 计 算 量 9 • 特 征 ： 计 算 A [ i : j ] 的 最 优 次 序 所 包 含 的 计 算 矩 阵 ⼦ 链 A [ i : k ] 和 A [ k + 1 : j ] 的 次 序 也 是 最 优 的 。 • 矩 阵 连 乘 计 算 次 序 问 题 的 最 优 解 包 含 着 其 ⼦ 问 题 的 最 优 解 。 这 种 性 质 称 为 最 优 ⼦ 结 构 性 质最 优 ⼦ 结 构 性 质最 优 ⼦ 结 构 性 质 。 问 题 的 最 优 ⼦ 结 构 性 质 是 该 问 题 可 ⽤ 动 态 规 划 算 法 求 解 的 显 著 特 征 。 分 析 最 优 解 的 结 构分 析 最 优 解 的 结 构分 析 最 优 解 的 结 构 1 0 建 ⽴ 递 归 关 系建 ⽴ 递 归 关 系建 ⽴ 递 归 关 系  设 计 算 A [ i : j ] ， 1 ≤ i ≤ j ≤ n ， 所 需 要 的 最 少 数 乘 次 数 m [ i , j ] ， 则 原 问 题 的 最 优 值 为 m [ 1 , n ]  当 i = j 时 ， A [ i : j ] = A i ， 因 此 ， m [ i , i ] = 0 ， i = 1 , 2 , … , n  当 i < j 时 ，  可 以 递 归 地 定 义 m [ i , j ] 为 ： 这 ⾥ 的 维 数 为 的 位 置 只 有 种 可 能 1 1 计 算 最 优 值计 算 最 优 值计 算 最 优 值  对 于 1 ≤ i ≤ j ≤ n 不 同 的 有 序 对 ( i , j ) 对 应 于 不 同 的 ⼦ 问 题 。 因 此 ， 不 同 ⼦ 问 题 的 个 数 最 多 只 有  由 此 可 ⻅ ， 在 递 归 计 算 时 ， 许 多 ⼦ 问 题 被 重 复 计 算 多许 多 ⼦ 问 题 被 重 复 计 算 多许 多 ⼦ 问 题 被 重 复 计 算 多 次次次 。 这 也 是 该 问 题 可 ⽤ 动 态 规 划 算 法 求 解 的 ⼜ ⼀ 显 著 特 征 。  ⽤ 动 态 规 划 算 法 解 此 问 题 ， 可 依 据 其 递 归 式 以 ⾃ 底 向 上 的 ⽅ 式 进 ⾏ 计 算 。 在 计 算 过 程 中 ， 保 存 已 解 决 的 ⼦ 问 题 答 案 。 每 个 ⼦ 问 题 只 计 算 ⼀ 次 ， ⽽ 在 后 ⾯ 需 要 时 只 要 简 单 查 ⼀ 下 ， 从 ⽽ 避 免 ⼤ 量 的 重 复 计 算 ， 最 终 得 到 多 项 式 时 间 的 算 法 1 2 ⽤ 动 态 规 划 法 求 最 优 解⽤ 动 态 规 划 法 求 最 优 解⽤ 动 态 规 划 法 求 最 优 解 p u b l i c s t a t i c v o i d m a t r i x C h a i n ( i n t [ ] p , i n t [ ] [ ] m , i n t [ ] [ ] s ) { i n t n = p . l e n g t h - 1 ; f o r ( i n t i = 1 ; i < = n ; i + + ) m [ i ] [ i ] = 0 ; f o r ( i n t r = 2 ; r < = n ; r + + ) f o r ( i n t i = 1 ; i < = n - r + 1 ; i + + ) { i n t j = i + r - 1 ; m [ i ] [ j ] = m [ i + 1 ] [ j ] + p [ i - 1 ] * p [ i ] * p [ j ] ; s [ i ] [ j ] = i ; f o r ( i n t k = i + 1 ; k < j ; k + + ) { i n t t = m [ i ] [ k ] + m [ k + 1 ] [ j ] + p [ i - 1 ] * p [ k ] * p [ j ] ; i f ( t < m [ i ] [ j ] ) { m [ i ] [ j ] = t ; s [ i ] [ j ] = k ; } } } } A 1 A 2 A 3 A 4 A 5 A 6 3 0  3 5 3 5  1 5 1 5  5 5  1 0 1 0  2 0 2 0  2 5 算 法 复 杂 度 分 析 ：算 法 复 杂 度 分 析 ：算 法 复 杂 度 分 析 ： 算 法 m a t r i x C h a i n 的 主 要 计 算 量 取 决 于 算 法 中 对 r ， i 和 k 的 3 重 循 环 。 循 环 体 内 的 计 算 量 为 O ( 1 ) ， ⽽ 3 重 循 环 的 总 次 数 为 O ( n 3 ) 。 因 此 算 法 的 计 算 时 间 上 界 为 O ( n 3 ) 。 算 法 所 占 ⽤ 的 空 间 显 然 为 O ( n 2 ) 。 1 3 动 态 规 划 算 法 的 基 本 要 素动 态 规 划 算 法 的 基 本 要 素动 态 规 划 算 法 的 基 本 要 素 ⼀ 、 最 优 ⼦ 结 构⼀ 、 最 优 ⼦ 结 构⼀ 、 最 优 ⼦ 结 构 • 矩 阵 连 乘 计 算 次 序 问 题 的 最 优 解 包 含 着 其 ⼦ 问 题 的 最 优 解 。 这 种 性 质 称 为 最 优 ⼦ 结 构 性 质最 优 ⼦ 结 构 性 质最 优 ⼦ 结 构 性 质 。 • 在 分 析 问 题 的 最 优 ⼦ 结 构 性 质 时 ， 所 ⽤ 的 ⽅ 法 具 有 普 遍 性 ： ⾸ 先 假 设 由 问 题 的 最 优 解 导 出 的 ⼦ 问 题 的 解 不 是 最 优 的 ， 然 后 再 设 法 说 明 在 这 个 假 设 下 可 构 造 出 ⽐ 原 问 题 最 优 解 更 好 的 解 ， 从 ⽽ 导 致 ⽭ 盾 。 • 利 ⽤ 问 题 的 最 优 ⼦ 结 构 性 质 ， 以 ⾃ 底 向 上 的 ⽅ 式 递 归 地 从 ⼦ 问 题 的 最 优 解 逐 步 构 造 出 整 个 问 题 的 最 优 解 。 最 优 ⼦ 结 构 是 问 题 能 ⽤ 动 态 规 划 算 法 求 解 的 前 提 。 注 意 ： 同 ⼀ 个 问 题 可 以 有 多 种 ⽅ 式 刻 划 它 的 最 优 ⼦ 结 构 ， 有 些 表 示 ⽅ 法 的 求 解 速 度 更 快 （ 空 间 占 ⽤ ⼩ ， 问 题 的 维 度 低 ） 1 4 动 态 规 划 算 法 的 基 本 要 素动 态 规 划 算 法 的 基 本 要 素动 态 规 划 算 法 的 基 本 要 素 ⼆ 、 重 叠 ⼦ 问 题⼆ 、 重 叠 ⼦ 问 题⼆ 、 重 叠 ⼦ 问 题 • 递 归 算 法 求 解 问 题 时 ， 每 次 产 ⽣ 的 ⼦ 问 题 并 不 总 是 新 问 题 ， 有 些 ⼦ 问 题 被 反 复 计 算 多 次 。 这 种 性 质 称 为 ⼦ 问 题 的 重 叠 性 质⼦ 问 题 的 重 叠 性 质⼦ 问 题 的 重 叠 性 质 。 • 动 态 规 划 算 法 ， 对 每 ⼀ 个 ⼦ 问 题 只 解 ⼀ 次 ， ⽽ 后 将 其 解 保 存 在 ⼀ 个 表 格 中 ， 当 再 次 需 要 解 此 ⼦ 问 题 时 ， 只 是 简 单 地 ⽤ 常 数 时 间 查 看 ⼀ 下 结 果 。 • 通 常 不 同 的 ⼦ 问 题 个 数 随 问 题 的 ⼤ ⼩ 呈 多 项 式 增 ⻓ 。 因 此 ⽤ 动 态 规 划 算 法 只 需 要 多 项 式 时 间 ， 从 ⽽ 获 得 较 ⾼ 的 解 题 效 率 。 1 5 动 态 规 划 算 法 的 基 本 要 素动 态 规 划 算 法 的 基 本 要 素动 态 规 划 算 法 的 基 本 要 素 三 、 备 忘 录 ⽅ 法三 、 备 忘 录 ⽅ 法三 、 备 忘 录 ⽅ 法 • 备 忘 录 ⽅ 法 的 控 制 结 构 与 直 接 递 归 ⽅ 法 的 控 制 结 构 相 同 ， 区 别 在 于 备 忘 录 ⽅ 法 为 每 个 解 过 的 ⼦ 问 题 建 ⽴ 了 备 忘 录 以 备 需 要 时 查 看 ， 避 免 了 相 同 ⼦ 问 题 的 重 复 求 解 。 m  0 p r i v a t e s t a t i c i n t l o o k u p C h a i n ( i n t i , i n t j ) { i f ( m [ i ] [ j ] > 0 ) r e t u r n m [ i ] [ j ] ; i f ( i = = j ) r e t u r n 0 ; i n t u = l o o k u p C h a i n ( i + 1 , j ) + p [ i - 1 ] * p [ i ] * p [ j ] ; s [ i ] [ j ] = i ; f o r ( i n t k = i + 1 ; k < j ; k + + ) { i n t t = l o o k u p C h a i n ( i , k ) + l o o k u p C h a i n ( k + 1 , j ) + p [ i - 1 ] * p [ k ] * p [ j ] ; i f ( t < u ) { u = t ; s [ i ] [ j ] = k ; } } m [ i ] [ j ] = u ; r e t u r n u ; } 1 6 最 ⻓ 公 共 ⼦ 序 列最 ⻓ 公 共 ⼦ 序 列最 ⻓ 公 共 ⼦ 序 列 • 若 给 定 序 列 X = { x 1 , x 2 , … , x m } ， 则 另 ⼀ 序 列 Z = { z 1 , z 2 , … , z k } ， 是 X 的 ⼦ 序 列 是 指 存 在 ⼀ 个 严 格 递 增 下 标 序 列 { i 1 , i 2 , … , i k } 使 得 对 于 所 有 j = 1 , 2 , … , k 有 ： z j = x i j 。 例 如 ， 序 列 Z = { B ， C ， D ， B } 是 序 列 X = { A ， B ， C ， B ， D ， A ， B } 的 ⼦ 序 列 ， 相 应 的 递 增 下 标 序 列 为 { 2 ， 3 ， 5 ， 7 } 。 • 给 定 2 个 序 列 X 和 Y ， 当 另 ⼀ 序 列 Z 既 是 X 的 ⼦ 序 列 ⼜ 是 Y 的 ⼦ 序 列 时 ， 称 Z 是 序 列 X 和 Y 的 公 共 ⼦ 序 列公 共 ⼦ 序 列公 共 ⼦ 序 列 。 • 给 定 2 个 序 列 X = { x 1 , x 2 , … , x m } 和 Y = { y 1 , y 2 , … , y n } ， 找 出 X 和 Y 的 最 ⻓ 公 共 ⼦ 序 列 。 1 7 最 ⻓ 公 共 ⼦ 序 列 的 结 构最 ⻓ 公 共 ⼦ 序 列 的 结 构最 ⻓ 公 共 ⼦ 序 列 的 结 构 设 序 列 X = { x 1 , x 2 , … , x m } 和 Y = { y 1 , y 2 , … , y n } 的 最 ⻓ 公 共 ⼦ 序 列 为 Z = { z 1 , z 2 , … , z k } ， 则 ( 1 ) 若 x m = y n ， 则 z k = x m = y n ， 且 z k - 1 是 x m - 1 和 y n - 1 的 最 ⻓ 公 共 ⼦ 序 列 。 ( 2 ) 若 x m ≠ y n 且 z k ≠ x m ， 则 Z 是 x m - 1 和 Y 的 最 ⻓ 公 共 ⼦ 序 列 。 ( 3 ) 若 x m ≠ y n 且 z k ≠ y n ， 则 Z 是 X 和 y n - 1 的 最 ⻓ 公 共 ⼦ 序 列 。 由 此 可 ⻅ ， 2 个 序 列 的 最 ⻓ 公 共 ⼦ 序 列 包 含 了 这 2 个 序 列 的 前 缀 的 最 ⻓ 公 共 ⼦ 序 列 。 因 此 ， 最 ⻓ 公 共 ⼦ 序 列 问 题 具 有 最 优 ⼦ 结最 优 ⼦ 结最 优 ⼦ 结 构 性 质构 性 质构 性 质 。 1 8 ⼦ 问 题 的 递 归 结 构⼦ 问 题 的 递 归 结 构⼦ 问 题 的 递 归 结 构 由 最 ⻓ 公 共 ⼦ 序 列 问 题 的 最 优 ⼦ 结 构 性 质 建 ⽴ ⼦ 问 题 最 优 值 的 递 归 关 系 。 ⽤ c [ i ] [ j ] 记 录 序 列 和 的 最 ⻓ 公 共 ⼦ 序 列 的 ⻓ 度 。 其 中 ， X i = { x 1 , x 2 , … , x i } ； Y j = { y 1 , y 2 , … , y j } 。 当 i = 0 或 j = 0 时 ， 空 序 列 是 X i 和 Y j 的 最 ⻓ 公 共 ⼦ 序 列 。 故 此 时 C [ i ] [ j ] = 0 。 其 它 情 况 下 ， 由 最 优 ⼦ 结 构 性 质 可 建 ⽴ 递 归 关 系 如 下 ： 1 9 计 算 最 优 值计 算 最 优 值计 算 最 优 值 由 于 在 所 考 虑 的 ⼦ 问 题 空 间 中 ， 总 共 有 θ ( m n ) 个 不 同 的 ⼦ 问 题 ， 因 此 ， ⽤ 动 态 规 划 算 法 ⾃ 底 向 上 地 计 算 最 优 值 能 提 ⾼ 算 法 的 效 率 。 A l g o r i t h m l c s L e n g t h ( x , y , b ) 1 : m  x . l e n g t h - 1 ; 2 : n  y . l e n g t h - 1 ; 3 : c [ i ] [ 0 ] = 0 ; c [ 0 ] [ i ] = 0 ; 4 : f o r ( i n t i = 1 ; i < = m ; i + + ) 5 : f o r ( i n t j = 1 ; j < = n ; j + + ) 6 : i f ( x [ i ] = = y [ j ] ) 7 : c [ i ] [ j ] = c [ i - 1 ] [ j - 1 ] + 1 ; 8 : b [ i ] [ j ] = 1 ; 9 : e l s e i f ( c [ i - 1 ] [ j ] > = c [ i ] [ j - 1 ] ) 1 0 : c [ i ] [ j ] = c [ i - 1 ] [ j ] ; 1 1 : b [ i ] [ j ] = 2 ; 1 2 : e l s e 1 3 : c [ i ] [ j ] = c [ i ] [ j - 1 ] ; 1 4 : b [ i ] [ j ] = 3 ; 构 造 最 ⻓ 公 共 ⼦ 序 列构 造 最 ⻓ 公 共 ⼦ 序 列构 造 最 ⻓ 公 共 ⼦ 序 列 A l g o r i t h m l c s ( i n t i , i n t j , c h a r [ ] x , i n t [ ] [ ] b ) { i f ( i = = 0 | | j = = 0 ) r e t u r n ; i f ( b [ i ] [ j ] = = 1 ) { l c s ( i - 1 , j - 1 , x , b ) ; S y s t e m . o u t . p r i n t ( x [ i ] ) ; } e l s e i f ( b [ i ] [ j ] = = 2 ) l c s ( i - 1 , j , x , b ) ; e l s e l c s ( i , j - 1 , x , b ) ; } 2 0 算 法 的 改 进算 法 的 改 进算 法 的 改 进 • 在 算 法 l c s L e n g t h 和 l c s 中 ， 可 进 ⼀ 步 将 数 组 b 省 去 。 事 实 上 ， 数 组 元 素 c [ i ] [ j ] 的 值 仅 由 c [ i - 1 ] [ j - 1 ] ， c [ i - 1 ] [ j ] 和 c [ i ] [ j - 1 ] 这 3 个 数 组 元 素 的 值 所 确 定 。 对 于 给 定 的 数 组 元 素 c [ i ] [ j ] ， 可 以 不 借 助 于 数 组 b ⽽ 仅 借 助 于 c 本 身 在 时 间 内 确 定 c [ i ] [ j ] 的 值 是 由 c [ i - 1 ] [ j - 1 ] ， c [ i - 1 ] [ j ] 和 c [ i ] [ j - 1 ] 中 哪 ⼀ 个 值 所 确 定 的 。 • 如 果 只 需 要 计 算 最 ⻓ 公 共 ⼦ 序 列 的 ⻓ 度 ， 则 算 法 的 空 间 需 求 可 ⼤ ⼤ 减 少 。 事 实 上 ， 在 计 算 c [ i ] [ j ] 时 ， 只 ⽤ 到 数 组 c 的 第 i ⾏ 和 第 i - 1 ⾏ 。 因 此 ， ⽤ 2 ⾏ 的 数 组 空 间 就 可 以 计 算 出 最 ⻓ 公 共 ⼦ 序 列 的 ⻓ 度 。 进 ⼀ 步 的 分 析 还 可 将 空 间 需 求 减 ⾄ O ( m i n ( m , n ) ) 。 2 1 凸 多 边 形 最 优 三 ⻆ 剖 分凸 多 边 形 最 优 三 ⻆ 剖 分凸 多 边 形 最 优 三 ⻆ 剖 分 • ⽤ 多 边 形 顶 点 的 逆 时 针 序 列 表 示 凸 多 边 形 ， 即 P = { v 0 , v 1 , … , v n - 1 } 表 示 具 有 n 条 边 的 凸 多 边 形 。 • 若 v i 与 v j 是 多 边 形 上 不 相 邻 的 2 个 顶 点 ， 则 线 段 v i v j 称 为 多 边 形 的 ⼀ 条 弦 。 弦 将 多 边 形 分 割 成 2 个 多 边 形 { v i , v i + 1 , … , v j } 和 { v j , v j + 1 , … v i } 。 • 多 边 形 的 三 ⻆ 剖 分多 边 形 的 三 ⻆ 剖 分多 边 形 的 三 ⻆ 剖 分 是 将 多 边 形 分 割 成 互 不 相 交 的 三 ⻆ 形 的 弦 的 集 合 T 。 • 给 定 凸 多 边 形 P ， 以 及 定 义 在 由 多 边 形 的 边 和 弦 组 成 的 三 ⻆ 形 上 的 权 函 数 w 。 要 求 确 定 该 凸 多 边 形 的 三 ⻆ 剖 分 ， 使 得 即 该 三 ⻆ 剖 分 中 诸 三 ⻆ 形 上 权 之 和 为 最 ⼩ 。 2 2 三 ⻆ 剖 分 的 结 构 及 其 相 关 问 题三 ⻆ 剖 分 的 结 构 及 其 相 关 问 题三 ⻆ 剖 分 的 结 构 及 其 相 关 问 题 • ⼀ 个 表 达 式 的 完 全 加 括 号 ⽅ 式 相 应 于 ⼀ 棵 完 全 ⼆ 叉 树 ， 称 为 表 达 式 的 语 法 树 。 例 如 ， 完 全 加 括 号 的 矩 阵 连 乘 积 ( ( A 1 ( A 2 A 3 ) ) ( A 4 ( A 5 A 6 ) ) ) 所 相 应 的 语 法 树 如 图 ( a ) 所 示 。 • 凸 多 边 形 { v 0 , v 1 , … v n - 1 } 的 三 ⻆ 剖 分 也 可 以 ⽤ 语 法 树 表 示 。 例 如 ， 图 ( b ) 中 凸 多 边 形 的 三 ⻆ 剖 分 可 ⽤ 图 ( a ) 所 示 的 语 法 树 表 示 。 • 矩 阵 连 乘 积 中 的 每 个 矩 阵 A i 对 应 于 凸 ( n + 1 ) 边 形 中 的 ⼀ 条 边 v i - 1 v i 。 三 ⻆ 剖 分 中 的 ⼀ 条 弦 v i v j ， i < j ， 对 应 于 矩 阵 连 乘 积 A [ i + 1 : j ] 。 2 3 最 优 ⼦ 结 构 性 质最 优 ⼦ 结 构 性 质最 优 ⼦ 结 构 性 质 • 凸 多 边 形 的 最 优 三 ⻆ 剖 分 问 题 有 最 优 ⼦ 结 构 性 质 。 • 事 实 上 ， 若 凸 ( n + 1 ) 边 形 P = { v 0 , v 1 , … , v n - 1 } 的 最 优 三 ⻆ 剖 分 T 包 含 三 ⻆ 形 v 0 v k v n ， 1 ≤ k ≤ n - 1 ， 则 T 的 权 为 3 个 部 分 权 的 和 ： 三 ⻆ 形 v 0 v k v n 的 权 ， ⼦ 多 边 形 { v 0 , v 1 , … , v k } 和 { v k , v k + 1 , … , v n } 的 权 之 和 。 可 以 断 ⾔ ， 由 T 所 确 定 的 这 2 个 ⼦ 多 边 形 的 三 ⻆ 剖 分 也 是 最 优 的 。 因 为 若 有 { v 0 , v 1 , … , v k } 或 { v k , v k + 1 , … , v n } 的 更 ⼩ 权 的 三 ⻆ 剖 分 将 导 致 T 不 是 最 优 三 ⻆ 剖 分 的 ⽭ 盾 。 2 4 最 优 三 ⻆ 剖 分 的 递 归 结 构最 优 三 ⻆ 剖 分 的 递 归 结 构最 优 三 ⻆ 剖 分 的 递 归 结 构 • 定 义 t [ i ] [ j ] ， 1 ≤ i < j ≤ n 为 凸 ⼦ 多 边 形 { v i - 1 , v i , … , v j } 的 最 优 三 ⻆ 剖 分 所 对 应 的 权 函 数 值 ， 即 其 最 优 值 。 为 ⽅ 便 起 ⻅ ， 设 退 化 的 多 边 形 { v i - 1 , v i } 具 有 权 值 0 。 据 此 定 义 ， 要 计 算 的 凸 ( n + 1 ) 边 形 P 的 最 优 权 值 为 t [ 1 ] [ n ] 。 • t [ i ] [ j ] 的 值 可 以 利 ⽤ 最 优 ⼦ 结 构 性 质 递 归 地 计 算 。 当 j - i ≥ 1 时 ， 凸 ⼦ 多 边 形 ⾄ 少 有 3 个 顶 点 。 由 最 优 ⼦ 结 构 性 质 ， t [ i ] [ j ] 的 值 应 为 t [ i ] [ k ] 的 值 加 上 t [ k + 1 ] [ j ] 的 值 ， 再 加 上 三 ⻆ 形 v i - 1 v k v j 的 权 值 ， 其 中 i ≤ k ≤ j - 1 。 由 于 在 计 算 时 还 不 知 道 k 的 确 切 位 置 ， ⽽ k 的 所 有 可 能 位 置 只 有 j - i 个 ， 因 此 可 以 在 这 j - i 个 位 置 中 选 出 使 t [ i ] [ j ] 值 达 到 最 ⼩ 的 位 置 。 由 此 ， t [ i ] [ j ] 可 递 归 地 定 义 为 ： 2 5 多 边 形 游 戏多 边 形 游 戏多 边 形 游 戏 多 边 形 游 戏 是 ⼀ 个 单 ⼈ 玩 的 游 戏 ， 开 始 时 有 ⼀ 个 由 n 个 顶 点 构 成 的 多 边 形 。 每 个 顶 点 被 赋 予 ⼀ 个 整 数 值 ， 每 条 边 被 赋 予 ⼀ 个 运 算 符 “ + ” 或 “ * ” 。 所 有 边 依 次 ⽤ 整 数 从 1 到 n 编 号 。 游 戏 第 1 步 ， 将 ⼀ 条 边 删 除 。 随 后 n - 1 步 按 以 下 ⽅ 式 操 作 ： ( 1 ) 选 择 ⼀ 条 边 E 以 及 由 E 连 接 着 的 2 个 顶 点 V 1 和 V 2 ； ( 2 ) ⽤ ⼀ 个 新 的 顶 点 取 代 边 E 以 及 由 E 连 接 着 的 2 个 顶 点 V 1 和 V 2 。 将 由 顶 点 V 1 和 V 2 的 整 数 值 通 过 边 E 上 的 运 算 得 到 的 结 果 赋 予 新 顶 点 。 最 后 ， 所 有 边 都 被 删 除 ， 游 戏 结 束 。 游 戏 的 得 分 就 是 所 剩 顶 点 上 的 整 数 值 。 问 题 : 对 于 给 定 的 多 边 形 ， 计 算 最 ⾼ 得 分 。 2 6 最 优 ⼦ 结 构 性 质最 优 ⼦ 结 构 性 质最 优 ⼦ 结 构 性 质 • 在 所 给 多 边 形 中 ， 从 顶 点 i ( 1 ≤ i ≤ n ) 开 始 ， ⻓ 度 为 j ( 链 中 有 j 个 顶 点 ) 的 顺 时 针 链 p ( i ， j ) 可 表 示 为 v [ i ] ， o p [ i + 1 ] ， … ， v [ i + j - 1 ] 。 • 如 果 这 条 链 的 最 后 ⼀ 次 合 并 运 算 在 o p [ i + s ] 处 发 ⽣ ( 1 ≤ s ≤ j - 1 ) ， 则 可 在 o p [ i + s ] 处 将 链 分 割 为 2 个 ⼦ 链 p ( i ， s ) 和 p ( i + s ， j - s ) 。 • 设 m 1 是 对 ⼦ 链 p ( i ， s ) 的 任 意 ⼀ 种 合 并 ⽅ 式 得 到 的 值 ， ⽽ a 和 b 分 别 是 在 所 有 可 能 的 合 并 中 得 到 的 最 ⼩ 值 和 最 ⼤ 值 。 m 2 是 p ( i + s ， j - s ) 的 任 意 ⼀ 种 合 并 ⽅ 式 得 到 的 值 ， ⽽ c 和 d 分 别 是 在 所 有 可 能 的 合 并 中 得 到 的 最 ⼩ 值 和 最 ⼤ 值 。 依 此 定 义 有 a ≤ m 1 ≤ b ， c ≤ m 2 ≤ d ( 1 ) 当 o p [ i + s ] = ' + ' 时 ， 显 然 有 a + c ≤ m ≤ b + d ( 2 ) 当 o p [ i + s ] = ' * ' 时 ， 有 m i n { a c ， a d ， b c ， b d } ≤ m ≤ m a x { a c ， a d ， b c ， b d } • 换 句 话 说 ， 主 链 的 最 ⼤ 值 和 最 ⼩ 值 可 由 ⼦ 链 的 最 ⼤ 值 和 最 ⼩ 值 得 到 。 2 7 图 像 压 缩图 像 压 缩图 像 压 缩 图 象 的 变 位 压 缩 存 储 格 式 将 所 给 的 象 素 点 序 列 { p 1 , p 2 , … , p n } , 0 ≤ p i ≤ 2 5 5 分 割 成 m 个 连 续 段 S 1 , S 2 , … , S m 。 第 i 个 象 素 段 S i 中 ( 1 ≤ i ≤ m ) ， 有 l [ i ] 个 象 素 , 且 该 段 中 每 个 象 素 都 只 ⽤ b [ i ] 位 表 示 。 设 则 第 i 个 象 素 段 S i 为 设 ， 则 h i  b [ i ]  8 。 因 此 需 要 ⽤ 3 位 表 示 b [ i ] , 如 果 限 制 1  l [ i ]  2 5 5 ， 则 需 要 ⽤ 8 位 表 示 l [ i ] 。 因 此 ， 第 i 个 象 素 段 所 需 的 存 储 空 间 为 l [ i ] * b [ i ] + 1 1 位 。 按 此 格 式 存 储 象 素 序 列 { p 1 , p 2 , … , p n } ， 需 要 位 的 存 储 空 间 。 图 象 压 缩 问 题 要 求 确 定 象 素 序 列 { p 1 , p 2 , … , p n } 的 最 优 分 段 ， 使 得 依 此 分 段 所 需 的 存 储 空 间 最 少 。 每 个 分 段 的 ⻓ 度 不 超 过 2 5 6 位 。 2 8 图 像 压 缩图 像 压 缩图 像 压 缩 设 l [ i ] ， b [ i ] ， 是 { p 1 , p 2 , … , p n } 的 最 优 分 段 。 显 ⽽ 易 ⻅ ， l [ 1 ] ， b [ 1 ] 是 { p 1 , … , p l [ 1 ] } 的 最 优 分 段 ， 且 l [ i ] ， b [ i ] ， 是 { p l [ 1 ] + 1 , … , p n } 的 最 优 分 段 。 即 图 象 压 缩 问 题 满 ⾜ 最 优 ⼦ 结 构 性 质 。 设 s [ i ] ， 1 ≤ i ≤ n ， 是 象 素 序 列 { p 1 , … , p n } 的 最 优 分 段 所 需 的 存 储 位 数 。 由 最 优 ⼦ 结 构 性 质 易 知 ： 其 中 算 法 复 杂 度 分 析 ：算 法 复 杂 度 分 析 ：算 法 复 杂 度 分 析 ： 由 于 算 法 c o m p r e s s 中 对 k 的 循 环 次 数 不 超 这 2 5 6 ， 故 对 每 ⼀ 个 确 定 的 i ， 可 在 时 间 O ( 1 ) 内 完 成 的 计 算 。 因 此 整 个 算 法 所 需 的 计 算 时 间 为 O ( n ) 。 2 9 电 路 布 线电 路 布 线电 路 布 线 在 ⼀ 块 电 路 板 的 上 、 下 2 端 分 别 有 n 个 接 线 柱 。 根 据 电 路 设 计 ， 要 求 ⽤ 导 线 ( i , π ( i ) ) 将 上 端 接 线 柱 与 下 端 接 线 柱 相 连 ， 如 图 所 示 。 其 中 π ( i ) 是 { 1 , 2 , … , n } 的 ⼀ 个 排 列 。 导 线 ( i , π ( i ) ) 称 为 该 电 路 板 上 的 第 i 条 连 线 。 对 于 任 何 1 ≤ i < j ≤ n ， 第 i 条 连 线 和 第 j 条 连 线 相 交 的 充 分 且 必 要 的 条 件 是 π ( i ) > π ( j ) 。 电 路 布 线 问 题 要 确 定 将 哪 些 连 线 安 排 在 第 ⼀ 层 上 ， 使 得 该 层 上 有 尽 可 能 多 的 连 线 。 换 句 话 说 ， 该 问 题 要 求 确 定 导 线 集 N e t s = { ( i , π ( i ) ) , 1 ≤ i ≤ n } 的 最 ⼤ 不 相 交 ⼦ 集 。 3 0 记 。 N ( i , j ) 的 最 ⼤ 不 相 交 ⼦ 集 为 M N S ( i , j ) 。 S i z e ( i , j ) = | M N S ( i , j ) | 。 ( 1 ) 当 i = 1 时 ， ( 2 ) 当 i > 1 时 ， 2 . 1 j < π ( i ) 。 此 时 ， 。 故 在 这 种 情 况 下 ， N ( i , j ) = N ( i - 1 , j ) ， 从 ⽽ S i z e ( i , j ) = S i z e ( i - 1 , j ) 。 2 . 2 j ≥ π ( i ) ， ( i , π ( i ) ) ∈ M N S ( i , j ) 。 则 对 任 意 ( t , π ( t ) ) ∈ M N S ( i , j ) 有 t < i 且 π ( t ) < π ( i ) 。 在 这 种 情 况 下 M N S ( i , j ) - { ( i , π ( i ) ) } 是 N ( i - 1 , π ( i ) - 1 ) 的 最 ⼤ 不 相 交 ⼦ 集 。 2 . 3 若 ， 则 对 任 意 ( t , π ( t ) ) ∈ M N S ( i , j ) 有 t < i 。 从 ⽽ 。 因 此 ， S i z e ( i , j ) ≤ S i z e ( i - 1 , j ) 。 另 ⼀ ⽅ ⾯ ， 故 ⼜ 有 S i z e ( i , j ) ≥ S i z e ( i - 1 , j ) ， 从 ⽽ S i z e ( i , j ) = S i z e ( i - 1 , j ) 。 电 路 布 线电 路 布 线电 路 布 线 ( 1 ) 当 i = 1 时 ( 2 ) 当 i > 1 时 3 1 流 ⽔ 作 业 调 度流 ⽔ 作 业 调 度流 ⽔ 作 业 调 度 n 个 作 业 { 1 ， 2 ， … ， n } 要 在 由 2 台 机 器 M 1 和 M 2 组 成 的 流 ⽔ 线 上 完 成 加 ⼯ 。 每 个 作 业 加 ⼯ 的 顺 序 都 是 先 在 M 1 上 加 ⼯ ， 然 后 在 M 2 上 加 ⼯ 。 M 1 和 M 2 加 ⼯ 作 业 i 所 需 的 时 间 分 别 为 a i 和 b i 。 流 ⽔ 作 业 调 度 问 题 要 求 确 定 这 n 个 作 业 的 最 优 加 ⼯ 顺 序 ， 使 得 从 第 ⼀ 个 作 业 在 机 器 M 1 上 开 始 加 ⼯ ， 到 最 后 ⼀ 个 作 业 在 机 器 M 2 上 加 ⼯ 完 成 所 需 的 时 间 最 少 。 分 析 ：分 析 ：分 析 ： • 直 观 上 ， ⼀ 个 最 优 调 度 应 使 机 器 M 1 没 有 空 闲 时 间 ， 且 机 器 M 2 的 空 闲 时 间 最 少 。 在 ⼀ 般 情 况 下 ， 机 器 M 2 上 会 有 机 器 空 闲 和 作 业 积 压 2 种 情 况 。 • 设 全 部 作 业 的 集 合 为 N = { 1 ， 2 ， … ， n } 。 S  N 是 N 的 作 业 ⼦ 集 。 在 ⼀ 般 情 况 下 ， 机 器 M 1 开 始 加 ⼯ S 中 作 业 时 ， 机 器 M 2 还 在 加 ⼯ 其 它 作 业 ， 要 等 时 间 t 后 才 可 利 ⽤ 。 将 这 种 情 况 下 完 成 S 中 作 业 所 需 的 最 短 时 间 记 为 T ( S , t ) 。 流 ⽔ 作 业 调 度 问 题 的 最 优 值 为 T ( N , 0 ) 。 3 2 流 ⽔ 作 业 调 度流 ⽔ 作 业 调 度流 ⽔ 作 业 调 度 设  是 所 给 n 个 流 ⽔ 作 业 的 ⼀ 个 最 优 调 度 ， 它 所 需 的 加 ⼯ 时 间 为 a  ( 1 ) + T ’ 。 其 中 T ’ 是 在 机 器 M 2 的 等 待 时 间 为 b  ( 1 ) 时 ， 安 排 作 业  ( 2 ) ， … ，  ( n ) 所 需 的 时 间 。 记 S = N - {  ( 1 ) } ， 则 有 T ’ = T ( S , b  ( 1 ) ) 。 证 明 ：证 明 ：证 明 ： 事 实 上 ， 由 T 的 定 义 知 T ’  T ( S , b  ( 1 ) ) 。 若 T ’ > T ( S , b  ( 1 ) ) ， 设  ’ 是 作 业 集 S 在 机 器 M 2 的 等 待 时 间 为 b  ( 1 ) 情 况 下 的 ⼀ 个 最 优 调 度 。 则  ( 1 ) ，  ’ ( 2 ) ， … ，  ’ ( n ) 是 N 的 ⼀ 个 调 度 ， 且 该 调 度 所 需 的 时 间 为 a  ( 1 ) + T ( S , b  ( 1 ) ) < a  ( 1 ) + T ’ 。 这 与  是 N 的 最 优 调 度 ⽭ 盾 。 故 T ’  T ( S , b  ( 1 ) ) 。 从 ⽽ T ’ = T ( S , b  ( 1 ) ) 。 这 就 证 明 了 流 ⽔ 作 业 调 度 问 题 具 有 最 优 ⼦ 结 构 的 性 质 。 由 流 ⽔ 作 业 调 度 问 题 的 最 优 ⼦ 结 构 性 质 可 知 ， 3 3 J o h n s o n 不 等 式不 等 式不 等 式 对 递 归 式 的 深 ⼊ 分 析 表 明 ， 算 法 可 进 ⼀ 步 得 到 简 化 。 设  是 作 业 集 S 在 机 器 M 2 的 等 待 时 间 为 t 时 的 任 ⼀ 最 优 调 度 。 若  ( 1 ) = i ,  ( 2 ) = j 。 则 由 动 态 规 划 递 归 式 可 得 : T ( S , t ) = a i + T ( S - { i } , b i + m a x { t - a i , 0 } ) = a i + a j + T ( S - { i , j } , t i j ) 其 中 ， 如 果 作 业 i 和 j 满 ⾜ m i n { b i , a j } ≥ m i n { b j , a i } ， 则 称 作 业 i 和 j 满 ⾜ J o h n s o nJ o h n s o nJ o h n s o n 不 等 式不 等 式不 等 式 。 3 4 流 ⽔ 作 业 调 度 的流 ⽔ 作 业 调 度 的流 ⽔ 作 业 调 度 的 J o h n s o n 法 则法 则法 则 交 换 作 业 i 和 作 业 j 的 加 ⼯ 顺 序 ， 得 到 作 业 集 S 的 另 ⼀ 调 度 ， 它 所 需 的 加 ⼯ 时 间 为 T ’ ( S , t ) = a i + a j + T ( S - { i , j } , t j i ) 其 中 ， 当 作 业 i 和 j 满 ⾜ J o h n s o n 不 等 式 时 ， 有 由 此 可 ⻅ 当 作 业 i 和 作 业 j 不 满 ⾜ J o h n s o n 不 等 式 时 ， 交 换 它 们 的 加 ⼯ 顺 序 后 ， 不 增 加 加 ⼯ 时 间 。 对 于 流 ⽔ 作 业 调 度 问 题 ， 必 存 在 最 优 调 度  ， 使 得 作 业  ( i ) 和  ( i + 1 ) 满 ⾜ J o h n s o n 不 等 式 。 进 ⼀ 步 还 可 以 证 明 ， 调 度 满 ⾜ J o h n s o n 法 则 当 且 仅 当 对 任 意 i < j 有 由 此 可 知 ， 所 有 满 ⾜所 有 满 ⾜所 有 满 ⾜ J o h n s o nJ o h n s o nJ o h n s o n 法 则 的 调 度 均 为 最 优 调 度 。法 则 的 调 度 均 为 最 优 调 度 。法 则 的 调 度 均 为 最 优 调 度 。 3 5 算 法 描 述算 法 描 述算 法 描 述 流 ⽔ 作 业 调 度 问 题 的 J o h n s o n 算 法 ( 1 ) 令 ( 2 ) 将 N 1 中 作 业 依 a i 的 ⾮ 减 序 排 序 ； 将 N 2 中 作 业 依 b i 的 ⾮ 增 序 排 序 ； ( 3 ) N 1 中 作 业 接 N 2 中 作 业 构 成 满 ⾜ J o h n s o n 法 则 的 最 优 调 度 。 算 法 复 杂 度 分 析 ：算 法 复 杂 度 分 析 ：算 法 复 杂 度 分 析 ： 算 法 的 主 要 计 算 时 间 花 在 对 作 业 集 的 排 序 。 因 此 ， 在 最 坏 情 况 下 算 法 所 需 的 计 算 时 间 为 O ( n l o g n ) 。 所 需 的 空 间 为 O ( n ) 。 3 6 0 - 1 背 包 问 题背 包 问 题背 包 问 题 给 定 n 种 物 品 和 ⼀ 背 包 。 物 品 i 的 重 量 是 w i ， 其 价 值 为 v i ， 背 包 的 容 量 为 C 。 问 应 如 何 选 择 装 ⼊ 背 包 的 物 品 ， 使 得 装 ⼊ 背 包 中 物 品 的 总 价 值 最 ⼤ ? 0 - 1 背 包 问 题 是 ⼀ 个 特 殊 的 整 数 规 划 问 题 。 3 7 0 - 1 背 包 问 题背 包 问 题背 包 问 题 设 所 给 0 - 1 背 包 问 题 的 ⼦ 问 题 的 最 优 值 为 m ( i ， j ) ， 即 m ( i ， j ) 是 背 包 容 量 为 j ， 可 选 择 物 品 为 i ， i + 1 ， … ， n 时 0 - 1 背 包 问 题 的 最 优 值 。 由 0 - 1 背 包 问 题 的 最 优 ⼦ 结 构 性 质 ， 可 以 建 ⽴ 计 算 m ( i ， j ) 的 递 归 式 如 下 。 算 法 复 杂 度 分 析 ：算 法 复 杂 度 分 析 ：算 法 复 杂 度 分 析 ： 从 m ( i ， j ) 的 递 归 式 容 易 看 出 ， 算 法 需 要 O ( n c ) 计 算 时 间 。 当 背 包 容 量 c 很 ⼤ 时 ， 算 法 需 要 的 计 算 时 间 较 多 。 例 如 ， 当 c > 2 n 时 ， 算 法 需 要 Ω ( n 2 n ) 计 算 时 间 。 3 8 算 法 改 进算 法 改 进算 法 改 进 由 m ( i , j ) 的 递 归 式 容 易 证 明 ， 在 ⼀ 般 情 况 下 ， 对 每 ⼀ 个 确 定 的 i ( 1 ≤ i ≤ n ) ， 函 数 m ( i , j ) 是 关 于 变 量 j 的 阶 梯 状 单 调 不 减 函 数 。 跳 跃 点 是 这 ⼀ 类 函 数 的 描 述 特 征 。 在 ⼀ 般 情 况 下 ， 函 数 m ( i , j ) 由 其 全 部 跳 跃 点 唯 ⼀ 确 定 。 如 图 所 示 。 对 每 ⼀ 个 确 定 的 i ( 1 ≤ i ≤ n ) ， ⽤ ⼀ 个 表 p [ i ] 存 储 函 数 m ( i ， j ) 的 全 部 跳 跃 点 。 表 p [ i ] 可 依 计 算 m ( i ， j ) 的 递 归 式 递 归 地 由 表 p [ i + 1 ] 计 算 ， 初 始 时 p [ n + 1 ] = { ( 0 ， 0 ) } 。 3 9 ⼀ 个 例 ⼦⼀ 个 例 ⼦⼀ 个 例 ⼦ n = 3 ， c = 6 ， w = { 4 ， 3 ， 2 } ， v = { 5 ， 2 ， 1 } 。 x ( 0 , 0 ) m ( 4 , x ) x ( 2 , 1 ) m ( 4 , x - 2 ) + 1 x ( 0 , 0 ) ( 2 , 1 ) m ( 3 , x ) ( 3 , 2 ) x m ( 3 , x - 3 ) + 2 ( 5 , 3 ) x ( 0 , 0 ) ( 2 , 1 ) m ( 2 , x ) ( 3 , 2 ) ( 5 , 3 ) x m ( 2 , x - 4 ) + 5 ( 4 , 5 ) ( 6 , 6 ) ( 7 , 7 ) ( 9 , 8 ) x ( 0 , 0 ) ( 2 , 1 ) m ( 1 , x ) ( 3 , 2 ) ( 5 , 3 ) ( 4 , 5 ) ( 6 , 6 ) ( 7 , 7 ) ( 9 , 8 ) x ( 0 , 0 ) ( 2 , 1 ) m ( 3 , x ) x ( 0 , 0 ) ( 2 , 1 ) m ( 2 , x ) ( 3 , 2 ) ( 5 , 3 ) 4 0 • 函 数 m ( i , j ) 是 由 函 数 m ( i + 1 , j ) 与 函 数 m ( i + 1 , j - w i ) + v i 作 m a x 运 算 得 到 的 。 因 此 ， 函 数 m ( i , j ) 的 全 部 跳 跃 点 包 含 于 函 数 m ( i + 1 ， j ) 的 跳 跃 点 集 p [ i + 1 ] 与 函 数 m ( i + 1 ， j - w i ) + v i 的 跳 跃 点 集 q [ i + 1 ] 的 并 集 中 。 易 知 ， ( s , t )  q [ i + 1 ] 当 且 仅 当 w i  s  c 且 ( s - w i , t - v i )  p [ i + 1 ] 。 因 此 ， 容 易 由 p [ i + 1 ] 确 定 跳 跃 点 集 q [ i + 1 ] 如 下 q [ i + 1 ] = p [ i + 1 ]  ( w i , v i ) = { ( j + w i , m ( i , j ) + v i ) | ( j , m ( i , j ) )  p [ i + 1 ] } • 另 ⼀ ⽅ ⾯ ， 设 ( a ， b ) 和 ( c ， d ) 是 p [ i + 1 ]  q [ i + 1 ] 中 的 2 个 跳 跃 点 ， 则 当 c  a 且 d < b 时 ， ( c ， d ) 受 控 于 ( a ， b ) ， 从 ⽽ ( c ， d ) 不 是 p [ i ] 中 的 跳 跃 点 。 除 受 控 跳 跃 点 外 ， p [ i + 1 ]  q [ i + 1 ] 中 的 其 它 跳 跃 点 均 为 p [ i ] 中 的 跳 跃 点 。 • 由 此 可 ⻅ ， 在 递 归 地 由 表 p [ i + 1 ] 计 算 表 p [ i ] 时 ， 可 先 由 p [ i + 1 ] 计 算 出 q [ i + 1 ] ， 然 后 合 并 表 p [ i + 1 ] 和 表 q [ i + 1 ] ， 并 清 除 其 中 的 受 控 跳 跃 点 得 到 表 p [ i ] 。 算 法 改 进算 法 改 进算 法 改 进 4 1 ⼀ 个 例 ⼦⼀ 个 例 ⼦⼀ 个 例 ⼦ n = 5 ， c = 1 0 ， w = { 2 ， 2 ， 6 ， 5 ， 4 } ， v = { 6 ， 3 ， 5 ， 4 ， 6 } 。 初 始 时 p [ 6 ] = { ( 0 , 0 ) } ， ( w 5 , v 5 ) = ( 4 , 6 ) 。 因 此 ， q [ 6 ] = p [ 6 ]  ( w 5 , v 5 ) = { ( 4 , 6 ) } 。 p [ 5 ] = { ( 0 , 0 ) , ( 4 , 6 ) } 。 q [ 5 ] = p [ 5 ]  ( w 4 , v 4 ) = { ( 5 , 4 ) , ( 9 , 1 0 ) } 。 从 跳 跃 点 集 p [ 5 ] 与 q [ 5 ] 的 并 集 p [ 5 ]  q [ 5 ] = { ( 0 , 0 ) , ( 4 , 6 ) , ( 5 , 4 ) , ( 9 , 1 0 ) } 中 看 到 跳 跃 点 ( 5 , 4 ) 受 控 于 跳 跃 点 ( 4 , 6 ) 。 将 受 控 跳 跃 点 ( 5 , 4 ) 清 除 后 ， 得 到 p [ 4 ] = { ( 0 , 0 ) , ( 4 , 6 ) , ( 9 , 1 0 ) } q [ 4 ] = p [ 4 ]  ( 6 ， 5 ) = { ( 6 ， 5 ) ， ( 1 0 ， 1 1 ) } p [ 3 ] = { ( 0 ， 0 ) ， ( 4 ， 6 ) ， ( 9 ， 1 0 ) ， ( 1 0 ， 1 1 ) } q [ 3 ] = p [ 3 ]  ( 2 ， 3 ) = { ( 2 ， 3 ) ， ( 6 ， 9 ) } p [ 2 ] = { ( 0 ， 0 ) ， ( 2 ， 3 ) ， ( 4 ， 6 ) ， ( 6 ， 9 ) ， ( 9 ， 1 0 ) ， ( 1 0 ， 1 1 ) } q [ 2 ] = p [ 2 ]  ( 2 ， 6 ) = { ( 2 ， 6 ) ， ( 4 ， 9 ) ， ( 6 ， 1 2 ) ， ( 8 ， 1 5 ) } p [ 1 ] = { ( 0 ， 0 ) ， ( 2 ， 6 ) ， ( 4 ， 9 ) ， ( 6 ， 1 2 ) ， ( 8 ， 1 5 ) } p [ 1 ] 的 最 后 的 那 个 跳 跃 点 ( 8 , 1 5 ) 给 出 所 求 的 最 优 值 为 m ( 1 , c ) = 1 5 。 4 2 上 述 算 法 的 主 要 计 算 量 在 于 计 算 跳 跃 点 集 p [ i ] ( 1 ≤ i ≤ n ) 。 由 于 q [ i + 1 ] = p [ i + 1 ]  ( w i ， v i ) ， 故 计 算 q [ i + 1 ] 需 要 O ( | p [ i + 1 ] | ) 计 算 时 间 。 合 并 p [ i + 1 ] 和 q [ i + 1 ] 并 清 除 受 控 跳 跃 点 也 需 要 O ( | p [ i + 1 ] | ) 计 算 时 间 。 从 跳 跃 点 集 p [ i ] 的 定 义 可 以 看 出 ， p [ i ] 中 的 跳 跃 点 相 应 于 x i , … , x n 的 0 / 1 赋 值 。 因 此 ， p [ i ] 中 跳 跃 点 个 数 不 超 过 2 n - i + 1 。 由 此 可 ⻅ ， 算 法 计 算 跳 跃 点 集 p [ i ] 所 花 费 的 计 算 时 间 为 从 ⽽ ， 改 进 后 算 法 的 计 算 时 间 复 杂 性 为 O ( 2 n ) 。 当 所 给 物 品 的 重 量 w i ( 1 ≤ i ≤ n ) 是 整 数 时 ， | p [ i ] | ≤ c + 1 ， ( 1 ≤ i ≤ n ) 。 在 这 种 情 况 下 ， 改 进 后 算 法 的 计 算 时 间 复 杂 性 为 O ( m i n { n c , 2 n } ) 。 算 法 复 杂 度 分 析算 法 复 杂 度 分 析算 法 复 杂 度 分 析 4 3 最 优 ⼆ 叉 搜 索 树最 优 ⼆ 叉 搜 索 树最 优 ⼆ 叉 搜 索 树 • 什 么 是 ⼆ 叉 搜 索 树 ？ （ 1 ） 若 它 的 左 ⼦ 树 不 空 ， 则 左 ⼦ 树 上 所 有 　 　 　 节 点 的 值 均 ⼩ 于 它 的 根 节 点 的 值 ； （ 2 ） 若 它 的 右 ⼦ 树 不 空 ， 则 右 ⼦ 树 上 所 有 　 　 　 节 点 的 值 均 ⼤ 于 它 的 根 节 点 的 值 ； （ 3 它 的 左 、 右 ⼦ 树 也 分 别 为 ⼆ 叉 排 序 树 4 5 1 2 5 3 3 3 7 2 4 1 0 0 6 1 9 0 7 8 在 随 机 的 情 况 下 ， ⼆ 叉 查 找 树 的 平 均 查 找 ⻓ 度 和 是 等 数 量 级 的 4 4 • 查 找 成 功 与 不 成 功 的 概 率 • ⼆ 查 找 树 的 期 望 耗 费 • 有 个 节 点 的 ⼆ 叉 树 的 个 数 为 ： • 穷 举 搜 索 法 的 时 间 复 杂 度 为 指 数 级 ⼆ 叉 查 找 树 的 期 望 耗 费⼆ 叉 查 找 树 的 期 望 耗 费⼆ 叉 查 找 树 的 期 望 耗 费 4 5 ⼆ 叉 查 找 树 的 期 望 耗 费 示 例⼆ 叉 查 找 树 的 期 望 耗 费 示 例⼆ 叉 查 找 树 的 期 望 耗 费 示 例 4 6 最 优 ⼆ 叉 搜 索 树最 优 ⼆ 叉 搜 索 树最 优 ⼆ 叉 搜 索 树 最 优 ⼆ 叉 搜 索 树 T i j 的 平 均 路 ⻓ 为 p i j ， 则 所 求 的 最 优 值 为 p 1 , n 。 由 最 优 ⼆ 叉 搜 索 树 问 题 的 最 优 ⼦ 结 构 性 质 可 建 ⽴ 计 算 p i j 的 递 归 式 如 下 记 w i , j p i , j 为 m ( i , j ) ， 则 m ( 1 , n ) = w 1 , n p 1 , n = p 1 , n 为 所 求 的 最 优 值 。 计 算 m ( i , j ) 的 递 归 式 为 注 意 到 ， 可 以 得 到 O ( n 2 ) 的 算 法 4 7","libVersion":"0.2.4","langs":""}