# 实验3 关键利率久期等的计算

**小组(7)成员**：汪科，田昊东，谭顺予，程圣杰

## 实验步骤

### 输入债券信息

首先定义债券的基本属性，包括发行日期、购买日期、下一付息日、到期日、年度票息率、市场价格和面值。

```matlab
StartDate = datetime(2008, 5, 26);
PurchaseDate = datetime(2008, 7, 17);
NextCouponDate = datetime(2009, 5, 26);
EndDate = datetime(2014, 5, 26);
AnnualCouponRate = 0.008;
MarketPrice = 70.11;
NominalValue = 100;
```

### 定义市场利率信息

市场利率信息用于后续的贴现计算和利率曲线构建。

```matlab
DurationYears = [0 1 2 3 5 7];
MarketSpotRates = [3.15 5.23 5.57 5.76 5.90 6.00] / 100;
```

### 计算应付利息和净价

利用`acrubond`函数计算自最后付息日至结算日的应计利息，进而计算净价。

```matlab
Interest = acrubond(StartDate, PurchaseDate, NextCouponDate, NominalValue, AnnualCouponRate, 1, 3);
NetPrice = MarketPrice - Interest;
```

### 计算到期收益率

`bndyield`函数用于计算到期收益率，输入参数为净价。

```matlab
YTM = bndyield(NetPrice, AnnualCouponRate, PurchaseDate, EndDate, 1, 3);
```

### 计算理论价格

理论价格的计算基于市场利率曲线，通过贴现未来现金流得到。

```matlab
theoreticalPrice = 0; % 初始化理论价格为0
% 创建支付日期数组
PaymentDates = datetime({'2009-5-26', '2010-5-26', '2011-5-26', '2012-5-26', '2013-5-26', '2014-5-26'});
CashFlowPayments = [0.8, 0.8, 0.8, 0.8, 0.8, 100.8];
% 遍历支付日期，累计理论价格
for idx = 1:length(PaymentDates)
   timeSpan = yearfrac(PurchaseDate, PaymentDates(idx));
   discountRate = interp1(DurationYears, MarketSpotRates, timeSpan) * adjustedDiscountFactor;
   discountedCashFlow = CashFlowPayments(idx) / (1 + discountRate - 0.0001)^timeSpan;
   theoreticalPrice = theoreticalPrice + discountedCashFlow;

end
```

### 计算久期、修正久期和凸度

使用`bnddurp`函数和`bndconvp`函数分别计算久期、修正久期和凸度。

利用`acrubond`函数计算自最后付息日至结算日的应计利息，进而计算净价。

```matlab
[Duration, ModifiedDuration, Convexity] = bnddurp(NetPrice, AnnualCouponRate, PurchaseDate, EndDate, 1, 3);
DurationRounded = round(Duration, 4);
ModifiedDurationRounded = round(ModifiedDuration, 4);
ConvexityRounded = round(Convexity, 4);
```

###  计算关键利率久期

关键利率久期的计算利用`bndkrdur`函数，关注利率变动对债券价格的影响。

```matlab
KeyDates = daysadd(PurchaseDate, [1 365 365*2 365*3 365*5 365*7], 3);
KeySpotRates = ([3.15 5.23 5.57 5.76 5.90 6.00] / 100)';
KRD = bndkrdur(table(KeyDates, KeySpotRates), AnnualCouponRate, PurchaseDate, EndDate, 'basis', 3, 'period', 1);
```

## 完整代码展示

<img src="https://thdlrt.oss-cn-beijing.aliyuncs.com/image-20240331013832521.png" alt="image-20240331013832521" style="zoom:50%;" />

## 实验结果

### 实验结果展示

<img src="https://thdlrt.oss-cn-beijing.aliyuncs.com/image-20240331013946875.png" alt="image-20240331013946875" style="zoom:50%;" />

### 到期收益率

到期收益率是指假设债券持有到到期日，且所有利息支付按照到期收益率再投资的条件下，使得债券现值等于市场价格的贴现率。

在此实验中，到期收益率的计算基于债券的净价，这种方式可以更准确地反映债券的真实收益情况，因为它考虑了购买时点与下一付息日之间的应计利息。

### 理论价格

理论价格是基于市场利率曲线对未来现金流进行贴现得到的债券价值。这一价格反映了在当前市场利率水平下债券的内在价值。理论价格的计算对于评估债券的市场定价是否合理以及确定投资决策非常重要。

### 久期和修正久期

久期是衡量债券价格对市场利率变动敏感度的指标，表示市场利率变动1%时债券价格将发生的变化百分比。修正久期则是久期对(1+到期收益率)的调整，更直接地反映了债券价格对利率变动的敏感性。

### 凸度

凸度是除了久期之外，另一个衡量债券价格对利率变动敏感度的指标。它反映了利率变动时债券价格变化的非线性特征，是评估债券价格变化的二阶导数。

### 关键利率久期

关键利率久期是一种更细化的风险度量，它将债券的价格敏感度分解到不同期限的利率变动上。这允许投资者评估债券价格对不同期限利率变动的敏感度，有助于更全面地管理利率风险。

### 结果分析

- **理论价格：**75.32，这反映了在给定的市场利率水平下，根据债券的现金流贴现计算得到的债券价值。
- **久期：**5.5145年，表明如果市场利率上升1%，债券价格将下降约5.5145%。
- **修正久期：**5.7114年，提供了一个更精确的度量，表明利率每变动1%，债券价格的相对变化。
- **凸度：**34.2684，表示债券价格对利率变动的非线性反应程度。
- **关键利率久期：**展示了不同期限利率变动对债券价格影响的敏感度，对于综合利率风险管理具有重要意义。